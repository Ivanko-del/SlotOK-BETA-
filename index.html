<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>SlotOK v36</title>
  
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <style>
    /* ===== Ğ¢Ğ•ĞœĞ˜ ===== */
    :root { --bg: #050505; --text: #fff; --box: #141414; --border: #333; --accent: #d4af37; --input: #1a1a1a; --green: #4cd964; --red: #ff3b30; --sidebar: #0a0a0a; --card-hover: #1e1e1e; }
    [data-theme="light"] { --bg: #f0f0f0; --text: #111; --box: #fff; --border: #ddd; --input: #f5f5f5; --sidebar: #e8e8e8; --card-hover: #f8f8f8; }

    /* ===== DESKTOP LAYOUT ===== */
    * { box-sizing: border-box; }
    body { font-family: sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; user-select: none; transition: background 0.3s, color 0.3s; }

    /* Sidebar (desktop) */
    .sidebar { display: none; }
    @media (min-width: 900px) {
      body { display: flex; min-height: 100vh; }
      .sidebar { display: flex; flex-direction: column; width: 220px; min-height: 100vh; background: var(--sidebar); border-right: 1px solid var(--border); position: fixed; left: 0; top: 0; z-index: 800; padding: 0; }
      .sidebar-logo { padding: 20px 20px 10px; font-size: 26px; font-weight: 900; font-style: italic; color: var(--accent); border-bottom: 1px solid var(--border); }
      .sidebar-logo span { color: var(--text); }
      .sidebar-bal { margin: 12px 16px; background: #222; border-radius: 10px; padding: 10px 14px; font-weight: bold; color: var(--green); font-size: 14px; border: 1px solid #333; cursor: pointer; }
      .sidebar-nav { flex: 1; padding: 10px 0; overflow-y: auto; }
      .sidebar-item { display: flex; align-items: center; gap: 12px; padding: 12px 20px; cursor: pointer; color: #777; font-size: 14px; transition: 0.15s; border-left: 3px solid transparent; }
      .sidebar-item:hover { background: var(--card-hover); color: var(--text); }
      .sidebar-item.active { color: var(--accent); border-left-color: var(--accent); background: rgba(212,175,55,0.06); }
      .sidebar-item .s-icon { font-size: 18px; width: 22px; text-align: center; }
      .sidebar-section { padding: 10px 20px 4px; font-size: 10px; color: #444; text-transform: uppercase; letter-spacing: 1px; }
      .sidebar-bottom { padding: 12px 16px; border-top: 1px solid var(--border); }
      .main-wrap { margin-left: 220px; flex: 1; min-height: 100vh; display: flex; flex-direction: column; }
      .header { padding: 14px 24px; }
      .container { padding: 20px 28px; max-width: 900px; }
      .bottom-nav { display: none !important; }
      body { padding-bottom: 0; }
    }
    @media (max-width: 899px) {
      body { padding-bottom: 90px; }
      .main-wrap { width: 100%; }
    }

    /* Desktop grid Ğ´Ğ»Ñ Ñ–Ğ³Ğ¾Ñ€ */
    @media (min-width: 900px) {
      .games-grid-desktop { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
      .game-card { cursor: pointer; transition: 0.2s; }
      .game-card:hover { background: var(--card-hover); border-color: var(--accent); transform: translateY(-2px); }
      .container { padding-bottom: 30px; }
      .reels-container { gap: 10px; }
      .reel { width: 85px; height: 105px; line-height: 105px; font-size: 52px; }
      .poker-table { max-width: 600px; margin: 0 auto 15px; }
      .bj-table { max-width: 560px; margin: 0 auto 15px; }
    }

    /* ===== Ğ‘ĞĞ—ĞĞ’Ğ† Ğ¡Ğ¢Ğ˜Ğ›Ğ† (Ğ¼Ğ¾Ğ±Ğ°Ğ¹Ğ») ===== */
    .header { padding: 15px; background: var(--bg); border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 900; display:flex; justify-content:space-between; align-items:center; }
    .header h1 { margin: 0; font-size: 24px; color: var(--accent); font-weight: 900; font-style: italic; }
    .header-right { display: flex; align-items: center; gap: 10px; }
    .header-bal { font-size: 16px; background: #222; padding: 5px 15px; border-radius: 20px; border: 1px solid #444; font-weight:bold; color: var(--green); cursor: pointer; }
    .theme-btn { background: none; border: 1px solid var(--border); border-radius: 20px; padding: 5px 10px; cursor: pointer; font-size: 16px; width: auto; margin: 0; color: var(--text); }

    .container { padding: 15px; }
    .hidden { display: none !important; }
    .box { background: var(--box); border-radius: 12px; padding: 15px; border: 1px solid var(--border); margin-bottom: 15px; }
    button { padding: 14px; width: 100%; border: none; border-radius: 10px; font-weight: bold; font-size: 15px; cursor: pointer; background: #333; color: #fff; margin-bottom: 8px; transition: 0.2s; }
    button:active { transform: scale(0.98); }
    .btn-gold { background: linear-gradient(45deg, var(--accent), #ffdb4d); color: #000; }
    .btn-red { background: var(--red); color: #fff; }
    .btn-green { background: var(--green); color: #000; }
    .btn-outline { background: transparent; border: 1px solid #555; color: var(--text); }
    .btn-tg { background: linear-gradient(45deg, #229ED9, #1a7fc4); color: #fff; }
    input { width: 100%; padding: 14px; margin-bottom: 12px; background: var(--input); border: 1px solid var(--border); color: var(--text); border-radius: 10px; font-size: 16px; text-align: center; font-weight: bold; }

    /* Ğ“ĞĞ›ĞĞ’ĞĞ */
    .hero-banner { width: 100%; height: 160px; background: linear-gradient(135deg, #1e1e1e, #000); border-radius: 12px; margin-bottom: 20px; border: 1px solid var(--accent); display: flex; align-items: center; justify-content: center; flex-direction: column; text-align: center; position: relative; overflow: hidden; }
    .hero-banner::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse at 30% 50%, rgba(212,175,55,0.1) 0%, transparent 70%); }
    .hero-title { font-size: 28px; font-weight: 900; color: var(--accent); margin-bottom: 5px; position: relative; }
    .games-scroll { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 10px; scrollbar-width: none; }
    .game-thumb { min-width: 100px; height: 100px; background: var(--box); border: 1px solid var(--border); border-radius: 12px; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; gap: 5px; transition: 0.2s; }
    .game-thumb:hover { border-color: var(--accent); transform: translateY(-2px); }
    .game-thumb span.icon { font-size: 35px; }
    .game-thumb span.label { font-size: 10px; color: #777; }

    /* Ğ›ĞĞ‘Ğ† */
    .game-card { background: var(--box); border: 1px solid var(--border); border-radius: 12px; padding: 20px; margin-bottom: 10px; display:flex; align-items:center; gap:15px; }
    .game-icon { font-size: 35px; } .game-title { font-size: 16px; font-weight: bold; } .game-desc { font-size: 12px; color: #777; }

    /* Ğ†Ğ“Ğ Ğ˜ */
    .reels-container { background: #000; border: 1px solid var(--accent); border-radius: 10px; padding: 15px; display: flex; justify-content: center; gap: 5px; margin-bottom: 15px; }
    .reel { font-size: 45px; width: 70px; height: 90px; line-height: 90px; background: #fff; color: #000; border-radius: 5px; text-align: center; transition: all 0.1s; }

    /* 5x3 Ğ¡Ğ›ĞĞ¢Ğ˜ */
    .reels5-container { background: #000; border: 2px solid var(--accent); border-radius: 10px; padding: 10px; margin-bottom: 15px; overflow: hidden; }
    .reels5-row { display: flex; justify-content: center; gap: 4px; margin-bottom: 4px; }
    .reel5 { font-size: 30px; width: 56px; height: 56px; line-height: 56px; background: #fff; color: #000; border-radius: 4px; text-align: center; }
    .reel5.win-line { background: #fffde0; box-shadow: 0 0 8px var(--accent); animation: winPulse 0.5s ease 3; }
    @keyframes winPulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.08); } }

    .roulette-wheel { width: 220px; height: 220px; border-radius: 50%; border: 6px solid #222; margin: 0 auto 15px; background: conic-gradient(#4cd964 0deg 18deg, #222 18deg 189deg, #b71c1c 189deg 360deg); transition: 4s ease-out; transform: rotate(0deg); }
    .bet-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; margin-bottom: 15px; }
    .bet-btn { padding: 10px; border-radius: 6px; background: #222; color: #888; font-size: 11px; text-align: center; border: 1px solid #333; cursor: pointer; }
    .bet-btn.selected { border-color: var(--accent); color: #fff; background: #333; }
    .chests-grid { display: grid; gap: 8px; margin-bottom: 15px; grid-template-columns: repeat(3, 1fr); }
    .chest-item { background: #222; border-radius: 8px; height: 70px; display: flex; align-items: center; justify-content: center; font-size: 35px; border:1px solid #333; cursor:pointer; transition: 0.2s; }
    .chest-item:hover { border-color: var(--accent); }
    .mines-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px; margin-bottom: 15px; }
    .mine-cell { aspect-ratio: 1; background: #222; border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 20px; border: 1px solid #333; cursor:pointer; transition: 0.2s; }
    .mine-cell:hover { border-color: #555; }
    .mine-cell.revealed { background: #111; border-color: #000; }
    .plinko-board { position: relative; width: 100%; height: 250px; background: #111; border-radius: 10px; margin-bottom: 10px; border: 1px solid #333; overflow: hidden; }
    .plinko-ball { position: absolute; width: 12px; height: 12px; background: var(--accent); border-radius: 50%; display: none; }
    .plinko-buckets { display: flex; justify-content: space-between; }
    .bucket { font-size: 10px; background: #222; width: 14%; text-align: center; border-top: 2px solid #444; padding: 3px 0; }
    .crash-screen { background: #111; height: 200px; border-radius: 12px; border: 1px solid #333; position: relative; display: flex; align-items: center; justify-content: center; margin-bottom: 15px; overflow: hidden; }
    .crash-rocket { font-size: 40px; position: absolute; bottom: 20px; left: 20px; transition: 0.1s linear; }
    .crash-multiplier { font-size: 40px; font-weight: bold; color: #fff; z-index: 10; }
    .crash-graph { position: absolute; bottom: 0; left: 0; width: 100%; height: 100%; opacity: 0.3; }

    /* ĞŸĞĞšĞ•Ğ  */
    .poker-table { background: radial-gradient(ellipse at center, #1a5c2a 0%, #0d3318 100%); border-radius: 12px; border: 3px solid #8B6914; padding: 15px; margin-bottom: 15px; min-height: 200px; }
    .poker-cards { display: flex; justify-content: center; gap: 8px; flex-wrap: wrap; margin: 10px 0; }
    .card { width: 50px; height: 75px; background: #fff; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 22px; font-weight: bold; border: 1px solid #ddd; color: #000; flex-direction: column; line-height: 1.1; box-shadow: 0 2px 6px rgba(0,0,0,0.5); cursor: pointer; transition: transform 0.2s; }
    .card.red-card { color: #cc0000; }
    .card.selected { transform: translateY(-8px); border-color: var(--accent); box-shadow: 0 4px 12px rgba(212,175,55,0.5); }
    .card.face-down { background: linear-gradient(135deg, #1a3a6b 0%, #0d1f3d 100%); color: transparent; }
    .card.face-down::after { content: "ğŸ‚ "; font-size: 30px; color: rgba(255,255,255,0.3); }
    .poker-info { text-align: center; padding: 8px; background: rgba(0,0,0,0.4); border-radius: 8px; margin: 8px 0; color: #fff; font-size: 14px; }
    .poker-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }

    /* Ğ‘Ğ›Ğ•ĞšĞ”Ğ–Ğ•Ğš */
    .bj-table { background: radial-gradient(ellipse, #0d3318 0%, #071a0d 100%); border-radius: 12px; border: 3px solid #8B6914; padding: 15px; margin-bottom: 15px; }
    .bj-area { text-align: center; margin-bottom: 10px; }
    .bj-label { color: #aaa; font-size: 12px; margin-bottom: 5px; }
    .bj-cards { display: flex; justify-content: center; gap: 6px; flex-wrap: wrap; min-height: 75px; }
    .bj-card { width: 46px; height: 68px; background: #fff; border-radius: 5px; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 11px; font-weight: bold; border: 1px solid #ddd; }
    .bj-card.red { color: #cc0000; }
    .bj-score { font-size: 18px; font-weight: bold; color: var(--accent); margin-top: 5px; }
    .bj-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }

    /* Ğ‘ĞĞšĞšĞĞ Ğ */
    .baccarat-table { background: radial-gradient(ellipse, #1a0a2e 0%, #0d0518 100%); border-radius: 12px; border: 3px solid #8B6914; padding: 15px; margin-bottom: 15px; }
    .bacc-area { text-align: center; margin-bottom: 12px; }
    .bacc-bet-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 15px; }

    /* Ğ¡Ğ†Ğš-Ğ‘Ğ (ĞºĞ¾ÑÑ‚Ñ–) */
    .dice-display { display: flex; justify-content: center; gap: 15px; margin: 15px 0; }
    .die { width: 60px; height: 60px; background: #fff; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 36px; border: 2px solid #ddd; box-shadow: 0 4px 12px rgba(0,0,0,0.3); transition: transform 0.1s; }
    .die.rolling { animation: diceRoll 0.1s linear infinite; }
    @keyframes diceRoll { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .sic-bo-bets { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 15px; }
    .sic-bo-btn { background: #222; border: 1px solid #333; border-radius: 8px; padding: 12px; text-align: center; cursor: pointer; }
    .sic-bo-btn.selected { border-color: var(--accent); background: rgba(212,175,55,0.1); color: var(--accent); }
    .sic-bo-btn .sb-title { font-weight: bold; font-size: 14px; }
    .sic-bo-btn .sb-mult { color: var(--accent); font-size: 12px; }

    /* ĞšĞ•ĞĞ */
    .keno-grid { display: grid; grid-template-columns: repeat(8, 1fr); gap: 4px; margin-bottom: 15px; }
    .keno-num { aspect-ratio: 1; background: #222; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: bold; border: 1px solid #333; cursor: pointer; color: #aaa; transition: 0.15s; }
    .keno-num:hover { border-color: #555; }
    .keno-num.picked { background: #1a3a6b; border-color: #4a7ac0; color: #fff; }
    .keno-num.hit { background: var(--green); border-color: var(--green); color: #000; }
    .keno-num.miss { background: #333; color: #555; }

    /* Ğ¡ĞšĞ Ğ•Ğ¢Ğ§ */
    .scratch-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 15px; }
    .scratch-cell { height: 80px; background: linear-gradient(135deg, #888, #555); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 28px; cursor: pointer; border: 2px solid #999; position: relative; overflow: hidden; transition: 0.2s; }
    .scratch-cell:hover { transform: scale(1.02); }
    .scratch-cell.scratched { background: #111; border-color: #333; }
    .scratch-overlay { position: absolute; inset: 0; background: linear-gradient(135deg, #888, #555); display: flex; align-items: center; justify-content: center; color: #ccc; font-size: 12px; font-weight: bold; }

    /* ĞšĞĞ›Ğ•Ğ¡Ğ */
    .fortune-wheel-wrap { position: relative; width: 260px; height: 260px; margin: 0 auto 15px; }
    .wheel-arrow { position: absolute; top: -18px; left: 50%; transform: translateX(-50%); font-size: 28px; z-index: 10; }
    .wheel-center { position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); width: 40px; height: 40px; background: #8B6914; border-radius: 50%; border: 3px solid #ffdb4d; z-index: 5; display: flex; align-items: center; justify-content: center; font-size: 16px; }

    /* Ğ§ĞĞ¢ */
    .chat-box { height: 280px; overflow-y: auto; background: #0a0a0a; border: 1px solid #222; border-radius: 10px; padding: 10px; margin-bottom: 10px; }
    .chat-msg { margin-bottom: 8px; font-size: 13px; line-height: 1.4; }
    .chat-nick { font-weight: bold; cursor: pointer; }
    .chat-nick:hover { text-decoration: underline; }
    .chat-time { color: #555; font-size: 10px; margin-left: 5px; }
    .chat-input-row { display: flex; gap: 8px; }
    .chat-system { color: #555; font-style: italic; font-size: 12px; text-align: center; padding: 4px 0; }
    .online-badge { display: inline-block; width: 8px; height: 8px; background: var(--green); border-radius: 50%; margin-right: 4px; }
    @media (min-width: 900px) { .chat-box { height: 420px; } }

    /* Ğ”Ğ£Ğ•Ğ›Ğ† */
    .duel-card { background: #1a1a1a; border: 1px solid #333; border-radius: 10px; padding: 12px; margin-bottom: 8px; }
    .duel-vs { text-align: center; color: var(--red); font-weight: bold; font-size: 18px; }
    .duel-players { display: grid; grid-template-columns: 1fr auto 1fr; gap: 10px; align-items: center; text-align: center; }
    .duel-status { font-size: 11px; padding: 3px 10px; border-radius: 10px; }
    .ds-waiting { background: rgba(212,175,55,0.2); color: var(--accent); }

    /* Ğ¢Ğ£Ğ ĞĞ†Ğ Ğ˜ */
    .tournament-card { background: linear-gradient(135deg, #1a1a00, #0d0d00); border: 1px solid var(--accent); border-radius: 12px; padding: 15px; margin-bottom: 12px; }
    .t-prize { font-size: 24px; font-weight: 900; color: var(--accent); }
    .t-info { color: #777; font-size: 12px; margin-top: 5px; }
    .t-row { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid #1a1a00; font-size: 13px; }

    /* Ğ Ğ•Ğ¤Ğ•Ğ ĞĞ›Ğ˜ */
    .ref-link-box { background: #111; border: 1px solid #333; border-radius: 8px; padding: 12px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; word-break: break-all; font-size: 12px; color: #aaa; gap: 10px; }
    .ref-stat { text-align: center; flex: 1; }
    .ref-stat-num { font-size: 24px; font-weight: bold; color: var(--accent); }
    .ref-stat-label { font-size: 11px; color: #777; }

    /* Ğ”ĞĞ¡Ğ¯Ğ“ĞĞ•ĞĞĞ¯ */
    .achievements-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
    @media (min-width: 900px) { .achievements-grid { grid-template-columns: repeat(5, 1fr); } }
    .ach-item { background: #111; border: 1px solid #222; border-radius: 10px; padding: 12px 8px; text-align: center; transition: 0.2s; }
    .ach-item.unlocked { border-color: var(--accent); background: rgba(212,175,55,0.08); }
    .ach-item.unlocked:hover { transform: translateY(-2px); }
    .ach-icon { font-size: 28px; margin-bottom: 5px; }
    .ach-name { font-size: 10px; font-weight: bold; color: #aaa; }
    .ach-item.unlocked .ach-name { color: var(--accent); }
    .ach-locked { filter: grayscale(1); opacity: 0.4; }

    /* ĞœĞĞ“ĞĞ—Ğ˜Ğ */
    .shop-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
    @media (min-width: 900px) { .shop-grid { grid-template-columns: repeat(4, 1fr); } }
    .shop-item { background: #111; border: 1px solid #222; border-radius: 10px; padding: 15px; text-align: center; transition: 0.2s; cursor: pointer; }
    .shop-item:hover { border-color: var(--accent); transform: translateY(-2px); }
    .shop-item.owned { border-color: var(--green); }
    .shop-item.equipped { border-color: var(--accent); background: rgba(212,175,55,0.08); }
    .shop-preview { font-size: 40px; margin-bottom: 8px; display: block; }
    .shop-name { font-size: 13px; font-weight: bold; margin-bottom: 4px; }
    .shop-price { font-size: 12px; color: var(--accent); }

    /* Ğ¡ĞšĞĞ Ğ‘ĞĞ˜Ğ¦Ğ¯ */
    .vault-box { background: linear-gradient(135deg, #1a1500, #0d0a00); border: 1px solid var(--accent); border-radius: 12px; padding: 20px; margin-bottom: 15px; text-align: center; }
    .vault-balance { font-size: 32px; font-weight: 900; color: var(--accent); }
    .vault-info { color: #777; font-size: 13px; margin: 8px 0; }

    /* Ğ›ĞĞ¢Ğ•Ğ Ğ•Ğ¯ */
    .lottery-ticket { background: linear-gradient(135deg, #1a0a2e, #0d0518); border: 2px solid #8B6914; border-radius: 12px; padding: 15px; margin-bottom: 10px; text-align: center; }
    .lottery-numbers { display: flex; justify-content: center; gap: 8px; margin: 10px 0; }
    .lot-num { width: 36px; height: 36px; border-radius: 50%; background: var(--accent); color: #000; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px; }

    /* Ğ“Ğ ĞĞ¤Ğ†Ğš Ğ‘ĞĞ›ĞĞĞ¡Ğ£ */
    .balance-chart { width: 100%; height: 160px; background: #0a0a0a; border-radius: 10px; border: 1px solid #222; }
    @media (min-width: 900px) { .balance-chart { height: 220px; } }

    /* ĞŸĞ ĞĞ¤Ğ†Ğ›Ğ¬ */
    .profile-header { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
    .avatar-large { width: 70px; height: 70px; background: #222; border-radius: 50%; border: 2px solid var(--accent); display: flex; align-items: center; justify-content: center; font-size: 30px; overflow: hidden; }
    .avatar-large img { width: 100%; height: 100%; object-fit: cover; }
    .pub-profile { background: var(--box); border-radius: 12px; padding: 20px; }
    .pub-stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; }
    @media (min-width: 900px) { .pub-stats-grid { grid-template-columns: repeat(4, 1fr); } }
    .pub-stat { background: #111; border-radius: 8px; padding: 12px; text-align: center; border: 1px solid #222; }
    .pub-stat-val { font-size: 20px; font-weight: bold; color: var(--accent); }
    .pub-stat-label { font-size: 11px; color: #777; margin-top: 3px; }
    .pub-badges { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 12px; }
    .badge { background: #222; border: 1px solid #444; border-radius: 20px; padding: 4px 10px; font-size: 11px; color: #aaa; }
    .badge.gold { border-color: var(--accent); color: var(--accent); background: rgba(212,175,55,0.1); }

    /* ĞĞ”ĞœĞ†Ğ */
    .admin-stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
    @media (min-width: 900px) { .admin-stat-grid { grid-template-columns: repeat(4, 1fr); } }
    .admin-stat { background: #111; border: 1px solid #222; border-radius: 8px; padding: 12px; text-align: center; }
    .admin-stat-val { font-size: 22px; font-weight: bold; color: var(--accent); }
    .admin-stat-label { font-size: 11px; color: #555; }
    .promo-row { display: flex; justify-content: space-between; align-items: center; background: #111; border-radius: 8px; padding: 10px 12px; margin-bottom: 6px; border: 1px solid #222; }
    .request-card { background: #1a1a1a; border-radius: 8px; border: 1px solid #333; padding: 12px; margin-bottom: 8px; }
    .support-thread { background: #111; border-radius: 8px; padding: 10px; margin-bottom: 8px; border: 1px solid #222; cursor: pointer; }
    .support-thread:hover { border-color: #444; }
    .support-unread { background: var(--accent); color: #000; font-size: 10px; font-weight: bold; padding: 2px 6px; border-radius: 10px; }

    /* ĞšĞĞ¡Ğ */
    .tg-deposit-box { background: linear-gradient(135deg, #1a2a3a, #0d1a27); border: 1px solid #229ED9; border-radius: 12px; padding: 20px; margin-bottom: 15px; text-align: center; }
    .tg-logo { font-size: 50px; margin-bottom: 10px; }
    .tg-title { color: #229ED9; font-size: 18px; font-weight: bold; margin-bottom: 5px; }
    .tg-desc { color: #aaa; font-size: 12px; margin-bottom: 15px; line-height: 1.5; }
    .tg-steps { text-align: left; background: rgba(0,0,0,0.3); border-radius: 8px; padding: 12px; margin-bottom: 15px; }
    .tg-step { display: flex; gap: 10px; margin-bottom: 8px; font-size: 13px; color: #ccc; }
    .tg-step-num { color: #229ED9; font-weight: bold; min-width: 20px; }
    .amount-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 15px; }
    .amount-btn { background: #222; border: 1px solid #333; border-radius: 8px; padding: 10px 5px; text-align: center; font-size: 13px; color: #ccc; cursor: pointer; font-weight: bold; }
    .amount-btn.selected { border-color: #229ED9; color: #229ED9; background: rgba(34, 158, 217, 0.1); }
    .withdraw-box { background: linear-gradient(135deg, #1a2a1a, #0d1a0d); border: 1px solid var(--green); border-radius: 12px; padding: 20px; margin-bottom: 15px; }
    .withdraw-title { color: var(--green); font-size: 16px; font-weight: bold; margin-bottom: 10px; }
    .withdraw-method { display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap; }
    .wm-btn { background: #222; border: 1px solid #333; border-radius: 8px; padding: 8px 12px; font-size: 12px; color: #aaa; cursor: pointer; }
    .wm-btn.selected { border-color: var(--green); color: var(--green); }
    .pending-withdraw { background: #1a1a1a; border: 1px solid #333; border-radius: 8px; padding: 12px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center; }
    .pw-status { font-size: 11px; padding: 3px 8px; border-radius: 10px; }
    .pw-pending { background: rgba(212,175,55,0.2); color: var(--accent); }
    .pw-done { background: rgba(76,217,100,0.2); color: var(--green); }
    .payment-methods { display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 5px; margin-bottom: 15px; }
    .pay-btn { background: var(--input); border: 1px solid var(--border); padding: 10px 2px; border-radius: 8px; text-align: center; font-size: 10px; color: #aaa; cursor: pointer; }
    .pay-btn.selected { border-color: var(--accent); color: var(--accent); background: rgba(212, 175, 55, 0.1); }

    /* DAILY BONUS */
    .daily-bonus-modal-content { padding: 20px; text-align: center; }
    .bonus-icon { font-size: 60px; animation: bounce 0.5s ease infinite alternate; }
    @keyframes bounce { from { transform: scale(1); } to { transform: scale(1.1); } }
    .bonus-amount { font-size: 36px; font-weight: 900; color: var(--accent); margin: 10px 0; }
    .streak-dots { display: flex; justify-content: center; gap: 8px; margin: 15px 0; }
    .streak-dot { width: 30px; height: 30px; border-radius: 50%; border: 2px solid #333; display: flex; align-items: center; justify-content: center; font-size: 12px; }
    .streak-dot.done { background: var(--accent); border-color: var(--accent); color: #000; }
    .streak-dot.today { background: var(--green); border-color: var(--green); color: #000; animation: pulse 1s ease infinite; }
    @keyframes pulse { 0%,100% { box-shadow: 0 0 0 0 rgba(76,217,100,0.4); } 50% { box-shadow: 0 0 0 8px rgba(76,217,100,0); } }

    /* ADMIN USER */
    .admin-user-card { display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #1a1a1a; margin-bottom: 8px; border-radius: 8px; border: 1px solid #333; color: #fff; cursor: pointer; }
    .rank { color: var(--accent); font-weight: bold; width: 30px; text-align:center; }
    table { width: 100%; border-collapse: collapse; }
    td { padding: 12px 5px; border-bottom: 1px solid #333; font-size: 14px; }
    .contact-row { display: flex; justify-content: space-between; align-items: center; padding: 10px; background: #1a1a1a; border-radius: 8px; margin-bottom: 8px; border: 1px solid #333; }

    /* NAV */
    .bottom-nav { position: fixed; bottom: 0; width: 100%; height: 70px; background: #080808; border-top: 1px solid #222; display: flex; justify-content: space-around; align-items: center; z-index: 1000; padding-bottom: env(safe-area-inset-bottom); }
    .nav-item { display: flex; flex-direction: column; align-items: center; justify-content: center; color: #555; font-size: 10px; width: 14%; height: 100%; cursor: pointer; }
    .nav-item span.icon { font-size: 22px; margin-bottom: 4px; }
    .nav-item.active { color: var(--accent); }

    /* MODALS */
    #loading-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: #000; z-index:9999; display:flex; justify-content:center; align-items:center; color:var(--accent); font-size:24px; flex-direction: column; transition: opacity 0.5s; }
    #auth-screen, .full-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 5000; padding: 20px; overflow-y: auto; }
    @media (min-width: 900px) {
      .full-modal { display: flex; align-items: flex-start; justify-content: center; padding-top: 40px; }
      .full-modal > * { width: 100%; max-width: 560px; }
      .full-modal > button:first-child { position: fixed; top: 20px; left: 240px; width: auto; }
    }
    #toast-container { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 6000; width: 90%; max-width: 400px; pointer-events: none; }
    .toast { background: #222; color: #fff; padding: 12px; margin-bottom: 10px; border-radius: 8px; display: flex; align-items: center; border-left: 4px solid var(--accent); box-shadow: 0 5px 20px rgba(0,0,0,0.5); font-size: 14px; animation: slideIn 0.3s ease; }
    .toast.success { border-left-color: var(--green); }
    .toast.error { border-left-color: var(--red); }
    @keyframes slideIn { from { opacity:0; transform: translateY(-10px); } to { opacity:1; transform: translateY(0); } }

    /* ĞšĞĞĞ¤Ğ•Ğ¢Ğ† */
    #confetti-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 7000; overflow: hidden; }
    .confetti-piece { position: absolute; width: 10px; height: 10px; top: -10px; animation: confettiFall linear forwards; border-radius: 2px; }
    @keyframes confettiFall { 0% { top: -10px; opacity: 1; } 100% { top: 110vh; opacity: 0; } }

    .section-header { color: #777; font-size: 12px; margin: 15px 0 8px; text-transform: uppercase; letter-spacing: 1px; border-left: 3px solid var(--accent); padding-left: 8px; }
    .announce-item { background: #1a1a00; border: 1px solid #333; border-radius: 8px; padding: 10px; margin-bottom: 8px; font-size: 13px; }
    .tournament-card { background: linear-gradient(135deg, #1a1a00, #0d0d00); border: 1px solid var(--accent); border-radius: 12px; padding: 15px; margin-bottom: 12px; }
  </style>
</head>
<body data-theme="dark">
  <div id="confetti-container"></div>
  <div id="loading-overlay">
    <div style="font-size:50px; margin-bottom:20px;">ğŸ°</div>
    <div style="font-size:20px;">SlotOK v36</div>
    <div style="font-size:12px; color:#555; margin-top:10px;">Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ...</div>
  </div>
  <aside class="sidebar" id="desktopSidebar">
    <div class="sidebar-logo">SLOT<span>OK</span></div>
    <div class="sidebar-bal" onclick="switchTab('cashier')">ğŸ’° <span class="bal sb-bal">0</span> â‚´</div>
    <nav class="sidebar-nav">
      <div class="sidebar-section">Ğ“ĞĞ›ĞĞ’ĞĞ</div>
      <div class="sidebar-item active" onclick="switchTab('home',this)"><span class="s-icon">ğŸ </span>Ğ“Ğ¾Ğ»Ğ¾Ğ²Ğ½Ğ°</div>
      <div class="sidebar-item" onclick="switchTab('chat',this)"><span class="s-icon">ğŸ’¬</span>Ğ§Ğ°Ñ‚ Ğ›Ğ¾Ğ±Ñ–</div>
      <div class="sidebar-item" onclick="switchTab('top',this)"><span class="s-icon">ğŸ†</span>Ğ ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³</div>
      <div class="sidebar-section">Ğ†Ğ“Ğ Ğ˜</div>
      <div class="sidebar-item" onclick="switchTab('lobby',this)"><span class="s-icon">ğŸ°</span>Ğ’ÑÑ– Ñ–Ğ³Ñ€Ğ¸</div>
      <div class="sidebar-item" onclick="openGame('slots')"><span class="s-icon">ğŸ°</span>Ğ¡Ğ»Ğ¾Ñ‚Ğ¸</div>
      <div class="sidebar-item" onclick="openGame('blackjack')"><span class="s-icon">ğŸƒ</span>Ğ‘Ğ»ĞµĞºĞ´Ğ¶ĞµĞº</div>
      <div class="sidebar-item" onclick="openGame('roulette')"><span class="s-icon">ğŸ¡</span>Ğ ÑƒĞ»ĞµÑ‚ĞºĞ°</div>
      <div class="sidebar-item" onclick="openGame('crash')"><span class="s-icon">ğŸš€</span>ĞšÑ€Ğ°Ñˆ</div>
      <div class="sidebar-item" onclick="openGame('poker')"><span class="s-icon">â™ ï¸</span>ĞŸĞ¾ĞºĞµÑ€</div>
      <div class="sidebar-item" onclick="openGame('baccarat')"><span class="s-icon">ğŸ´</span>Ğ‘Ğ°ĞºĞºĞ°Ñ€Ğ°</div>
      <div class="sidebar-item" onclick="openGame('sicbo')"><span class="s-icon">ğŸ²</span>Ğ¡Ñ–Ğº-Ğ‘Ğ¾</div>
      <div class="sidebar-item" onclick="openGame('fortune')"><span class="s-icon">ğŸ¡</span>ĞšĞ¾Ğ»ĞµÑĞ¾</div>
      <div class="sidebar-item" onclick="openGame('keno')"><span class="s-icon">ğŸ”¢</span>ĞšĞµĞ½Ğ¾</div>
      <div class="sidebar-item" onclick="openGame('scratch')"><span class="s-icon">ğŸŸï¸</span>Ğ¡ĞºÑ€ĞµÑ‚Ñ‡</div>
      <div class="sidebar-item" onclick="openGame('mines')"><span class="s-icon">ğŸ’£</span>ĞœÑ–Ğ½Ğ¸</div>
      <div class="sidebar-item" onclick="openGame('plinko')"><span class="s-icon">ğŸ”»</span>ĞŸĞ»Ñ–Ğ½ĞºĞ¾</div>
      <div class="sidebar-section">Ğ¡ĞĞ¦Ğ†ĞĞ›Ğ¬ĞĞ•</div>
      <div class="sidebar-item" onclick="switchTab('duels',this)"><span class="s-icon">âš”ï¸</span>Ğ”ÑƒĞµĞ»Ñ–</div>
      <div class="sidebar-item" onclick="switchTab('tournaments',this)"><span class="s-icon">ğŸ†</span>Ğ¢ÑƒÑ€Ğ½Ñ–Ñ€Ğ¸</div>
      <div class="sidebar-item" onclick="switchTab('referrals',this)"><span class="s-icon">ğŸ‘¥</span>Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ¸</div>
      <div class="sidebar-item" onclick="switchTab('contacts',this)"><span class="s-icon">ğŸ¤</span>Ğ—Ğ½Ğ°Ğ¹Ğ¾Ğ¼Ñ–</div>
      <div class="sidebar-section">ĞĞ¡ĞĞ‘Ğ˜Ğ¡Ğ¢Ğ•</div>
      <div class="sidebar-item" onclick="switchTab('cashier',this)"><span class="s-icon">ğŸ’³</span>ĞšĞ°ÑĞ°</div>
      <div class="sidebar-item" onclick="switchTab('shop',this)"><span class="s-icon">ğŸ›ï¸</span>ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½</div>
      <div class="sidebar-item" onclick="switchTab('achievements',this)"><span class="s-icon">ğŸ…</span>Ğ”Ğ¾ÑÑĞ³Ğ½ĞµĞ½Ğ½Ñ</div>
      <div class="sidebar-item" onclick="switchTab('vault',this)"><span class="s-icon">ğŸ¦</span>Ğ¡ĞºĞ°Ñ€Ğ±Ğ½Ğ¸Ñ†Ñ</div>
      <div class="sidebar-item" onclick="switchTab('lottery',this)"><span class="s-icon">ğŸ«</span>Ğ›Ğ¾Ñ‚ĞµÑ€ĞµÑ</div>
      <div class="sidebar-item" onclick="switchTab('profile',this)"><span class="s-icon">ğŸ‘¤</span>ĞŸÑ€Ğ¾Ñ„Ñ–Ğ»ÑŒ</div>
    </nav>
    <div class="sidebar-bottom">
      <button class="btn-outline theme-btn" onclick="toggleTheme()" style="width:100%;margin:0;">ğŸŒ™ Ğ¢ĞµĞ¼Ğ°</button>
    </div>
  </aside>
  <div class="main-wrap">
  <div id="toast-container"></div>
  <div class="header">
    <h1>SLOT<span>OK</span></h1>
    <div class="header-right">
      <button class="theme-btn" onclick="toggleTheme()">ğŸŒ™</button>
      <div class="header-bal" onclick="switchTab('cashier')"><span class="bal">0</span> â‚´</div>
    </div>
  </div>

  <div class="container">
    
    <!-- Ğ“ĞĞ›ĞĞ’ĞĞ -->
    <div id="tab-home" class="screen">
        <div class="hero-banner">
            <div class="hero-title">ğŸ BONUS 250%</div>
            <div style="color:#aaa; font-size:13px;">Ğ’Ñ–Ñ‚Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ Ğ½Ğ° Ğ¿ĞµÑ€ÑˆĞ¸Ğ¹ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚</div>
        </div>
        
        <!-- Ğ©Ğ¾Ğ´ĞµĞ½Ğ½Ğ¸Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ Ğ±Ğ°Ğ½ĞµÑ€ -->
        <div id="dailyBonusBanner" class="hidden" style="background: linear-gradient(135deg, #1a2a1a, #0d3a1a); border: 1px solid var(--green); border-radius: 12px; padding: 15px; margin-bottom: 15px; display: flex; align-items: center; justify-content: space-between; cursor: pointer;" onclick="openDailyBonus()">
            <div>
                <div style="font-size:16px; font-weight:bold; color:var(--green);">ğŸ Ğ©Ğ¾Ğ´ĞµĞ½Ğ½Ğ¸Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ!</div>
                <div style="font-size:12px; color:#aaa;">Ğ—Ğ°Ğ±ĞµÑ€Ğ¸ ÑĞ²Ğ¾Ñ Ğ½Ğ°Ğ³Ğ¾Ñ€Ğ¾Ğ´Ñƒ</div>
            </div>
            <div style="font-size:30px;">âœ¨</div>
        </div>
        
        <div class="section-header">ğŸ”¥ ĞŸĞ¾Ğ¿ÑƒĞ»ÑÑ€Ğ½Ñ–</div>
        <div class="games-scroll">
            <div class="game-thumb" onclick="openGame('slots')"><span class="icon">ğŸ°</span><span class="label">Ğ¡Ğ»Ğ¾Ñ‚Ğ¸</span></div>
            <div class="game-thumb" onclick="openGame('blackjack')"><span class="icon">ğŸƒ</span><span class="label">Ğ‘Ğ»ĞµĞºĞ´Ğ¶ĞµĞº</span></div>
            <div class="game-thumb" onclick="openGame('crash')"><span class="icon">ğŸš€</span><span class="label">ĞšÑ€Ğ°Ñˆ</span></div>
            <div class="game-thumb" onclick="openGame('fortune')"><span class="icon">ğŸ¡</span><span class="label">ĞšĞ¾Ğ»ĞµÑĞ¾</span></div>
            <div class="game-thumb" onclick="openGame('keno')"><span class="icon">ğŸ”¢</span><span class="label">ĞšĞµĞ½Ğ¾</span></div>
            <div class="game-thumb" onclick="openGame('scratch')"><span class="icon">ğŸŸï¸</span><span class="label">Ğ¡ĞºÑ€ĞµÑ‚Ñ‡</span></div>
            <div class="game-thumb" onclick="openGame('poker')"><span class="icon">â™ ï¸</span><span class="label">ĞŸĞ¾ĞºĞµÑ€</span></div>
            <div class="game-thumb" onclick="openGame('mines')"><span class="icon">ğŸ’£</span><span class="label">ĞœÑ–Ğ½Ğ¸</span></div>
        </div>
        <button class="btn-outline" style="margin-top:15px;" onclick="switchTab('lobby')">Ğ’ÑÑ– Ñ–Ğ³Ñ€Ğ¸ â¡</button>
    </div>

    <!-- Ğ›ĞĞ‘Ğ† -->
    <div id="tab-lobby" class="screen hidden">
      <div class="game-card" onclick="openGame('blackjack')"><span class="game-icon">ğŸƒ</span><div class="game-info"><div class="game-title">Blackjack</div><div class="game-desc">21 â€¢ ĞšĞ»Ğ°ÑĞ¸ĞºĞ°</div></div><span style="background:var(--accent);color:#000;font-size:10px;font-weight:bold;padding:3px 8px;border-radius:10px;margin-left:auto;">NEW</span></div>
      <div class="game-card" onclick="openGame('keno')"><span class="game-icon">ğŸ”¢</span><div class="game-info"><div class="game-title">Keno</div><div class="game-desc">Ğ’Ğ¸Ğ±ĞµÑ€Ğ¸ Ñ‡Ğ¸ÑĞ»Ğ°</div></div><span style="background:var(--accent);color:#000;font-size:10px;font-weight:bold;padding:3px 8px;border-radius:10px;margin-left:auto;">NEW</span></div>
      <div class="game-card" onclick="openGame('scratch')"><span class="game-icon">ğŸŸï¸</span><div class="game-info"><div class="game-title">Ğ¡ĞºÑ€ĞµÑ‚Ñ‡</div><div class="game-desc">Ğ¡Ñ‚Ğ¸Ñ€Ğ°Ğ¹ Ñ– Ğ²Ğ¸Ğ³Ñ€Ğ°Ğ²Ğ°Ğ¹</div></div><span style="background:var(--accent);color:#000;font-size:10px;font-weight:bold;padding:3px 8px;border-radius:10px;margin-left:auto;">NEW</span></div>
      <div class="game-card" onclick="openGame('fortune')"><span class="game-icon">ğŸ¡</span><div class="game-info"><div class="game-title">ĞšĞ¾Ğ»ĞµÑĞ¾ Ğ¤Ğ¾Ñ€Ñ‚ÑƒĞ½Ğ¸</div><div class="game-desc">ĞšÑ€ÑƒÑ‚Ğ¸ Ñ– Ğ²Ğ¸Ğ³Ñ€Ğ°Ğ²Ğ°Ğ¹</div></div><span style="background:var(--accent);color:#000;font-size:10px;font-weight:bold;padding:3px 8px;border-radius:10px;margin-left:auto;">NEW</span></div>
      <div class="game-card" onclick="openGame('slots')"><span class="game-icon">ğŸ°</span><div class="game-info"><div class="game-title">Classic 777</div><div class="game-desc">Ğ¡Ğ»Ğ¾Ñ‚Ğ¸ â€¢ RTP 95%</div></div></div>
      <div class="game-card" onclick="openGame('roulette')"><span class="game-icon">ğŸ¡</span><div class="game-info"><div class="game-title">Royal Roulette</div><div class="game-desc">Ğ ÑƒĞ»ĞµÑ‚ĞºĞ° â€¢ x2 / x14</div></div></div>
      <div class="game-card" onclick="openGame('crash')"><span class="game-icon">ğŸš€</span><div class="game-info"><div class="game-title">Crash Aviator</div><div class="game-desc">ĞšÑ€Ğ°Ñˆ â€¢ Ğ´Ğ¾ xâˆ</div></div></div>
      <div class="game-card" onclick="openGame('poker')"><span class="game-icon">ğŸƒ</span><div class="game-info"><div class="game-title">Video Poker</div><div class="game-desc">5-ĞºĞ°Ñ€Ñ‚ĞºĞ¾Ğ²Ğ° Ñ€Ğ¾Ğ·Ğ´Ğ°Ñ‡Ğ° â€¢ NEW</div></div><span style="background:var(--green);color:#000;font-size:10px;font-weight:bold;padding:3px 8px;border-radius:10px;margin-left:auto;">NEW</span></div>
      <div class="game-card" onclick="openGame('chests')"><span class="game-icon">ğŸ“¦</span><div class="game-info"><div class="game-title">Magic Chests</div><div class="game-desc">Ğ¡ÑƒĞ½Ğ´ÑƒĞºĞ¸</div></div></div>
      <div class="game-card" onclick="openGame('mines')"><span class="game-icon">ğŸ’£</span><div class="game-info"><div class="game-title">Mines</div><div class="game-desc">Ğ¡Ğ°Ğ¿ĞµÑ€</div></div></div>
      <div class="game-card" onclick="openGame('plinko')"><span class="game-icon">ğŸ”»</span><div class="game-info"><div class="game-title">Plinko</div><div class="game-desc">ĞŸĞ»Ñ–Ğ½ĞºĞ¾</div></div></div>
    </div>

    <!-- Ğ†Ğ“Ğ Ğ˜ -->
    <div id="tab-slots" class="screen hidden">
      <button class="btn-outline" onclick="switchTab('lobby')">â¬… Ğ›Ğ¾Ğ±Ñ–</button>
      <div class="reels-container"><div class="reel" id="r1">7</div><div class="reel" id="r2">7</div><div class="reel" id="r3">7</div></div>
      <div class="box">
        <input id="betAmountSlots" type="number" value="100">
        <button class="btn-gold" onclick="spinSlots()">ĞšĞ Ğ£Ğ¢Ğ˜Ğ¢Ğ˜ ğŸ°</button>
      </div>
    </div>
    
    <div id="tab-roulette" class="screen hidden">
      <button class="btn-outline" onclick="switchTab('lobby')">â¬… Ğ›Ğ¾Ğ±Ñ–</button>
      <div class="roulette-wheel" id="wheel"></div>
      <div class="box">
        <div class="bet-grid">
          <div class="bet-btn" data-color="red" onclick="selectRouletteBet('red', this)">ğŸ”´ RED (x2)</div>
          <div class="bet-btn" data-color="green" onclick="selectRouletteBet('green', this)">ğŸŸ¢ ZERO (x14)</div>
          <div class="bet-btn" data-color="black" onclick="selectRouletteBet('black', this)">âš« BLACK (x2)</div>
        </div>
        <input id="betAmountRoulette" type="number" value="100">
        <button class="btn-gold" onclick="spinRoulette()">Ğ¡Ğ¢ĞĞ Ğ¢ ğŸ¡</button>
      </div>
    </div>
    
    <div id="tab-crash" class="screen hidden">
      <button class="btn-outline" onclick="switchTab('lobby')">â¬… Ğ›Ğ¾Ğ±Ñ–</button>
      <div class="crash-screen">
        <canvas class="crash-graph" id="crashCanvas"></canvas>
        <div class="crash-rocket" id="crashRocket">ğŸš€</div>
        <div class="crash-multiplier" id="crashDisplay">1.00x</div>
      </div>
      <div class="box">
        <input id="betAmountCrash" type="number" value="100">
        <button class="btn-gold" id="crashBtn" onclick="startCrash()">Ğ¡Ğ¢ĞĞ Ğ¢ ğŸš€</button>
        <button class="btn-green hidden" id="crashCashoutBtn" onclick="cashoutCrash()">ğŸ’° Ğ—ĞĞ‘Ğ ĞĞ¢Ğ˜</button>
      </div>
    </div>

    <!-- ĞŸĞĞšĞ•Ğ  -->
    <div id="tab-poker" class="screen hidden">
      <button class="btn-outline" onclick="switchTab('lobby')">â¬… Ğ›Ğ¾Ğ±Ñ–</button>
      <div class="poker-table">
        <div style="text-align:center; color:#aaa; font-size:12px; margin-bottom:10px;">ğŸƒ VIDEO POKER â€” ĞĞ±ĞµÑ€Ñ–Ñ‚ÑŒ ĞºĞ°Ñ€Ñ‚Ğ¸ Ğ´Ğ»Ñ Ğ·Ğ°Ğ¼Ñ–Ğ½Ğ¸</div>
        <div class="poker-cards" id="pokerCards"></div>
        <div class="poker-info" id="pokerInfo">Ğ—Ñ€Ğ¾Ğ±Ñ–Ñ‚ÑŒ ÑÑ‚Ğ°Ğ²ĞºÑƒ Ñ– Ğ½Ğ°Ñ‚Ğ¸ÑĞ½Ñ–Ñ‚ÑŒ Ğ“Ğ ĞĞ¢Ğ˜</div>
      </div>
      <div class="box">
        <input id="betAmountPoker" type="number" value="100">
        <div class="poker-actions">
          <button class="btn-gold" id="pokerDealBtn" onclick="dealPoker()">ğŸƒ Ğ ĞĞ—Ğ”ĞĞ¢Ğ˜</button>
          <button class="btn-green hidden" id="pokerDrawBtn" onclick="drawPoker()">ğŸ”„ Ğ—ĞĞœĞ†ĞĞ˜Ğ¢Ğ˜</button>
        </div>
        <div id="pokerPaytable" style="margin-top:10px; background:#111; border-radius:8px; padding:10px; font-size:12px; color:#777; display:none;">
          <div style="color:var(--accent); margin-bottom:5px; font-weight:bold;">Ğ¢ĞĞ‘Ğ›Ğ˜Ğ¦Ğ¯ Ğ’Ğ˜ĞŸĞ›ĞĞ¢:</div>
          <div style="display:grid; grid-template-columns:1fr 1fr; gap:3px;">
            <span>Ğ Ğ¾ÑĞ»-Ñ„Ğ»ĞµÑˆ</span><span style="color:var(--accent);">x800</span>
            <span>Ğ¡Ñ‚Ñ€ĞµĞ¹Ñ‚-Ñ„Ğ»ĞµÑˆ</span><span style="color:var(--accent);">x50</span>
            <span>ĞšĞ°Ñ€Ğµ</span><span style="color:var(--accent);">x25</span>
            <span>Ğ¤ÑƒĞ»-Ñ…Ğ°ÑƒÑ</span><span style="color:var(--accent);">x9</span>
            <span>Ğ¤Ğ»ĞµÑˆ</span><span style="color:var(--accent);">x6</span>
            <span>Ğ¡Ñ‚Ñ€ĞµĞ¹Ñ‚</span><span style="color:var(--accent);">x4</span>
            <span>Ğ¢Ñ€Ğ¸ Ğ¾Ğ´Ğ½Ğ°ĞºĞ¾Ğ²Ğ¸Ñ…</span><span style="color:var(--accent);">x3</span>
            <span>Ğ”Ğ²Ñ– Ğ¿Ğ°Ñ€Ğ¸</span><span style="color:var(--accent);">x2</span>
            <span>ĞŸĞ°Ñ€Ğ° JJ+</span><span style="color:var(--accent);">x1</span>
          </div>
        </div>
        <button class="btn-outline" style="margin-top:5px; font-size:12px; padding:8px;" onclick="togglePaytable()">â„¹ï¸ Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ Ğ²Ğ¸Ğ¿Ğ»Ğ°Ñ‚</button>
      </div>
    </div>
    
    <div id="tab-chests" class="screen hidden">
      <button class="btn-outline" onclick="switchTab('lobby')">â¬… Ğ›Ğ¾Ğ±Ñ–</button>
      <div class="box"><div class="chests-grid" id="chestsGrid"></div></div>
      <div class="box"><input id="betAmountChests" type="number" value="100"><button class="btn-gold" id="chestsPlayBtn" onclick="startChests()">Ğ“Ğ ĞĞ¢Ğ˜ ğŸ“¦</button></div>
    </div>
    
    <div id="tab-mines" class="screen hidden">
      <button class="btn-outline" onclick="switchTab('lobby')">â¬… Ğ›Ğ¾Ğ±Ñ–</button>
      <div class="box"><div class="mines-grid" id="minesGrid"></div></div>
      <div class="box">
        <input id="betAmountMines" type="number" value="100">
        <button class="btn-gold" id="minesBtn" onclick="startMines()">Ğ¡Ğ¢ĞĞ Ğ¢ ğŸ’£</button>
        <button class="btn-green hidden" id="minesCashoutBtn" onclick="cashoutMines()">Ğ—ĞĞ‘Ğ ĞĞ¢Ğ˜</button>
      </div>
    </div>
    
    <div id="tab-plinko" class="screen hidden">
      <button class="btn-outline" onclick="switchTab('lobby')">â¬… Ğ›Ğ¾Ğ±Ñ–</button>
      <div class="box">
        <div class="plinko-board" id="plinkoBoard"><div class="plinko-ball" id="plinkoBall"></div></div>
        <div class="plinko-buckets">
          <div class="bucket">x5</div><div class="bucket">x2</div><div class="bucket">x0.5</div>
          <div class="bucket">x0.2</div><div class="bucket">x0.5</div><div class="bucket">x2</div><div class="bucket">x5</div>
        </div>
      </div>
      <div class="box"><input id="betAmountPlinko" type="number" value="100"><button class="btn-gold" onclick="dropPlinko()">ĞšĞ˜ĞĞ£Ğ¢Ğ˜ ğŸ”»</button></div>
    </div>

    <!-- ĞšĞĞ¡Ğ (Ğ¾Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ°) -->
    <div id="tab-cashier" class="screen hidden">
      
      <!-- TELEGRAM Ğ”Ğ•ĞŸĞĞ—Ğ˜Ğ¢ -->
      <div class="tg-deposit-box">
        <div class="tg-logo">âœˆï¸</div>
        <div class="tg-title">ĞŸĞ¾Ğ¿Ğ¾Ğ²Ğ½ĞµĞ½Ğ½Ñ Ñ‡ĞµÑ€ĞµĞ· Telegram</div>
        <div class="tg-desc">Ğ‘ĞµĞ·Ğ¿ĞµÑ‡Ğ½Ğ¾ Ñ– ÑˆĞ²Ğ¸Ğ´ĞºĞ¾ Ñ‡ĞµÑ€ĞµĞ· Ğ½Ğ°ÑˆĞ¾Ğ³Ğ¾ Ğ±Ğ¾Ñ‚Ğ°.<br>ĞŸĞ¾Ğ¿Ğ¾Ğ²Ğ½ĞµĞ½Ğ½Ñ Ğ·Ğ°Ñ€Ğ°Ñ…Ğ¾Ğ²ÑƒÑ”Ñ‚ÑŒÑÑ Ğ¿Ñ€Ğ¾Ñ‚ÑĞ³Ğ¾Ğ¼ 1-5 Ñ…Ğ²Ğ¸Ğ»Ğ¸Ğ½.</div>
        <div class="tg-steps">
          <div class="tg-step"><span class="tg-step-num">1.</span><span>ĞĞ°Ñ‚Ğ¸ÑĞ½Ñ–Ñ‚ÑŒ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ â€” Ğ²Ñ–Ğ´ĞºÑ€Ğ¸Ñ”Ñ‚ÑŒÑÑ Ğ±Ğ¾Ñ‚</span></div>
          <div class="tg-step"><span class="tg-step-num">2.</span><span>ĞĞ°Ğ´Ñ–ÑˆĞ»Ñ–Ñ‚ÑŒ Ğ±Ğ¾Ñ‚Ñƒ ÑĞ²Ñ–Ğ¹ ID Ñ‚Ğ° ÑÑƒĞ¼Ñƒ</span></div>
          <div class="tg-step"><span class="tg-step-num">3.</span><span>Ğ¡Ğ¿Ğ»Ğ°Ñ‚Ñ–Ñ‚ÑŒ Ñ‡ĞµÑ€ĞµĞ· Privat24 / Mono / ĞšĞ°Ñ€Ñ‚Ñƒ</span></div>
          <div class="tg-step"><span class="tg-step-num">4.</span><span>ĞšĞ¾ÑˆÑ‚Ğ¸ Ğ·Ğ°Ñ€Ğ°Ñ…Ğ¾Ğ²ÑƒÑÑ‚ÑŒÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğ¾</span></div>
        </div>
        <div style="background: rgba(0,0,0,0.3); border-radius:8px; padding:10px; margin-bottom:12px; font-size:13px; color:#aaa;">
          Ğ’Ğ°Ñˆ ID: <span id="cashierUserId" style="color:#229ED9; font-weight:bold; font-size:16px;">â€”</span>
        </div>
        <div class="amount-grid">
          <div class="amount-btn" onclick="selectDepAmount(100, this)">100â‚´</div>
          <div class="amount-btn" onclick="selectDepAmount(250, this)">250â‚´</div>
          <div class="amount-btn" onclick="selectDepAmount(500, this)">500â‚´</div>
          <div class="amount-btn" onclick="selectDepAmount(1000, this)">1000â‚´</div>
          <div class="amount-btn" onclick="selectDepAmount(2000, this)">2000â‚´</div>
          <div class="amount-btn" onclick="selectDepAmount(5000, this)">5000â‚´</div>
          <div class="amount-btn" onclick="selectDepAmount(10000, this)">10kâ‚´</div>
          <div class="amount-btn" id="customAmtBtn" onclick="selectCustomAmount()">Ğ†Ğ½ÑˆĞ°</div>
        </div>
        <div id="customAmountBox" class="hidden">
          <input id="customDepAmount" type="number" placeholder="Ğ’Ğ²ĞµĞ´Ñ–Ñ‚ÑŒ ÑÑƒĞ¼Ñƒ" style="margin-bottom:8px;">
        </div>
        <button class="btn-tg" onclick="openTelegramBot()">âœˆï¸ Ğ’Ñ–Ğ´ĞºÑ€Ğ¸Ñ‚Ğ¸ Telegram Ğ‘Ğ¾Ñ‚Ğ°</button>
      </div>

      <!-- Ğ’Ğ˜Ğ’Ğ†Ğ” ĞšĞĞ¨Ğ¢Ğ†Ğ’ -->
      <div class="withdraw-box">
        <div class="withdraw-title">ğŸ’¸ Ğ’Ğ¸Ğ²Ñ–Ğ´ ĞºĞ¾ÑˆÑ‚Ñ–Ğ²</div>
        <div class="withdraw-method">
          <div class="wm-btn selected" id="wm-privat" onclick="selectWithdrawMethod('privat', this)">ğŸŸ¢ PrivatBank</div>
          <div class="wm-btn" id="wm-mono" onclick="selectWithdrawMethod('mono', this)">ğŸˆ Monobank</div>
          <div class="wm-btn" id="wm-usdt" onclick="selectWithdrawMethod('usdt', this)">â‚® USDT</div>
        </div>
        <input id="withdrawCard" placeholder="ĞĞ¾Ğ¼ĞµÑ€ ĞºĞ°Ñ€Ñ‚ĞºĞ¸ / USDT Ğ°Ğ´Ñ€ĞµÑĞ°">
        <input id="withdrawAmount" type="number" placeholder="Ğ¡ÑƒĞ¼Ğ° Ğ²Ğ¸Ğ²Ğ¾Ğ´Ñƒ (Ğ¼Ñ–Ğ½. 200â‚´)">
        <button class="btn-green" onclick="submitWithdraw()">ğŸ’¸ ĞŸĞĞ”ĞĞ¢Ğ˜ Ğ—ĞĞ¯Ğ’ĞšĞ£</button>
      </div>

      <!-- ĞœĞ¾Ñ— Ğ·Ğ°ÑĞ²ĞºĞ¸ Ğ½Ğ° Ğ²Ğ¸Ğ²Ñ–Ğ´ -->
      <div id="myWithdrawsBox">
        <div class="section-header">ĞœĞ¾Ñ— Ğ·Ğ°ÑĞ²ĞºĞ¸ Ğ½Ğ° Ğ²Ğ¸Ğ²Ñ–Ğ´</div>
        <div id="myWithdrawsList" style="color:#777; font-size:13px; padding:10px 0;">ĞĞµĞ¼Ğ°Ñ” Ğ·Ğ°ÑĞ²Ğ¾Ğº</div>
      </div>

      <div style="display:flex; gap:8px;">
        <button class="btn-outline" style="border-color:var(--accent); color:var(--accent);" onclick="openModal('transfer-modal')">ğŸ’¸ ĞŸĞµÑ€ĞµĞºĞ°Ğ·</button>
        <button class="btn-outline" onclick="openModal('promo-modal')">ğŸ ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´</button>
      </div>
    </div>

    <!-- Ğ¢ĞĞŸ -->
    <div id="tab-top" class="screen hidden">
        <div class="box"><h3 style="text-align:center; color:#777; margin:0 0 15px;">ğŸ† Ğ Ğ•Ğ™Ğ¢Ğ˜ĞĞ“ Ğ“Ğ ĞĞ’Ğ¦Ğ†Ğ’</h3><table id="topTable"></table></div>
    </div>
    
    <!-- ĞŸĞ ĞĞ¤Ğ†Ğ›Ğ¬ -->
    <div id="tab-profile" class="screen hidden">
      <div class="box">
        <div class="profile-header">
            <div class="avatar-large" id="currentAvatar">ğŸ‘¤</div>
            <div>
                <div style="font-size:24px; font-weight:bold;"><span id="profileName">...</span> <span id="adminBadge" class="hidden" style="color:red; font-size:12px;">[ADMIN]</span></div>
                <div style="font-size:12px; color:#777; margin-top:5px;" id="profileTag">...</div>
            </div>
        </div>
        <input id="bioInput" placeholder="Ğ—Ğ¼Ñ–Ğ½Ğ¸Ñ‚Ğ¸ ÑÑ‚Ğ°Ñ‚ÑƒÑ..." onchange="updateBio(this.value)">
        <div style="margin-top:10px; color:#777;">ID: <span id="profileId">...</span></div>
        <div style="margin-top:5px; color:#777;">Email: <span id="profileEmail">...</span></div>
        <div style="display:flex; gap:10px; margin-top:15px;">
            <button class="btn-outline" onclick="document.getElementById('avatarInput').click()">ğŸ“· Ğ¤Ğ¾Ñ‚Ğ¾</button>
            <button class="btn-outline" onclick="openHistoryModal()">ğŸ“œ Ğ†ÑÑ‚Ğ¾Ñ€Ñ–Ñ</button>
            <button class="btn-outline" onclick="openDailyBonus()">ğŸ Ğ‘Ğ¾Ğ½ÑƒÑ</button>
        </div>
        <input type="file" id="avatarInput" accept="image/*" style="display:none;" onchange="handleAvatarUpload(this)">
      </div>
      <div class="box hidden" id="adminPanelBtnBox" style="border-color: #ff3b30; text-align:center;">
          <button class="btn-red" onclick="switchTab('admin')">âš™ï¸ ĞŸĞĞĞ•Ğ›Ğ¬ ĞĞ”ĞœĞ†ĞĞ†Ğ¡Ğ¢Ğ ĞĞ¢ĞĞ Ğ</button>
      </div>
    </div>

    <!-- Ğ—ĞĞĞ™ĞĞœĞ† -->
    <div id="tab-contacts" class="screen hidden">
        <h2 style="color:var(--accent); margin-bottom:15px;">Ğ—Ğ½Ğ°Ğ¹Ğ¾Ğ¼Ñ–</h2>
        <div class="box"><div style="display:flex; gap:10px;"><input id="addContactInput" placeholder="ĞÑ–Ğº Ğ°Ğ±Ğ¾ ID" style="margin:0;"><button class="btn-gold" style="width:auto; margin:0;" onclick="addContact()">+</button></div></div>
        <div id="contactsList" style="margin-top:20px;"></div>
    </div>

    <!-- Ğ©Ğ• -->
    <div id="tab-more" class="screen hidden">
      <div class="box">
        <button class="btn-outline" onclick="switchTab('duels')">âš”ï¸ Ğ”ÑƒĞµĞ»Ñ–</button>
        <button class="btn-outline" onclick="switchTab('tournaments')">ğŸ† Ğ¢ÑƒÑ€Ğ½Ñ–Ñ€Ğ¸</button>
        <button class="btn-outline" onclick="switchTab('referrals')">ğŸ‘¥ Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ¸</button>
        <button class="btn-outline" onclick="switchTab('contacts')">ğŸ¤ Ğ—Ğ½Ğ°Ğ¹Ğ¾Ğ¼Ñ–</button>
        <button class="btn-outline" onclick="openSupportModal()">ğŸ’¬ Ğ§Ğ°Ñ‚ ĞŸÑ–Ğ´Ñ‚Ñ€Ğ¸Ğ¼ĞºĞ¸</button>
        <button class="btn-outline" onclick="openDailyBonus()">ğŸ Ğ©Ğ¾Ğ´ĞµĞ½Ğ½Ğ¸Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ</button>
        <button class="btn-outline" onclick="logout()">Ğ’Ğ¸Ğ¹Ñ‚Ğ¸</button>
        <button class="btn-red" onclick="deleteAccount()">Ğ’Ğ˜Ğ”ĞĞ›Ğ˜Ğ¢Ğ˜ ĞĞšĞĞ£ĞĞ¢</button>
      </div>
    </div>

    <!-- ĞĞ”ĞœĞ†Ğ -->
    <div id="tab-admin" class="screen hidden">
       <button class="btn-outline" onclick="switchTab('profile')">â¬… ĞĞ°Ğ·Ğ°Ğ´</button>
       <h2 style="color:var(--accent);">âš™ï¸ ĞĞ´Ğ¼Ñ–Ğ½-ĞŸĞ°Ğ½ĞµĞ»ÑŒ</h2>

       <!-- Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° ĞºĞ°Ğ·Ğ¸Ğ½Ğ¾ -->
       <div class="section-header">ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° ĞºĞ°Ğ·Ğ¸Ğ½Ğ¾</div>
       <div class="admin-stat-grid" id="casinoStats">
         <div class="admin-stat"><div class="admin-stat-val" id="statTotalUsers">â€”</div><div class="admin-stat-label">Ğ“Ñ€Ğ°Ğ²Ñ†Ñ–Ğ²</div></div>
         <div class="admin-stat"><div class="admin-stat-val" id="statTotalBalance">â€”</div><div class="admin-stat-label">Ğ“Ñ€Ğ¾ÑˆĞµĞ¹ Ğ² Ğ³Ñ€Ñ–</div></div>
         <div class="admin-stat"><div class="admin-stat-val" id="statActiveDuels">â€”</div><div class="admin-stat-label">Ğ”ÑƒĞµĞ»ĞµĞ¹</div></div>
         <div class="admin-stat"><div class="admin-stat-val" id="statPendingWithdraws">â€”</div><div class="admin-stat-label">Ğ’Ğ¸Ğ²Ğ¾Ğ´Ñ–Ğ²</div></div>
       </div>
       <button class="btn-outline" onclick="loadAdminStats()">ğŸ”„ ĞĞ½Ğ¾Ğ²Ğ¸Ñ‚Ğ¸ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ</button>

       <!-- ĞĞ³Ğ¾Ğ»Ğ¾ÑˆĞµĞ½Ğ½Ñ -->
       <div class="section-header">ğŸ“¢ Ğ“Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ğµ Ğ¾Ğ³Ğ¾Ğ»Ğ¾ÑˆĞµĞ½Ğ½Ñ</div>
       <div class="box">
         <input id="announceText" placeholder="Ğ¢ĞµĞºÑÑ‚ Ğ¾Ğ³Ğ¾Ğ»Ğ¾ÑˆĞµĞ½Ğ½Ñ Ğ´Ğ»Ñ Ğ²ÑÑ–Ñ… Ğ³Ñ€Ğ°Ğ²Ñ†Ñ–Ğ²...">
         <button class="btn-gold" onclick="sendAnnouncement()">ğŸ“¢ ĞĞŸĞ£Ğ‘Ğ›Ğ†ĞšĞ£Ğ’ĞĞ¢Ğ˜</button>
         <button class="btn-outline" onclick="clearAnnouncement()">ğŸ—‘ï¸ Ğ’Ğ¸Ğ´Ğ°Ğ»Ğ¸Ñ‚Ğ¸ Ğ¾Ğ³Ğ¾Ğ»Ğ¾ÑˆĞµĞ½Ğ½Ñ</button>
       </div>

       <!-- ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´Ğ¸ -->
       <div class="section-header">ğŸ ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´Ğ¸</div>
       <div class="box">
         <input id="promoCode" placeholder="ĞšĞ¾Ğ´ (Ğ½Ğ°Ğ¿Ñ€. SUMMER25)">
         <input id="promoValue" type="number" placeholder="Ğ¡ÑƒĞ¼Ğ° (â‚´)">
         <input id="promoUses" type="number" placeholder="ĞšÑ–Ğ»ÑŒĞºÑ–ÑÑ‚ÑŒ Ğ²Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ°Ğ½ÑŒ">
         <button class="btn-green" onclick="createPromo()">âœ… Ğ¡Ğ¢Ğ’ĞĞ Ğ˜Ğ¢Ğ˜ ĞŸĞ ĞĞœĞĞšĞĞ”</button>
       </div>
       <div id="promoList" style="margin-bottom:15px;"></div>
       <button class="btn-outline" onclick="loadPromos()">ğŸ”„ ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚Ğ¸ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´Ğ¸</button>

       <!-- ĞŸÑ–Ğ´Ñ‚Ñ€Ğ¸Ğ¼ĞºĞ° -->
       <div class="section-header">ğŸ’¬ Ğ—Ğ°Ğ¿Ğ¸Ñ‚Ğ¸ Ğ¿Ñ–Ğ´Ñ‚Ñ€Ğ¸Ğ¼ĞºĞ¸</div>
       <button class="btn-outline" onclick="loadSupportThreads()">ğŸ”„ Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶Ğ¸Ñ‚Ğ¸ Ñ‡Ğ°Ñ‚Ğ¸</button>
       <div id="supportThreadsList" style="margin-top:10px;"></div>

       <!-- Ğ ÑƒÑ‡Ğ½Ğµ Ğ¿Ñ–Ğ´Ñ‚Ğ²ĞµÑ€Ğ´Ğ¶ĞµĞ½Ğ½Ñ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ñ–Ğ² -->
       <div class="section-header">ğŸ’° ĞŸÑ–Ğ´Ñ‚Ğ²ĞµÑ€Ğ´Ğ¶ĞµĞ½Ğ½Ñ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ñ–Ğ²</div>
       <button class="btn-outline" onclick="loadDepositRequests()">ğŸ”„ Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶Ğ¸Ñ‚Ğ¸ Ğ·Ğ°ÑĞ²ĞºĞ¸</button>
       <div id="depositRequestsList" style="margin-top:10px;"></div>

       <!-- Ğ—Ğ°ÑĞ²ĞºĞ¸ Ğ½Ğ° Ğ²Ğ¸Ğ²Ñ–Ğ´ -->
       <div class="section-header">ğŸ’¸ Ğ—Ğ°ÑĞ²ĞºĞ¸ Ğ½Ğ° Ğ²Ğ¸Ğ²Ñ–Ğ´</div>
       <button class="btn-outline" onclick="loadWithdrawRequests()">ğŸ”„ Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶Ğ¸Ñ‚Ğ¸ Ğ·Ğ°ÑĞ²ĞºĞ¸</button>
       <div id="withdrawRequestsList" style="margin-top:10px;"></div>
       <div id="withdrawRequestsContent"></div>

       <!-- Ğ¢ÑƒÑ€Ğ½Ñ–Ñ€Ğ¸ -->
       <div class="section-header">ğŸ† Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»Ñ–Ğ½Ğ½Ñ Ñ‚ÑƒÑ€Ğ½Ñ–Ñ€Ğ°Ğ¼Ğ¸</div>
       <div class="box">
         <input id="tName" placeholder="ĞĞ°Ğ·Ğ²Ğ° Ñ‚ÑƒÑ€Ğ½Ñ–Ñ€Ñƒ">
         <input id="tPrize" type="number" placeholder="ĞŸÑ€Ğ¸Ğ·Ğ¾Ğ²Ğ¸Ğ¹ Ñ„Ğ¾Ğ½Ğ´ (â‚´)">
         <input id="tDuration" type="number" placeholder="Ğ¢Ñ€Ğ¸Ğ²Ğ°Ğ»Ñ–ÑÑ‚ÑŒ (Ğ³Ğ¾Ğ´Ğ¸Ğ½)">
         <button class="btn-gold" onclick="createTournament()">ğŸ† Ğ¡Ğ¢Ğ’ĞĞ Ğ˜Ğ¢Ğ˜ Ğ¢Ğ£Ğ ĞĞ†Ğ </button>
       </div>

       <!-- Ğ“Ñ€Ğ°Ğ²Ñ†Ñ– -->
       <div class="section-header">ğŸ‘¥ Ğ“Ñ€Ğ°Ğ²Ñ†Ñ–</div>
       <div class="box">
           <button class="btn-outline" onclick="loadUserList()">ğŸ”„ ĞĞ½Ğ¾Ğ²Ğ¸Ñ‚Ğ¸ ÑĞ¿Ğ¸ÑĞ¾Ğº</button>
           <button class="btn-red" onclick="wipeEconomy()">ğŸ’€ ĞĞ‘ĞĞ£Ğ›Ğ˜Ğ¢Ğ˜ Ğ’Ğ¡Ğ†Ğ¥ (1000)</button>
       </div>
       <div id="userList" style="margin-top:10px;">ĞĞ°Ñ‚Ğ¸ÑĞ½Ñ–Ñ‚ÑŒ "ĞĞ½Ğ¾Ğ²Ğ¸Ñ‚Ğ¸ ÑĞ¿Ğ¸ÑĞ¾Ğº"</div>
    </div>
    <!-- Ğ‘Ğ›Ğ•ĞšĞ”Ğ–Ğ•Ğš -->
    <div id="tab-blackjack" class="screen hidden">
      <button class="btn-outline" onclick="switchTab('lobby')">â¬… Ğ›Ğ¾Ğ±Ñ–</button>
      <div class="bj-table">
        <div class="bj-area"><div class="bj-label">ğŸ¦ Ğ”Ğ¸Ğ»ĞµÑ€</div><div class="bj-cards" id="bjDealerCards"></div><div class="bj-score" id="bjDealerScore">â€”</div></div>
        <div style="border-top:1px solid rgba(255,255,255,0.1);margin:10px 0;"></div>
        <div class="bj-area"><div class="bj-label">ğŸ‘¤ Ğ’Ğ¸</div><div class="bj-cards" id="bjPlayerCards"></div><div class="bj-score" id="bjPlayerScore">â€”</div></div>
        <div id="bjResult" style="text-align:center;font-size:18px;font-weight:bold;min-height:28px;margin-top:8px;"></div>
      </div>
      <div class="box">
        <input id="betAmountBJ" type="number" value="100">
        <button class="btn-gold" id="bjDealBtn" onclick="bjDeal()">ğŸƒ Ğ ĞĞ—Ğ”ĞĞ¢Ğ˜</button>
        <div class="bj-actions hidden" id="bjActions">
          <button class="btn-green" onclick="bjHit()">â• Ğ©Ğ• ĞšĞĞ Ğ¢Ğ£</button>
          <button class="btn-red" onclick="bjStand()">âœ‹ Ğ¡Ğ¢ĞĞŸ</button>
        </div>
      </div>
    </div>

    <!-- ĞšĞ•ĞĞ -->
    <div id="tab-keno" class="screen hidden">
      <button class="btn-outline" onclick="switchTab('lobby')">â¬… Ğ›Ğ¾Ğ±Ñ–</button>
      <div class="box">
        <div style="color:#aaa;font-size:12px;text-align:center;margin-bottom:10px;">ĞĞ±ĞµÑ€Ğ¸ Ğ²Ñ–Ğ´ 1 Ğ´Ğ¾ 10 Ñ‡Ğ¸ÑĞµĞ» (1â€“40)</div>
        <div class="keno-grid" id="kenoGrid"></div>
        <div id="kenoSelected" style="color:#777;font-size:12px;text-align:center;margin-bottom:5px;">ĞĞ±Ñ€Ğ°Ğ½Ğ¾: 0 / 10</div>
      </div>
      <div class="box">
        <input id="betAmountKeno" type="number" value="100">
        <button class="btn-gold" onclick="playKeno()">ğŸ”¢ Ğ“Ğ ĞĞ¢Ğ˜</button>
        <button class="btn-outline" onclick="clearKeno()">ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚Ğ¸</button>
      </div>
    </div>

    <!-- Ğ¡ĞšĞ Ğ•Ğ¢Ğ§ -->
    <div id="tab-scratch" class="screen hidden">
      <button class="btn-outline" onclick="switchTab('lobby')">â¬… Ğ›Ğ¾Ğ±Ñ–</button>
      <div class="box">
        <div style="color:#aaa;font-size:12px;text-align:center;margin-bottom:12px;">ĞĞ°Ñ‚Ğ¸ÑĞºĞ°Ğ¹ Ğ½Ğ° ĞºĞ»Ñ–Ñ‚Ğ¸Ğ½ĞºĞ¸ Ñ‰Ğ¾Ğ± ÑÑ‚ĞµÑ€Ñ‚Ğ¸ ğŸ‘†</div>
        <div class="scratch-grid" id="scratchGrid"></div>
        <div id="scratchResult" style="text-align:center;min-height:24px;font-size:14px;margin-top:8px;"></div>
      </div>
      <div class="box">
        <input id="betAmountScratch" type="number" value="50">
        <button class="btn-gold" id="scratchBuyBtn" onclick="buyScratch()">ğŸŸï¸ ĞšĞ£ĞŸĞ˜Ğ¢Ğ˜ ĞšĞĞ Ğ¢ĞšĞ£</button>
      </div>
    </div>

    <!-- ĞšĞĞ›Ğ•Ğ¡Ğ Ğ¤ĞĞ Ğ¢Ğ£ĞĞ˜ -->
    <div id="tab-fortune" class="screen hidden">
      <button class="btn-outline" onclick="switchTab('lobby')">â¬… Ğ›Ğ¾Ğ±Ñ–</button>
      <div class="box" style="text-align:center;">
        <div class="fortune-wheel-wrap">
          <div class="wheel-arrow">â–¼</div>
          <canvas id="fortuneCanvas" width="260" height="260" style="border-radius:50%;border:6px solid #8B6914;display:block;"></canvas>
          <div class="wheel-center">â˜…</div>
        </div>
        <div id="fortuneResult" style="font-size:18px;font-weight:bold;min-height:28px;margin-bottom:10px;"></div>
      </div>
      <div class="box">
        <input id="betAmountFortune" type="number" value="100">
        <button class="btn-gold" id="fortuneBtn" onclick="spinFortune()">ğŸ¡ ĞšĞ Ğ£Ğ¢Ğ˜Ğ¢Ğ˜</button>
        <div style="font-size:11px;color:#555;text-align:center;margin-top:5px;">x0.2 â€¢ x0.5 â€¢ x1 â€¢ x2 â€¢ x3 â€¢ x5 â€¢ x10 â€¢ Ğ”Ğ¶ĞµĞºĞ¿Ğ¾Ñ‚ x50</div>
      </div>
    </div>

    <!-- Ğ§ĞĞ¢ Ğ›ĞĞ‘Ğ† -->
    <div id="tab-chat" class="screen hidden">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
        <h2 style="margin:0;color:var(--accent);">ğŸ’¬ Ğ§Ğ°Ñ‚ Ğ›Ğ¾Ğ±Ñ–</h2>
        <div style="font-size:12px;color:var(--green);"><span class="online-badge"></span><span id="onlineCount">â€”</span> Ğ¾Ğ½Ğ»Ğ°Ğ¹Ğ½</div>
      </div>
      <div id="announceBanner" class="hidden" style="background:#1a1a00;border:1px solid var(--accent);border-radius:8px;padding:10px;margin-bottom:10px;font-size:13px;color:var(--accent);"></div>
      <div class="chat-box" id="lobbyChatBox"></div>
      <div class="chat-input-row">
        <input id="lobbyChatInput" placeholder="ĞŸĞ¾Ğ²Ñ–Ğ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ½Ñ..." style="margin:0;" onkeypress="if(event.key==='Enter')sendLobbyMsg()">
        <button class="btn-gold" style="width:auto;padding:14px 18px;margin:0;" onclick="sendLobbyMsg()">â¤</button>
      </div>
    </div>

    <!-- Ğ”Ğ£Ğ•Ğ›Ğ† -->
    <div id="tab-duels" class="screen hidden">
      <h2 style="color:var(--accent);">âš”ï¸ Ğ”ÑƒĞµĞ»Ñ–</h2>
      <div class="box">
        <div style="color:#aaa;font-size:13px;margin-bottom:10px;">Ğ’Ğ¸ĞºĞ»Ğ¸Ñ‡ Ğ³Ñ€Ğ°Ğ²Ñ†Ñ â€” Ğ¿ĞµÑ€ĞµĞ¼Ğ¾Ğ¶ĞµÑ†ÑŒ Ğ·Ğ°Ğ±Ğ¸Ñ€Ğ°Ñ” Ğ²ÑĞµ!</div>
        <input id="duelTarget" placeholder="ĞÑ–Ğº ÑÑƒĞ¿ĞµÑ€Ğ½Ğ¸ĞºĞ°">
        <input id="duelAmount" type="number" placeholder="Ğ¡Ñ‚Ğ°Ğ²ĞºĞ° (â‚´)">
        <button class="btn-red" onclick="createDuel()">âš”ï¸ ĞšĞ˜ĞĞ£Ğ¢Ğ˜ Ğ’Ğ˜ĞšĞ›Ğ˜Ğš</button>
      </div>
      <div class="section-header">ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ– Ğ´ÑƒĞµĞ»Ñ–</div>
      <div id="duelsList" style="color:#777;font-size:13px;">ĞĞµĞ¼Ğ°Ñ” Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¸Ñ… Ğ´ÑƒĞµĞ»ĞµĞ¹</div>
      <div class="section-header">ĞœĞ¾Ñ— Ğ²Ğ¸ĞºĞ»Ğ¸ĞºĞ¸</div>
      <div id="myDuelsList" style="color:#777;font-size:13px;">ĞĞµĞ¼Ğ°Ñ”</div>
    </div>

    <!-- Ğ¢Ğ£Ğ ĞĞ†Ğ Ğ˜ -->
    <div id="tab-tournaments" class="screen hidden">
      <h2 style="color:var(--accent);">ğŸ† Ğ¢ÑƒÑ€Ğ½Ñ–Ñ€Ğ¸</h2>
      <div id="tournamentsList"></div>
    </div>

    <!-- Ğ Ğ•Ğ¤Ğ•Ğ ĞĞ›Ğ˜ -->
    <div id="tab-referrals" class="screen hidden">
      <h2 style="color:var(--accent);">ğŸ‘¥ Ğ ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ¸</h2>
      <div class="box">
        <div style="color:#aaa;font-size:13px;margin-bottom:12px;">Ğ—Ğ°Ğ¿Ñ€Ğ¾ÑĞ¸ Ğ´Ñ€ÑƒĞ³Ğ° â€” Ğ¾Ñ‚Ñ€Ğ¸Ğ¼Ğ°Ğ¹ <b style="color:var(--accent);">10%</b> Ğ²Ñ–Ğ´ Ğ¹Ğ¾Ğ³Ğ¾ Ğ¿ĞµÑ€ÑˆĞ¾Ğ³Ğ¾ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ñƒ!</div>
        <div class="ref-link-box">
          <span id="refLinkText" style="flex:1;">Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ...</span>
          <button class="btn-gold" style="width:auto;padding:8px 12px;margin:0;font-size:12px;flex-shrink:0;" onclick="copyRefLink()">ğŸ“‹ ĞšĞ¾Ğ¿Ñ–ÑĞ²Ğ°Ñ‚Ğ¸</button>
        </div>
        <div style="display:flex;gap:10px;margin-top:10px;">
          <div class="ref-stat"><div class="ref-stat-num" id="refCount">0</div><div class="ref-stat-label">Ğ—Ğ°Ğ¿Ñ€Ğ¾ÑˆĞµĞ½Ğ¾</div></div>
          <div class="ref-stat"><div class="ref-stat-num" id="refEarned">0â‚´</div><div class="ref-stat-label">Ğ—Ğ°Ñ€Ğ¾Ğ±Ğ»ĞµĞ½Ğ¾</div></div>
        </div>
      </div>
      <div class="section-header">Ğ—Ğ°Ğ¿Ñ€Ğ¾ÑˆĞµĞ½Ñ– Ğ³Ñ€Ğ°Ğ²Ñ†Ñ–</div>
      <div id="refFriendsList" style="color:#777;font-size:13px;padding:5px 0;">ĞŸĞ¾ĞºĞ¸ Ğ½Ñ–ĞºĞ¾Ğ³Ğ¾ Ğ½ĞµĞ¼Ğ°Ñ”</div>
    </div>

    <!-- ĞŸĞ£Ğ‘Ğ›Ğ†Ğ§ĞĞ˜Ğ™ ĞŸĞ ĞĞ¤Ğ†Ğ›Ğ¬ (Ğ¼Ğ¾Ğ´Ğ°Ğ») -->
    <div id="pub-profile-modal" class="full-modal hidden">
      <button class="btn-outline" onclick="closeModal('pub-profile-modal')" style="width:50px;">â¬…</button>
      <div id="pubProfileContent" style="margin-top:10px;"></div>
    </div>

    <!-- ĞĞ”ĞœĞ†Ğ ĞŸĞ†Ğ”Ğ¢Ğ Ğ˜ĞœĞšĞ -->
    <div id="admin-support-modal" class="full-modal hidden">
      <button class="btn-outline" onclick="closeModal('admin-support-modal')" style="width:50px;">â¬…</button>
      <h2 id="admSupportTitle" style="color:var(--accent);">Ğ§Ğ°Ñ‚ Ğ¿Ñ–Ğ´Ñ‚Ñ€Ğ¸Ğ¼ĞºĞ¸</h2>
      <div id="admSupportChat" style="height:320px;overflow-y:auto;background:#111;border:1px solid #333;margin-bottom:10px;padding:10px;border-radius:8px;"></div>
      <div style="display:flex;gap:8px;">
        <input id="admSupportReply" placeholder="Ğ’Ñ–Ğ´Ğ¿Ğ¾Ğ²Ñ–Ğ´ÑŒ..." style="margin:0;">
        <button class="btn-gold" style="width:auto;margin:0;" onclick="sendAdminSupportReply()">â¤</button>
      </div>
    </div>

    <!-- Ğ”Ğ£Ğ•Ğ›Ğ¬ â€” Ğ²Ñ…Ñ–Ğ´Ğ½Ğ¸Ğ¹ Ğ²Ğ¸ĞºĞ»Ğ¸Ğº -->
    <div id="duel-incoming-modal" class="full-modal hidden">
      <div style="margin-top:30vh;text-align:center;">
        <div style="font-size:60px;margin-bottom:15px;">âš”ï¸</div>
        <h2 style="color:var(--red);">Ğ’Ğ°Ñ Ğ²Ğ¸ĞºĞ»Ğ¸ĞºĞ°Ğ»Ğ¸ Ğ½Ğ° Ğ´ÑƒĞµĞ»ÑŒ!</h2>
        <div id="duelIncomingInfo" style="color:#aaa;margin-bottom:25px;font-size:15px;line-height:1.6;"></div>
        <button class="btn-green" style="margin-bottom:10px;" onclick="acceptDuel()">âœ… ĞŸĞ Ğ˜Ğ™ĞĞ¯Ğ¢Ğ˜</button>
        <button class="btn-outline" onclick="declineDuel()">âŒ Ğ’Ñ–Ğ´Ñ…Ğ¸Ğ»Ğ¸Ñ‚Ğ¸</button>
      </div>
    </div>

  </div><!-- /container -->

  <!-- Ğ‘ĞĞšĞšĞĞ Ğ -->
  <div id="tab-baccarat" class="screen hidden" style="padding:15px;">
    <button class="btn-outline" onclick="switchTab('lobby')">â¬… Ğ›Ğ¾Ğ±Ñ–</button>
    <div class="baccarat-table">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:10px;">
        <div class="bj-area"><div class="bj-label">ğŸ´ Ğ“Ñ€Ğ°Ğ²ĞµÑ†ÑŒ</div><div class="bj-cards" id="baccPlayerCards"></div><div class="bj-score" id="baccPlayerScore">â€”</div></div>
        <div class="bj-area"><div class="bj-label">ğŸ¦ Ğ‘Ğ°Ğ½ĞºÑ–Ñ€</div><div class="bj-cards" id="baccBankerCards"></div><div class="bj-score" id="baccBankerScore">â€”</div></div>
      </div>
      <div id="baccResult" style="text-align:center;font-size:18px;font-weight:bold;min-height:28px;"></div>
    </div>
    <div class="box">
      <div class="bacc-bet-grid">
        <div class="bet-btn" onclick="selectBaccBet('player',this)">ğŸ´ Ğ“Ñ€Ğ°Ğ²ĞµÑ†ÑŒ (x2)</div>
        <div class="bet-btn" onclick="selectBaccBet('tie',this)">ğŸ¤ ĞÑ–Ñ‡Ğ¸Ñ (x9)</div>
        <div class="bet-btn" onclick="selectBaccBet('banker',this)">ğŸ¦ Ğ‘Ğ°Ğ½ĞºÑ–Ñ€ (x1.95)</div>
      </div>
      <input id="betAmountBacc" type="number" value="100">
      <button class="btn-gold" onclick="playBaccarat()">ğŸ´ Ğ ĞĞ—Ğ”ĞĞ¢Ğ˜</button>
    </div>
  </div>

  <!-- Ğ¡Ğ†Ğš-Ğ‘Ğ -->
  <div id="tab-sicbo" class="screen hidden" style="padding:15px;">
    <button class="btn-outline" onclick="switchTab('lobby')">â¬… Ğ›Ğ¾Ğ±Ñ–</button>
    <div class="box" style="text-align:center;">
      <div class="dice-display">
        <div class="die" id="die1">âš€</div>
        <div class="die" id="die2">âš</div>
        <div class="die" id="die3">âš‚</div>
      </div>
      <div id="sicboResult" style="font-size:16px;font-weight:bold;min-height:24px;"></div>
    </div>
    <div class="box">
      <div class="sic-bo-bets">
        <div class="sic-bo-btn" onclick="selectSicBo('small',this)"><div class="sb-title">â¬‡ï¸ ĞœĞ°Ğ»Ğ¾ (4-10)</div><div class="sb-mult">x2</div></div>
        <div class="sic-bo-btn" onclick="selectSicBo('big',this)"><div class="sb-title">â¬†ï¸ Ğ’ĞµĞ»Ğ¸ĞºĞ¾ (11-17)</div><div class="sb-mult">x2</div></div>
        <div class="sic-bo-btn" onclick="selectSicBo('triple',this)"><div class="sb-title">ğŸ¯ Ğ¢Ñ€Ğ¸Ğ¿Ğ»ÑŒ</div><div class="sb-mult">x30</div></div>
        <div class="sic-bo-btn" onclick="selectSicBo('even',this)"><div class="sb-title">ğŸ”µ ĞŸĞ°Ñ€Ğ½Ğµ</div><div class="sb-mult">x2</div></div>
        <div class="sic-bo-btn" onclick="selectSicBo('odd',this)"><div class="sb-title">ğŸ”´ ĞĞµĞ¿Ğ°Ñ€Ğ½Ğµ</div><div class="sb-mult">x2</div></div>
        <div class="sic-bo-btn" onclick="selectSicBo('pair',this)"><div class="sb-title">ğŸ‘¯ ĞŸĞ°Ñ€Ğ°</div><div class="sb-mult">x8</div></div>
      </div>
      <input id="betAmountSicBo" type="number" value="100">
      <button class="btn-gold" onclick="rollSicBo()">ğŸ² ĞšĞ˜ĞĞ£Ğ¢Ğ˜ ĞšĞĞ¡Ğ¢Ğ†</button>
    </div>
  </div>

  <!-- ĞœĞĞ“ĞĞ—Ğ˜Ğ -->
  <div id="tab-shop" class="screen hidden" style="padding:15px;">
    <h2 style="color:var(--accent);">ğŸ›ï¸ ĞœĞ°Ğ³Ğ°Ğ·Ğ¸Ğ½</h2>
    <div class="section-header">ĞĞ²Ğ°Ñ‚Ğ°Ñ€Ğ¸</div>
    <div class="shop-grid" id="shopAvatars"></div>
    <div class="section-header" style="margin-top:20px;">Ğ Ğ°Ğ¼ĞºĞ¸ Ğ¿Ñ€Ğ¾Ñ„Ñ–Ğ»Ñ</div>
    <div class="shop-grid" id="shopFrames"></div>
  </div>

  <!-- Ğ”ĞĞ¡Ğ¯Ğ“ĞĞ•ĞĞĞ¯ -->
  <div id="tab-achievements" class="screen hidden" style="padding:15px;">
    <h2 style="color:var(--accent);">ğŸ… Ğ”Ğ¾ÑÑĞ³Ğ½ĞµĞ½Ğ½Ñ</h2>
    <div style="color:#777;font-size:13px;margin-bottom:15px;">Ğ Ğ¾Ğ·Ğ±Ğ»Ğ¾ĞºĞ¾Ğ²Ğ°Ğ½Ğ¾: <span id="achUnlockedCount" style="color:var(--accent);font-weight:bold;">0</span> / <span id="achTotalCount">0</span></div>
    <div class="achievements-grid" id="achievementsList"></div>
  </div>

  <!-- Ğ¡ĞšĞĞ Ğ‘ĞĞ˜Ğ¦Ğ¯ -->
  <div id="tab-vault" class="screen hidden" style="padding:15px;">
    <h2 style="color:var(--accent);">ğŸ¦ Ğ¡ĞºĞ°Ñ€Ğ±Ğ½Ğ¸Ñ†Ñ</h2>
    <div class="vault-box">
      <div style="font-size:30px;margin-bottom:8px;">ğŸ¦</div>
      <div class="vault-balance"><span id="vaultBalance">0</span> â‚´</div>
      <div class="vault-info">+5% Ñ‰Ğ¾Ğ´Ğ½Ñ â€¢ Ğ’Ğ¸Ğ²Ğ¾Ğ´Ğ¸Ñ‚Ğ¸ Ğ¼Ğ¾Ğ¶Ğ½Ğ° Ğ±ÑƒĞ´ÑŒ-ĞºĞ¾Ğ»Ğ¸</div>
      <div id="vaultAccrued" style="color:var(--green);font-size:13px;margin-top:5px;"></div>
    </div>
    <div class="box">
      <input id="vaultDeposit" type="number" placeholder="Ğ¡ÑƒĞ¼Ğ° Ğ´Ğ»Ñ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ñƒ Ğ² ÑĞºĞ°Ñ€Ğ±Ğ½Ğ¸Ñ†Ñ">
      <button class="btn-gold" onclick="depositVault()">ğŸ’° ĞŸĞĞšĞ›ĞĞ¡Ğ¢Ğ˜</button>
      <input id="vaultWithdraw" type="number" placeholder="Ğ¡ÑƒĞ¼Ğ° Ğ´Ğ»Ñ Ğ²Ğ¸Ğ²Ğ¾Ğ´Ñƒ Ğ·Ñ– ÑĞºĞ°Ñ€Ğ±Ğ½Ğ¸Ñ†Ñ–">
      <button class="btn-green" onclick="withdrawVault()">ğŸ’¸ Ğ—ĞĞ‘Ğ ĞĞ¢Ğ˜</button>
    </div>
    <div class="box" style="text-align:center;">
      <div style="color:#777;font-size:12px;">Ğ’Ğ°Ñˆ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ Ğ·Ñ€Ğ¾ÑÑ‚Ğ°Ñ” ĞºĞ¾Ğ¶Ğ½Ñƒ Ğ´Ğ¾Ğ±Ñƒ Ğ½Ğ° 5%</div>
    </div>
  </div>

  <!-- Ğ›ĞĞ¢Ğ•Ğ Ğ•Ğ¯ -->
  <div id="tab-lottery" class="screen hidden" style="padding:15px;">
    <h2 style="color:var(--accent);">ğŸ« Ğ›Ğ¾Ñ‚ĞµÑ€ĞµÑ</h2>
    <div class="box" style="text-align:center;">
      <div style="font-size:14px;color:#777;margin-bottom:10px;">Ğ©Ğ¾Ğ´ĞµĞ½Ğ½Ğ¸Ğ¹ Ñ€Ğ¾Ğ·Ñ–Ğ³Ñ€Ğ°Ñˆ Ğ¾ 20:00</div>
      <div style="font-size:28px;font-weight:900;color:var(--accent);margin-bottom:5px;">ğŸ† ĞŸÑ€Ğ¸Ğ·Ğ¾Ğ²Ğ¸Ğ¹ Ñ„Ğ¾Ğ½Ğ´</div>
      <div id="lotteryPrize" style="font-size:36px;font-weight:900;color:var(--green);">0 â‚´</div>
      <div style="color:#555;font-size:12px;margin-top:8px;">100â‚´ Ğ·Ğ° ĞºĞ²Ğ¸Ñ‚Ğ¾Ğº â€¢ 10% Ğ²Ñ–Ğ´ Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ñ–Ğ² Ğ´Ğ¾ Ñ„Ğ¾Ğ½Ğ´Ñƒ</div>
    </div>
    <div class="box">
      <div style="font-size:14px;color:#aaa;margin-bottom:12px;">ĞœĞ¾Ñ— ĞºĞ²Ğ¸Ñ‚ĞºĞ¸: <span id="myTicketCount" style="color:var(--accent);font-weight:bold;">0</span></div>
      <input id="ticketCount" type="number" value="1" placeholder="ĞšÑ–Ğ»ÑŒĞºÑ–ÑÑ‚ÑŒ ĞºĞ²Ğ¸Ñ‚ĞºÑ–Ğ²">
      <button class="btn-gold" onclick="buyTickets()">ğŸ« ĞšĞ£ĞŸĞ˜Ğ¢Ğ˜ ĞšĞ’Ğ˜Ğ¢ĞšĞ˜ (100â‚´/ÑˆÑ‚)</button>
    </div>
    <div class="section-header">ĞÑÑ‚Ğ°Ğ½Ğ½Ñ– Ğ¿ĞµÑ€ĞµĞ¼Ğ¾Ğ¶Ñ†Ñ–</div>
    <div id="lotteryWinners" style="color:#777;font-size:13px;">Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ...</div>
  </div>

  <!-- Ğ¡Ğ¢ĞĞ¢Ğ˜Ğ¡Ğ¢Ğ˜ĞšĞ (Ğ³Ñ€Ğ°Ñ„Ñ–Ğº) â€” Ğ¼Ğ¾Ğ´Ğ°Ğ» -->
  <div id="stats-modal" class="full-modal hidden">
    <button class="btn-outline" onclick="closeModal('stats-modal')" style="width:50px;">â¬…</button>
    <h2>ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ±Ğ°Ğ»Ğ°Ğ½ÑÑƒ</h2>
    <canvas class="balance-chart" id="balanceChart"></canvas>
    <div class="box" style="margin-top:15px;">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
        <div class="pub-stat"><div class="pub-stat-val" id="statMaxBal">â€”</div><div class="pub-stat-label">ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼</div></div>
        <div class="pub-stat"><div class="pub-stat-val" id="statMinBal">â€”</div><div class="pub-stat-label">ĞœÑ–Ğ½Ñ–Ğ¼ÑƒĞ¼</div></div>
        <div class="pub-stat"><div class="pub-stat-val" id="statGamesCount">â€”</div><div class="pub-stat-label">Ğ†Ğ³Ğ¾Ñ€ Ğ·Ñ–Ğ³Ñ€Ğ°Ğ½Ğ¾</div></div>
        <div class="pub-stat"><div class="pub-stat-val" id="statBigWin">â€”</div><div class="pub-stat-label">ĞĞ°Ğ¹Ğ±Ñ–Ğ»ÑŒÑˆĞ¸Ğ¹ Ğ²Ğ¸Ğ³Ñ€Ğ°Ñˆ</div></div>
      </div>
    </div>
  </div>

  </div><!-- /main-wrap -->

  <div id="auth-screen" class="full-modal">
      <div style="text-align:center; margin-bottom:30px;"><h1 style="color:var(--accent); font-size:50px; font-style:italic; font-weight:900;">SlotOK</h1><div style="color:#555; font-size:13px;">v36</div></div>
      <div id="loginForm">
        <h3 style="color:#fff;">Ğ’Ñ…Ñ–Ğ´</h3>
        <input id="loginName" placeholder="ĞÑ–ĞºĞ½ĞµĞ¹Ğ¼">
        <input id="loginPass" type="password" placeholder="ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ">
        <button class="btn-gold" onclick="authLogin()">Ğ£Ğ’Ğ†Ğ™Ğ¢Ğ˜</button>
        <div style="text-align:center; margin-top:20px; color:#777; cursor:pointer;" onclick="toggleAuthMode(true)">Ğ¡Ñ‚Ğ²Ğ¾Ñ€Ğ¸Ñ‚Ğ¸ Ğ°ĞºĞ°ÑƒĞ½Ñ‚ â†’</div>
      </div>
      <div id="regForm" class="hidden">
        <h3 style="color:#fff;">Ğ ĞµÑ”ÑÑ‚Ñ€Ğ°Ñ†Ñ–Ñ</h3>
        <input id="regEmail" placeholder="Email">
        <input id="regName" placeholder="ĞÑ–ĞºĞ½ĞµĞ¹Ğ¼ (Ğ±ĞµĞ· Ğ¿Ñ€Ğ¾Ğ±Ñ–Ğ»Ñ–Ğ²)">
        <input id="regPass" type="password" placeholder="ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ (Ğ¼Ñ–Ğ½ 8 ÑĞ¸Ğ¼Ğ²)">
        <button class="btn-green" onclick="authRegister()">Ğ¡Ğ¢Ğ’ĞĞ Ğ˜Ğ¢Ğ˜</button>
        <div style="text-align:center; margin-top:20px; color:#777; cursor:pointer;" onclick="toggleAuthMode(false)">â† Ğ’Ğ¶Ğµ Ñ” Ğ°ĞºĞ°ÑƒĞ½Ñ‚? Ğ£Ğ²Ñ–Ğ¹Ñ‚Ğ¸</div>
      </div>
  </div>
  
  <!-- MODALS -->
  <div id="admin-user-manage" class="full-modal hidden">
      <button class="btn-outline" onclick="closeModal('admin-user-manage')" style="width:50px;">â¬…</button>
      <h2 id="admManageName" style="color:var(--accent)">Ğ“Ñ€Ğ°Ğ²ĞµÑ†ÑŒ</h2>
      <div class="box">
        <input id="admAmount" type="number" placeholder="Ğ¡ÑƒĞ¼Ğ° (+ Ğ°Ğ±Ğ¾ -)">
        <button class="btn-green" onclick="admGiveMoney()">Ğ—Ğ¼Ñ–Ğ½Ğ¸Ñ‚Ğ¸ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ</button>
        <input id="admTag" placeholder="ĞĞ¾Ğ²Ğ¸Ğ¹ ÑÑ‚Ğ°Ñ‚ÑƒÑ">
        <button class="btn-outline" onclick="admSetTag()">Ğ—Ğ¼Ñ–Ğ½Ğ¸Ñ‚Ğ¸ ÑÑ‚Ğ°Ñ‚ÑƒÑ</button>
      </div>
      <div class="box" style="border-color:red;">
        <button class="btn-red" onclick="admBanUser()">ğŸš« Ğ—ĞĞ‘Ğ›ĞĞšĞ£Ğ’ĞĞ¢Ğ˜</button>
        <button class="btn-red" onclick="admDeleteUser()">âŒ Ğ’Ğ˜Ğ”ĞĞ›Ğ˜Ğ¢Ğ˜ ĞĞšĞĞ£ĞĞ¢</button>
      </div>
  </div>

  <div id="support-modal" class="full-modal hidden">
    <button class="btn-outline" onclick="closeModal('support-modal')" style="width:50px;">â¬…</button>
    <h2>ğŸ’¬ Ğ§Ğ°Ñ‚ ĞŸÑ–Ğ´Ñ‚Ñ€Ğ¸Ğ¼ĞºĞ¸</h2>
    <div id="supportChatBox" style="height:300px;overflow-y:auto;background:#111;border:1px solid #333;margin-bottom:10px;padding:10px;border-radius:8px;"></div>
    <div style="display:flex; gap:10px;">
      <input id="supportMsg" placeholder="ĞŸĞ¾Ğ²Ñ–Ğ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ½Ñ..." style="margin-bottom:0;">
      <button class="btn-gold" style="width:auto;margin-bottom:0;" onclick="sendSupportMsg()">â¤</button>
    </div>
  </div>

  <div id="transfer-modal" class="full-modal hidden">
    <button class="btn-outline" onclick="closeModal('transfer-modal')" style="width:50px;">â¬…</button>
    <h2>ğŸ’¸ ĞŸĞµÑ€ĞµĞºĞ°Ğ· Ğ”Ñ€ÑƒĞ³Ñƒ</h2>
    <input id="transferTo" placeholder="ĞÑ–Ğº Ğ¾Ñ‚Ñ€Ğ¸Ğ¼ÑƒĞ²Ğ°Ñ‡Ğ°">
    <input id="transferAmount" type="number" placeholder="Ğ¡ÑƒĞ¼Ğ° Ğ¿ĞµÑ€ĞµĞºĞ°Ğ·Ñƒ">
    <button class="btn-gold" onclick="sendMoney()">ĞĞĞ”Ğ†Ğ¡Ğ›ĞĞ¢Ğ˜</button>
  </div>

  <div id="promo-modal" class="full-modal hidden">
    <button class="btn-outline" onclick="closeModal('promo-modal')" style="width:50px;">â¬…</button>
    <h2>ğŸ ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´</h2>
    <input id="promoInput" placeholder="Ğ’Ğ²ĞµĞ´Ñ–Ñ‚ÑŒ ĞºĞ¾Ğ´">
    <button class="btn-gold" onclick="activatePromo()">ĞĞšĞ¢Ğ˜Ğ’Ğ£Ğ’ĞĞ¢Ğ˜</button>
  </div>

  <div id="history-modal" class="full-modal hidden">
    <button class="btn-outline" onclick="closeModal('history-modal')" style="width:50px;">â¬…</button>
    <h2>ğŸ“œ Ğ†ÑÑ‚Ğ¾Ñ€Ñ–Ñ Ğ¢Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ñ–Ğ¹</h2>
    <div id="historyList" style="background:#111; border-radius:8px; border:1px solid #333;"></div>
  </div>

  <div id="view-user-modal" class="full-modal hidden" onclick="closeModal('view-user-modal')">
    <div onclick="event.stopPropagation()" style="margin-top:20vh;">
      <div class="box" style="text-align:center;">
        <div class="avatar-large" id="viewUserAvatar" style="margin:0 auto 15px auto;">ğŸ‘¤</div>
        <h2 style="margin:0; color:var(--accent)" id="viewUserName">Name</h2>
        <div id="viewUserTag" style="color:#777; margin-bottom:5px;"></div>
        <p style="color:#555;">ID: <span id="viewUserId">000</span></p>
        <div style="font-size:28px; font-weight:bold; margin-bottom:20px; color:var(--green);"><span id="viewUserBal">0</span> â‚´</div>
        <button class="btn-outline" onclick="closeModal('view-user-modal')">Ğ—Ğ°ĞºÑ€Ğ¸Ñ‚Ğ¸</button>
      </div>
    </div>
  </div>

  <!-- Ğ©ĞĞ”Ğ•ĞĞĞ˜Ğ™ Ğ‘ĞĞĞ£Ğ¡ ĞœĞĞ”ĞĞ› -->
  <div id="daily-bonus-modal" class="full-modal hidden">
    <button class="btn-outline" onclick="closeModal('daily-bonus-modal')" style="width:50px;">â¬…</button>
    <div class="daily-bonus-modal-content" id="dailyBonusContent"></div>
  </div>

  <nav class="bottom-nav">
    <div class="nav-item active" onclick="switchTab('home', this)"><span class="icon">ğŸ </span><span>Ğ“Ğ¾Ğ»Ğ¾Ğ²Ğ½Ğ°</span></div>
    <div class="nav-item" onclick="switchTab('lobby', this)"><span class="icon">ğŸ°</span><span>ĞšĞ°Ğ·Ğ¸Ğ½Ğ¾</span></div>
    <div class="nav-item" onclick="switchTab('chat', this)"><span class="icon">ğŸ’¬</span><span>Ğ§Ğ°Ñ‚</span></div>
    <div class="nav-item" onclick="switchTab('cashier', this)"><span class="icon">ğŸ’³</span><span>ĞšĞ°ÑĞ°</span></div>
    <div class="nav-item" onclick="switchTab('top', this)"><span class="icon">ğŸ†</span><span>Ğ¢Ğ¾Ğ¿</span></div>
    <div class="nav-item" onclick="switchTab('profile', this)"><span class="icon">ğŸ‘¤</span><span>ĞŸÑ€Ğ¾Ñ„Ñ–Ğ»ÑŒ</span></div>
    <div class="nav-item" onclick="switchTab('more', this)"><span class="icon">âš™ï¸</span><span>Ğ©Ğµ</span></div>
  </nav>

  <script>
    // ============================================
    // Ğ†ĞĞ†Ğ¦Ğ†ĞĞ›Ğ†Ğ—ĞĞ¦Ğ†Ğ¯
    // ============================================
    setTimeout(() => {
        const loader = document.getElementById('loading-overlay');
        if(loader) { loader.style.opacity = '0'; setTimeout(() => loader.classList.add('hidden'), 500); }
    }, 1500);

    const firebaseConfig = { 
        apiKey: "AIzaSyB0gJDyr8z2SWPV3Tf73ZRNNPuglxHTCZw", 
        authDomain: "slotok-web-server.firebaseapp.com", 
        databaseURL: "https://slotok-web-server-default-rtdb.firebaseio.com", 
        projectId: "slotok-web-server", 
        storageBucket: "slotok-web-server.firebasestorage.app", 
        messagingSenderId: "1086314476940", 
        appId: "1:1086314476940:web:d3629d2d0fe16f7c1f12a9" 
    };
    
    try { if (!firebase.apps.length) firebase.initializeApp(firebaseConfig); } 
    catch(e) { console.error("Firebase init error", e); }
    const db = firebase.database();

    // ============================================
    // ĞĞ¡ĞĞĞ’ĞĞ† Ğ—ĞœĞ†ĞĞĞ†
    // ============================================
    let currentUser = null; 
    let userData = {}; 
    let currentRouletteBet = null;
    let selectedWithdrawMethod = 'privat';
    let selectedDepAmount = 0;
    const MAX_BET = 100000; 
    let audioCtx = null;

    // Telegram Bot Username â€” Ğ·Ğ°Ğ¼Ñ–Ğ½Ğ¸Ñ‚Ğ¸ Ğ½Ğ° ÑĞ²Ñ–Ğ¹!
    const TG_BOT_USERNAME = 'SlotOK_DepositBot';

    // ============================================
    // ĞŸĞ•Ğ Ğ•Ğ’Ğ†Ğ ĞšĞ Ğ›ĞĞ“Ğ†ĞĞ£
    // ============================================
    const savedUser = localStorage.getItem("royal_online_user");
    if(savedUser) { currentUser = savedUser; startDataSync(); }

    function startDataSync() {
        try {
            db.ref('users/' + currentUser).on('value', (snapshot) => {
                const data = snapshot.val();
                if(!data) { logout(); return; }
                userData = data; 
                if(userData.banned) { alert("Ğ’ĞĞ¨ ĞĞšĞĞ£ĞĞ¢ Ğ—ĞĞ‘Ğ›ĞĞšĞĞ’ĞĞĞ!"); logout(); return; }
                document.getElementById('auth-screen').classList.add('hidden');
                updateUI(); 
                loadContacts(); 
                checkAdmin();
                checkDailyBonus();
            }, (error) => {
                notify("ĞŸĞ¾Ğ¼Ğ¸Ğ»ĞºĞ° Ğ·Ğ²'ÑĞ·ĞºÑƒ Ğ· Ğ±Ğ°Ğ·Ğ¾Ñ.", "error");
            });
            db.ref('users').orderByChild('balance').limitToLast(20).on('value', snap => renderTop(snap.val()));
        } catch(e) { console.error("Sync error:", e); }
    }

    // ============================================
    // Ğ†ĞĞ¢Ğ•Ğ Ğ¤Ğ•Ğ™Ğ¡
    // ============================================
    function updateUI() {
        if(!userData) return;
        document.querySelectorAll('.bal').forEach(e => e.textContent = formatNumber(userData.balance));
        document.getElementById('profileName').textContent = currentUser;
        document.getElementById('profileId').textContent = userData.id || '---';
        document.getElementById('profileEmail').textContent = userData.email || "-";
        document.getElementById('profileTag').textContent = userData.tag || "Ğ“Ñ€Ğ°Ğ²ĞµÑ†ÑŒ";
        document.getElementById('cashierUserId').textContent = userData.id || '---';
        const avDiv = document.getElementById('currentAvatar');
        avDiv.innerHTML = (userData.avatar && userData.avatar.length > 20) ? `<img src="${userData.avatar}">` : 'ğŸ‘¤';
        loadMyWithdraws();
    }

    function checkAdmin() {
        if (currentUser.toLowerCase() === 'theivankoo' || userData.isAdmin === true) {
            document.getElementById('adminPanelBtnBox').classList.remove('hidden');
            document.getElementById('adminBadge').classList.remove('hidden');
        } else {
            document.getElementById('adminPanelBtnBox').classList.add('hidden');
            document.getElementById('adminBadge').classList.add('hidden');
        }
    }

    function formatNumber(num) {
        if(num >= 1000000000) return (num/1000000000).toFixed(1) + 'B';
        if(num >= 1000000) return (num/1000000).toFixed(1) + 'M';
        if(num >= 1000) return (num/1000).toFixed(1) + 'k';
        return Math.floor(num).toLocaleString();
    }

    function notify(msg, type='info') { 
        const c = document.getElementById('toast-container'); 
        const d = document.createElement('div'); 
        d.className = `toast ${type}`; 
        d.innerHTML = `<span>${msg}</span>`; 
        c.appendChild(d); 
        setTimeout(() => d.remove(), 3500); 
    }
    
    function playSound(type) { 
        try {
            if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if(audioCtx.state === 'suspended') audioCtx.resume(); 
            const o = audioCtx.createOscillator(); 
            const g = audioCtx.createGain(); 
            o.connect(g); g.connect(audioCtx.destination); 
            const t = audioCtx.currentTime; 
            if(type === 'click'){ o.frequency.value = 600; g.gain.exponentialRampToValueAtTime(0.01, t+0.1); o.start(t); o.stop(t+0.1); } 
            else if(type === 'win'){ o.type = 'triangle'; o.frequency.setValueAtTime(500, t); o.frequency.linearRampToValueAtTime(1000, t+0.5); g.gain.linearRampToValueAtTime(0, t+0.5); o.start(t); o.stop(t+0.5); } 
        } catch(e) {} 
    }
    
    function validateBet(amount) { 
        const bet = Math.abs(parseInt(amount)); 
        if(isNaN(bet) || bet <= 0 || bet > MAX_BET || userData.balance < bet) { 
            notify("ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ½ÑŒĞ¾ ĞºĞ¾ÑˆÑ‚Ñ–Ğ² Ğ°Ğ±Ğ¾ Ğ½ĞµĞ²Ñ–Ñ€Ğ½Ğ° ÑÑƒĞ¼Ğ°!", "error"); 
            return false; 
        } 
        return bet; 
    }
    
    function addToHistory(msg) { 
        try { db.ref(`users/${currentUser}/history`).push({text: msg, date: Date.now()}); } catch(e){} 
    }

    // ============================================
    // Ğ©ĞĞ”Ğ•ĞĞĞ˜Ğ™ Ğ‘ĞĞĞ£Ğ¡
    // ============================================
    const DAILY_BONUSES = [100, 150, 200, 300, 500, 750, 1000];

    function checkDailyBonus() {
        const lastClaim = userData.lastDailyBonus || 0;
        const now = Date.now();
        const dayMs = 24 * 60 * 60 * 1000;
        const canClaim = (now - lastClaim) >= dayMs;
        
        const banner = document.getElementById('dailyBonusBanner');
        if(canClaim) {
            banner.style.display = 'flex';
            banner.classList.remove('hidden');
        } else {
            banner.classList.add('hidden');
        }
    }

    function openDailyBonus() {
        const lastClaim = userData.lastDailyBonus || 0;
        const now = Date.now();
        const dayMs = 24 * 60 * 60 * 1000;
        const canClaim = (now - lastClaim) >= dayMs;
        const streak = userData.dailyStreak || 0;
        const bonusAmount = DAILY_BONUSES[Math.min(streak, 6)];
        
        const content = document.getElementById('dailyBonusContent');
        
        if(canClaim) {
            content.innerHTML = `
                <div class="bonus-icon">ğŸ</div>
                <h2 style="color:var(--accent);">Ğ©Ğ¾Ğ´ĞµĞ½Ğ½Ğ¸Ğ¹ Ğ‘Ğ¾Ğ½ÑƒÑ!</h2>
                <div style="color:#aaa; margin-bottom:10px;">Ğ”ĞµĞ½ÑŒ ${streak + 1} ÑĞµÑ€Ñ–Ñ—</div>
                <div class="bonus-amount">+${bonusAmount} â‚´</div>
                <div class="streak-dots">
                    ${DAILY_BONUSES.map((b, i) => `
                        <div class="streak-dot ${i < streak ? 'done' : i === streak ? 'today' : ''}" title="${b}â‚´">
                            ${i < streak ? 'âœ“' : i === streak ? 'â˜…' : i+1}
                        </div>
                    `).join('')}
                </div>
                <div style="color:#aaa; font-size:12px; margin-bottom:20px;">7 Ğ´Ğ½Ñ–Ğ² Ğ¿Ğ¾ÑĞ¿Ñ–Ğ»ÑŒ = 1000â‚´</div>
                <button class="btn-gold" style="font-size:18px; padding:18px;" onclick="claimDailyBonus(${bonusAmount})">
                    ğŸ Ğ—ĞĞ‘Ğ ĞĞ¢Ğ˜ ${bonusAmount} â‚´
                </button>
            `;
        } else {
            const msLeft = dayMs - (now - lastClaim);
            const h = Math.floor(msLeft / 3600000);
            const m = Math.floor((msLeft % 3600000) / 60000);
            content.innerHTML = `
                <div style="font-size:60px; margin-bottom:20px;">â°</div>
                <h2 style="color:#777;">Ğ’Ğ¶Ğµ Ğ·Ğ°Ğ±Ñ€Ğ°Ğ½Ğ¾</h2>
                <div style="color:#aaa; margin-bottom:10px;">ĞĞ°ÑÑ‚ÑƒĞ¿Ğ½Ğ¸Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ Ñ‡ĞµÑ€ĞµĞ·:</div>
                <div style="font-size:36px; font-weight:900; color:var(--accent);">${h}Ğ³Ğ¾Ğ´ ${m}Ñ…Ğ²</div>
                <div style="color:#aaa; margin:15px 0; font-size:13px;">Ğ’Ğ°ÑˆĞ° ÑĞµÑ€Ñ–Ñ: ${streak} Ğ´Ğ½Ñ–Ğ² ğŸ”¥</div>
                <div class="streak-dots">
                    ${DAILY_BONUSES.map((b, i) => `
                        <div class="streak-dot ${i < streak ? 'done' : ''}" title="${b}â‚´">
                            ${i < streak ? 'âœ“' : i+1}
                        </div>
                    `).join('')}
                </div>
                <button class="btn-outline" onclick="closeModal('daily-bonus-modal')" style="margin-top:20px;">Ğ—Ğ°ĞºÑ€Ğ¸Ñ‚Ğ¸</button>
            `;
        }
        openModal('daily-bonus-modal');
    }

    function claimDailyBonus(amount) {
        const streak = (userData.dailyStreak || 0) + 1;
        const newStreak = streak >= 7 ? 0 : streak; // Ğ¡ĞºĞ¸Ğ´Ğ°Ñ”Ğ¼Ğ¾ Ğ¿Ñ–ÑĞ»Ñ 7 Ğ´Ğ½Ñ–Ğ²
        
        db.ref('users/' + currentUser).update({
            balance: userData.balance + amount,
            lastDailyBonus: Date.now(),
            dailyStreak: newStreak
        });
        
        playSound('win');
        notify(`ğŸ Ğ©Ğ¾Ğ´ĞµĞ½Ğ½Ğ¸Ğ¹ Ğ±Ğ¾Ğ½ÑƒÑ: +${amount} â‚´`, 'success');
        addToHistory(`Daily Bonus: +${amount}`);
        closeModal('daily-bonus-modal');
        document.getElementById('dailyBonusBanner').classList.add('hidden');
    }

    // ============================================
    // TELEGRAM Ğ”Ğ•ĞŸĞĞ—Ğ˜Ğ¢
    // ============================================
    function selectDepAmount(amount, el) {
        selectedDepAmount = amount;
        document.querySelectorAll('.amount-btn').forEach(b => b.classList.remove('selected'));
        el.classList.add('selected');
        document.getElementById('customAmountBox').classList.add('hidden');
    }

    function selectCustomAmount() {
        document.querySelectorAll('.amount-btn').forEach(b => b.classList.remove('selected'));
        document.getElementById('customAmtBtn').classList.add('selected');
        document.getElementById('customAmountBox').classList.remove('hidden');
        selectedDepAmount = 0;
    }

    function openTelegramBot() {
        const customInput = document.getElementById('customDepAmount');
        let amount = selectedDepAmount;
        if(amount === 0 && customInput.value) amount = parseInt(customInput.value);
        
        if(!amount || amount < 50) {
            notify("ĞĞ±ĞµÑ€Ñ–Ñ‚ÑŒ ÑÑƒĞ¼Ñƒ Ğ¿Ğ¾Ğ¿Ğ¾Ğ²Ğ½ĞµĞ½Ğ½Ñ (Ğ¼Ñ–Ğ½. 50â‚´)", "error");
            return;
        }

        const userId = userData.id;
        const userName = currentUser;
        
        // Deep link Ğ· Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°Ğ¼Ğ¸ Ğ´Ğ»Ñ Ğ±Ğ¾Ñ‚Ğ°
        // Ğ‘Ğ¾Ñ‚ Ğ¾Ñ‚Ñ€Ğ¸Ğ¼Ğ°Ñ”: /start dep_USERID_AMOUNT
        const startParam = `dep_${userId}_${amount}`;
        const tgUrl = `https://t.me/${TG_BOT_USERNAME}?start=${startParam}`;
        
        // Ğ’Ñ–Ğ´ĞºÑ€Ğ¸Ğ²Ğ°Ñ”Ğ¼Ğ¾ Ğ±Ğ¾Ñ‚
        window.open(tgUrl, '_blank');
        
        notify(`Ğ’Ñ–Ğ´ĞºÑ€Ğ¸Ğ²Ğ°Ñ”Ñ‚ÑŒÑÑ Telegram Ğ±Ğ¾Ñ‚. Ğ’Ğ°Ñˆ ID: ${userId}`, 'info');
        notify(`Ğ¡ÑƒĞ¼Ğ°: ${amount} â‚´ â€” Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ½Ğ° Ğ±Ğ¾Ñ‚Ñƒ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğ¾`, 'success');
        
        // Ğ¤Ñ–ĞºÑÑƒÑ”Ğ¼Ğ¾ Ğ·Ğ°Ğ¿Ğ¸Ñ‚ Ğ´ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ñƒ Ğ² Ğ±Ğ°Ğ·Ñ– (Ğ´Ğ»Ñ Ğ°Ğ´Ğ¼Ñ–Ğ½Ğ°)
        db.ref(`deposit_requests/${userId}_${Date.now()}`).set({
            user: userName,
            userId: userId,
            amount: amount,
            status: 'pending',
            method: 'telegram',
            time: Date.now()
        });
    }

    // ============================================
    // Ğ’Ğ˜Ğ’Ğ†Ğ” ĞšĞĞ¨Ğ¢Ğ†Ğ’
    // ============================================
    function selectWithdrawMethod(method, el) {
        selectedWithdrawMethod = method;
        document.querySelectorAll('.wm-btn').forEach(b => b.classList.remove('selected'));
        el.classList.add('selected');
        
        const cardInput = document.getElementById('withdrawCard');
        if(method === 'usdt') {
            cardInput.placeholder = 'USDT TRC20 Ğ°Ğ´Ñ€ĞµÑĞ°';
        } else if(method === 'privat') {
            cardInput.placeholder = 'ĞĞ¾Ğ¼ĞµÑ€ ĞºĞ°Ñ€Ñ‚ĞºĞ¸ PrivatBank';
        } else {
            cardInput.placeholder = 'ĞĞ¾Ğ¼ĞµÑ€ ĞºĞ°Ñ€Ñ‚ĞºĞ¸ Monobank';
        }
    }

    function submitWithdraw() {
        const card = document.getElementById('withdrawCard').value.trim();
        const amount = parseInt(document.getElementById('withdrawAmount').value);
        
        if(!card) return notify("Ğ’Ğ²ĞµĞ´Ñ–Ñ‚ÑŒ Ñ€ĞµĞºĞ²Ñ–Ğ·Ğ¸Ñ‚Ğ¸ Ğ´Ğ»Ñ Ğ²Ğ¸Ğ²Ğ¾Ğ´Ñƒ", "error");
        if(!amount || amount < 200) return notify("ĞœÑ–Ğ½Ñ–Ğ¼Ğ°Ğ»ÑŒĞ½Ğ° ÑÑƒĞ¼Ğ° Ğ²Ğ¸Ğ²Ğ¾Ğ´Ñƒ: 200â‚´", "error");
        if(userData.balance < amount) return notify("ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ½ÑŒĞ¾ ĞºĞ¾ÑˆÑ‚Ñ–Ğ²", "error");
        
        // ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ĞºĞ° Ğ½Ğ° pending Ğ·Ğ°ÑĞ²ĞºĞ¸
        if(userData.pendingWithdraw) {
            return notify("Ğ£ Ğ²Ğ°Ñ Ğ²Ğ¶Ğµ Ñ” Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ° Ğ·Ğ°ÑĞ²ĞºĞ° Ğ½Ğ° Ğ²Ğ¸Ğ²Ñ–Ğ´. Ğ”Ğ¾Ñ‡ĞµĞºĞ°Ğ¹Ñ‚ĞµÑÑŒ Ñ—Ñ— Ğ¾Ğ±Ñ€Ğ¾Ğ±ĞºĞ¸.", "error");
        }
        
        const requestId = `${currentUser}_${Date.now()}`;
        
        // Ğ—Ğ°Ğ¼Ğ¾Ñ€Ğ¾Ğ·Ğ¸Ñ‚Ğ¸ Ğ³Ñ€Ğ¾ÑˆÑ–
        db.ref('users/' + currentUser).update({
            balance: userData.balance - amount,
            pendingWithdraw: true
        });
        
        // Ğ—Ğ±ĞµÑ€ĞµĞ³Ñ‚Ğ¸ Ğ·Ğ°ÑĞ²ĞºÑƒ
        db.ref('withdraw_requests/' + requestId).set({
            user: currentUser,
            userId: userData.id,
            amount: amount,
            method: selectedWithdrawMethod,
            card: card,
            status: 'pending',
            time: Date.now()
        });
        
        db.ref('users/' + currentUser + '/withdraws/' + requestId).set({
            amount: amount,
            method: selectedWithdrawMethod,
            status: 'pending',
            time: Date.now()
        });
        
        addToHistory(`Ğ—Ğ°ÑĞ²ĞºĞ° Ğ½Ğ° Ğ²Ğ¸Ğ²Ñ–Ğ´: -${amount} â‚´ (Ğ¾Ğ±Ñ€Ğ¾Ğ±Ğ»ÑÑ”Ñ‚ÑŒÑÑ)`);
        notify(`âœ… Ğ—Ğ°ÑĞ²ĞºÑƒ Ğ½Ğ° Ğ²Ğ¸Ğ²Ñ–Ğ´ ${amount}â‚´ Ğ¿Ñ€Ğ¸Ğ¹Ğ½ÑÑ‚Ğ¾! ĞĞ±Ñ€Ğ¾Ğ±ĞºĞ° 1-24 Ğ³Ğ¾Ğ´.`, 'success');
        
        document.getElementById('withdrawCard').value = '';
        document.getElementById('withdrawAmount').value = '';
        loadMyWithdraws();
    }

    function loadMyWithdraws() {
        const list = document.getElementById('myWithdrawsList');
        if(!list) return;
        
        db.ref('users/' + currentUser + '/withdraws').limitToLast(5).once('value', snap => {
            const data = snap.val();
            if(!data) { list.innerHTML = '<div style="color:#777; font-size:13px; padding:10px 0;">ĞĞµĞ¼Ğ°Ñ” Ğ·Ğ°ÑĞ²Ğ¾Ğº</div>'; return; }
            
            list.innerHTML = '';
            Object.entries(data).reverse().forEach(([id, w]) => {
                const date = new Date(w.time).toLocaleDateString('uk-UA');
                const statusClass = w.status === 'done' ? 'pw-done' : 'pw-pending';
                const statusText = w.status === 'done' ? 'âœ… Ğ’Ğ¸ĞºĞ¾Ğ½Ğ°Ğ½Ğ¾' : 'â³ ĞĞ±Ñ€Ğ¾Ğ±Ğ»ÑÑ”Ñ‚ÑŒÑÑ';
                list.innerHTML += `
                    <div class="pending-withdraw">
                        <div>
                            <div style="font-weight:bold;">${w.amount} â‚´</div>
                            <div style="color:#777; font-size:11px;">${w.method} â€¢ ${date}</div>
                        </div>
                        <span class="pw-status ${statusClass}">${statusText}</span>
                    </div>
                `;
            });
        });
    }

    // ============================================
    // Ğ†Ğ“Ğ Ğ˜
    // ============================================

    // --- Ğ¡Ğ»Ğ¾Ñ‚Ğ¸ ---
    function spinSlots() { 
        const b = validateBet(document.getElementById('betAmountSlots').value); 
        if(!b) return; 
        db.ref('users/'+currentUser).update({balance: userData.balance - b}); 
        playSound('click'); 
        const reels = [document.getElementById('r1'), document.getElementById('r2'), document.getElementById('r3')]; 
        const sym = ["ğŸ’", "ğŸ‹", "7", "ğŸ’", "ğŸ””"]; 
        let count = 0; 
        let int = setInterval(() => { 
            reels.forEach(r => r.textContent = sym[Math.floor(Math.random()*sym.length)]); 
            count++; 
            if(count > 15) { clearInterval(int); finishSlots(b); } 
        }, 80); 
    }
    
    function finishSlots(bet) { 
        const r = Math.random(); 
        let win = 0; let res = ["ğŸ’","ğŸ‹","ğŸ””"]; 
        if(r < 0.03) { res = ["7","7","7"]; win = bet*50; } 
        else if(r < 0.08) { res = ["ğŸ’","ğŸ’","ğŸ’"]; win = bet*15; } 
        else if(r < 0.20) { res = ["ğŸ’","ğŸ’","ğŸ’"]; win = bet*3; } 
        else if(r < 0.35) { res = ["ğŸ””","ğŸ””","ğŸ‹"]; win = bet*1.5; }
        
        document.getElementById('r1').textContent = res[0]; 
        document.getElementById('r2').textContent = res[1]; 
        document.getElementById('r3').textContent = res[2]; 
        
        if(win > 0) { 
            db.ref('users/'+currentUser+'/balance').set(firebase.database.ServerValue.increment(win)); 
            playSound('win'); 
            notify(`ğŸ° WIN: ${win} â‚´`, "success"); 
            addToHistory(`Slots: +${win}`); 
        } 
    }

    // --- Ğ ÑƒĞ»ĞµÑ‚ĞºĞ° ---
    function selectRouletteBet(c, e){ 
        document.querySelectorAll('.bet-btn').forEach(b => b.classList.remove('selected')); 
        e.classList.add('selected'); 
        currentRouletteBet = c; 
        playSound('click'); 
    }
    
    function spinRoulette(){ 
        const b = validateBet(document.getElementById('betAmountRoulette').value); 
        if(!b || !currentRouletteBet) { notify("ĞĞ±ĞµÑ€Ñ–Ñ‚ÑŒ ĞºĞ¾Ğ»Ñ–Ñ€ Ñ– ÑÑ‚Ğ°Ğ²ĞºÑƒ"); return; }
        db.ref('users/'+currentUser).update({balance: userData.balance - b}); 
        playSound('click'); 
        const wheel = document.getElementById('wheel'); 
        const randDeg = Math.random() * 360; 
        wheel.style.transform = `rotate(${1800 + (360 - randDeg)}deg)`; 
        setTimeout(() => { 
            let win = 0; let c = 'black'; 
            if(randDeg <= 18) c = 'green'; 
            else if(randDeg <= 189) c = 'red'; 
            if(c === currentRouletteBet){ 
                win = (c === 'green') ? b*14 : b*2; 
                db.ref('users/'+currentUser+'/balance').set(userData.balance + win); 
                notify(`ğŸ¡ Ğ’Ğ¸Ğ³Ñ€Ğ°Ñˆ: ${win} â‚´`, "success"); 
                playSound('win'); 
                addToHistory(`Roulette: +${win}`); 
            } else { notify("ĞŸÑ€Ğ¾Ğ³Ñ€Ğ°Ñˆ ğŸ˜”", "error"); } 
        }, 4000); 
    }

    // --- Ğ¡ÑƒĞ½Ğ´ÑƒĞºĞ¸ ---
    function startChests(){ 
        const b = validateBet(document.getElementById('betAmountChests').value); 
        if(!b) return; 
        db.ref('users/'+currentUser).update({balance: userData.balance - b}); 
        const g = document.getElementById('chestsGrid'); 
        g.innerHTML = ""; 
        for(let i=0; i<3; i++){ 
            const d = document.createElement('div'); 
            d.className = "chest-item"; 
            d.textContent = "ğŸ“¦"; 
            d.onclick = () => { 
                const w = Math.random() > 0.6 ? b*2.5 : 0; 
                d.textContent = w ? "ğŸ’°" : "ğŸ’¨"; 
                if(w){ db.ref('users/'+currentUser+'/balance').set(firebase.database.ServerValue.increment(w)); playSound('win'); notify(`+${w} â‚´`, "success"); addToHistory(`Chests: +${w}`); } 
                else { playSound('click'); }
                Array.from(g.children).forEach(c => c.onclick = null);
            }; 
            g.appendChild(d); 
        }
    }

    // --- ĞšÑ€Ğ°Ñˆ ---
    let crashInt; let isCrashPlaying = false;
    function startCrash() { 
        const b = validateBet(document.getElementById('betAmountCrash').value); 
        if(!b) return; 
        db.ref('users/'+currentUser).update({balance: userData.balance - b}); 
        document.getElementById('crashBtn').classList.add('hidden'); 
        document.getElementById('crashCashoutBtn').classList.remove('hidden'); 
        let m = 1.00; 
        let crashPoint = 1 + (Math.random() * 8);
        isCrashPlaying = true; 
        crashInt = setInterval(() => { 
            m += 0.03 + (m * 0.002); 
            document.getElementById('crashDisplay').textContent = m.toFixed(2) + 'x'; 
            if(m >= crashPoint){ 
                clearInterval(crashInt); 
                isCrashPlaying = false; 
                notify("ğŸ’¥ ĞšĞ ĞĞ¨ Ğ½Ğ° " + m.toFixed(2) + "x!", "error"); 
                document.getElementById('crashDisplay').style.color = "red";
                setTimeout(()=> { document.getElementById('crashDisplay').style.color = "white"; document.getElementById('crashDisplay').textContent = "1.00x"; }, 2000);
                document.getElementById('crashBtn').classList.remove('hidden'); 
                document.getElementById('crashCashoutBtn').classList.add('hidden'); 
            } 
        }, 100); 
    }
    
    function cashoutCrash() { 
        if(!isCrashPlaying) return; 
        clearInterval(crashInt); 
        isCrashPlaying = false; 
        const b = parseInt(document.getElementById('betAmountCrash').value); 
        const mult = parseFloat(document.getElementById('crashDisplay').textContent);
        const w = Math.floor(b * mult); 
        db.ref('users/'+currentUser+'/balance').set(userData.balance + w); 
        notify(`ğŸš€ Ğ’Ğ¸Ğ²ĞµĞ´ĞµĞ½Ğ¾: +${w} â‚´`, "success"); 
        addToHistory(`Crash: +${w} (x${mult})`); 
        document.getElementById('crashBtn').classList.remove('hidden'); 
        document.getElementById('crashCashoutBtn').classList.add('hidden'); 
    }

    // ============================================
    // Ğ’Ğ†Ğ”Ğ•ĞĞŸĞĞšĞ•Ğ 
    // ============================================
    const SUITS = ['â™ ', 'â™¥', 'â™¦', 'â™£'];
    const RANKS = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
    const RANK_VALUES = {2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:11,Q:12,K:13,A:14};

    let pokerHand = [];
    let pokerSelectedCards = [];
    let pokerBet = 0;
    let pokerPhase = 'deal'; // 'deal' Ğ°Ğ±Ğ¾ 'draw'

    function createDeck() {
        const deck = [];
        for(const suit of SUITS) for(const rank of RANKS) deck.push({rank, suit});
        return deck.sort(() => Math.random() - 0.5);
    }

    function cardHTML(card, index, selectable=false) {
        const isRed = card.suit === 'â™¥' || card.suit === 'â™¦';
        const colorClass = isRed ? 'red-card' : '';
        const selectedClass = pokerSelectedCards.includes(index) ? 'selected' : '';
        const onclick = selectable ? `onclick="togglePokerCard(${index})"` : '';
        return `<div class="card ${colorClass} ${selectedClass}" ${onclick} data-idx="${index}">
            <span style="font-size:11px;">${card.rank}</span>
            <span style="font-size:16px;">${card.suit}</span>
        </div>`;
    }

    function togglePokerCard(idx) {
        if(pokerPhase !== 'draw') return;
        const pos = pokerSelectedCards.indexOf(idx);
        if(pos === -1) pokerSelectedCards.push(idx);
        else pokerSelectedCards.splice(pos, 1);
        renderPokerHand(true);
    }

    function renderPokerHand(selectable=false) {
        const container = document.getElementById('pokerCards');
        container.innerHTML = pokerHand.map((c, i) => cardHTML(c, i, selectable)).join('');
    }

    function dealPoker() {
        const b = validateBet(document.getElementById('betAmountPoker').value);
        if(!b) return;
        pokerBet = b;
        db.ref('users/'+currentUser).update({balance: userData.balance - b});
        
        const deck = createDeck();
        pokerHand = deck.slice(0, 5);
        pokerSelectedCards = [];
        pokerPhase = 'draw';
        
        renderPokerHand(true);
        document.getElementById('pokerInfo').textContent = 'ğŸ”„ ĞĞ±ĞµÑ€Ñ–Ñ‚ÑŒ ĞºĞ°Ñ€Ñ‚Ğ¸ Ğ´Ğ»Ñ Ğ—ĞĞœĞ†ĞĞ˜ (Ğ°Ğ±Ğ¾ Ğ½Ğµ Ğ¾Ğ±Ğ¸Ñ€Ğ°Ğ¹Ñ‚Ğµ)';
        document.getElementById('pokerDealBtn').classList.add('hidden');
        document.getElementById('pokerDrawBtn').classList.remove('hidden');
        playSound('click');
    }

    function drawPoker() {
        // Ğ—Ğ°Ğ¼Ñ–Ğ½ÑÑ”Ğ¼Ğ¾ Ğ²Ğ¸Ğ´Ñ–Ğ»ĞµĞ½Ñ– ĞºĞ°Ñ€Ñ‚Ğ¸
        const deck = createDeck().filter(c => !pokerHand.find(h => h.rank===c.rank && h.suit===c.suit));
        let di = 0;
        pokerSelectedCards.forEach(idx => { pokerHand[idx] = deck[di++]; });
        pokerSelectedCards = [];
        pokerPhase = 'deal';
        
        renderPokerHand(false);
        
        const result = evaluatePokerHand(pokerHand);
        const win = Math.floor(pokerBet * result.multiplier);
        
        if(win > 0) {
            db.ref('users/'+currentUser+'/balance').set(firebase.database.ServerValue.increment(win));
            playSound('win');
            notify(`ğŸƒ ${result.name}! +${win} â‚´`, 'success');
            addToHistory(`Poker ${result.name}: +${win}`);
            document.getElementById('pokerInfo').innerHTML = `<span style="color:var(--green); font-weight:bold;">ğŸ† ${result.name}! Ğ’Ğ¸Ğ³Ñ€Ğ°Ñˆ: +${win} â‚´</span>`;
        } else {
            notify('ğŸ˜” ĞÑ–Ñ‡Ğ¾Ğ³Ğ¾ Ğ½ĞµĞ¼Ğ°Ñ”', 'error');
            document.getElementById('pokerInfo').textContent = result.name + ' â€” Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ñˆ';
        }
        
        document.getElementById('pokerDealBtn').classList.remove('hidden');
        document.getElementById('pokerDrawBtn').classList.add('hidden');
    }

    function evaluatePokerHand(hand) {
        const ranks = hand.map(c => RANK_VALUES[c.rank]).sort((a,b) => a-b);
        const suits = hand.map(c => c.suit);
        const rankStr = hand.map(c => c.rank);
        
        const isFlush = suits.every(s => s === suits[0]);
        const isStraight = ranks[4]-ranks[0]===4 && new Set(ranks).size===5 || 
                          (ranks.join(',') === '2,3,4,5,14'); // Wheel
        
        const rankCount = {};
        rankStr.forEach(r => rankCount[r] = (rankCount[r]||0)+1);
        const counts = Object.values(rankCount).sort((a,b) => b-a);
        
        if(isFlush && isStraight && ranks[0]===10) return {name:'Ğ Ğ¾ÑĞ»-Ñ„Ğ»ĞµÑˆ ğŸ‘‘', multiplier:800};
        if(isFlush && isStraight) return {name:'Ğ¡Ñ‚Ñ€ĞµĞ¹Ñ‚-Ñ„Ğ»ĞµÑˆ', multiplier:50};
        if(counts[0]===4) return {name:'ĞšĞ°Ñ€Ğµ', multiplier:25};
        if(counts[0]===3 && counts[1]===2) return {name:'Ğ¤ÑƒĞ»-Ñ…Ğ°ÑƒÑ', multiplier:9};
        if(isFlush) return {name:'Ğ¤Ğ»ĞµÑˆ', multiplier:6};
        if(isStraight) return {name:'Ğ¡Ñ‚Ñ€ĞµĞ¹Ñ‚', multiplier:4};
        if(counts[0]===3) return {name:'Ğ¢Ñ€Ğ¸ Ğ¾Ğ´Ğ½Ğ°ĞºĞ¾Ğ²Ğ¸Ñ…', multiplier:3};
        if(counts[0]===2 && counts[1]===2) return {name:'Ğ”Ğ²Ñ– Ğ¿Ğ°Ñ€Ğ¸', multiplier:2};
        
        // ĞŸĞ°Ñ€Ğ° JJ+
        if(counts[0]===2) {
            const pairRank = Object.keys(rankCount).find(r => rankCount[r]===2);
            if(['J','Q','K','A'].includes(pairRank)) return {name:`ĞŸĞ°Ñ€Ğ° ${pairRank}`, multiplier:1};
        }
        
        return {name:'ĞÑ–Ñ‡Ğ¾Ğ³Ğ¾', multiplier:0};
    }

    function togglePaytable() {
        const pt = document.getElementById('pokerPaytable');
        pt.style.display = pt.style.display === 'none' ? 'block' : 'none';
    }

    // --- Ğ¡Ğ°Ğ¿ĞµÑ€ ---
    let minesGrid = []; let isMinesPlaying = false; let currentMinesProfit = 0; let movesMade = 0;
    function startMines() { 
        const bet = validateBet(document.getElementById('betAmountMines').value); 
        if(!bet) return; 
        db.ref('users/'+currentUser).update({balance: userData.balance - bet}); 
        isMinesPlaying = true; currentMinesProfit = bet; movesMade = 0; 
        document.getElementById('minesBtn').classList.add('hidden'); 
        document.getElementById('minesCashoutBtn').classList.remove('hidden'); 
        document.getElementById('minesCashoutBtn').textContent = `Ğ—ĞĞ‘Ğ ĞĞ¢Ğ˜ (0)`;
        minesGrid = new Array(25).fill(0); 
        let placed = 0; 
        while(placed < 3) { let idx = Math.floor(Math.random()*25); if(minesGrid[idx]===0){ minesGrid[idx]=1; placed++; } } 
        const container = document.getElementById('minesGrid'); 
        container.innerHTML = ''; 
        for(let i=0; i<25; i++){ 
            const cell = document.createElement('div'); 
            cell.className='mine-cell'; cell.textContent="â“"; 
            cell.onclick = () => clickMineCell(i, cell); 
            container.appendChild(cell); 
        } 
        playSound('click'); 
    }
    
    function clickMineCell(idx, el) { 
        if(!isMinesPlaying || el.classList.contains('revealed')) return; 
        el.classList.add('revealed'); 
        if(minesGrid[idx]===1){ 
            el.textContent="ğŸ’£"; playSound('click'); notify("ğŸ’£ Ğ‘ÑƒĞ¼! ĞŸÑ€Ğ¾Ğ³Ñ€Ğ°Ñˆ", "error"); 
            isMinesPlaying=false;
            document.getElementById('minesBtn').classList.remove('hidden'); 
            document.getElementById('minesCashoutBtn').classList.add('hidden'); 
        } else { 
            el.textContent="ğŸ’"; playSound('click'); movesMade++; 
            currentMinesProfit=Math.floor(currentMinesProfit*1.25); 
            document.getElementById('minesCashoutBtn').textContent=`Ğ—ĞĞ‘Ğ ĞĞ¢Ğ˜ ${currentMinesProfit} â‚´`; 
        } 
    }
    
    function cashoutMines() { 
        if(!isMinesPlaying || movesMade===0) return; 
        db.ref('users/'+currentUser+'/balance').set(userData.balance+currentMinesProfit); 
        playSound('win'); notify(`ğŸ’ Ğ’Ğ¸Ğ²ĞµĞ´ĞµĞ½Ğ¾: +${currentMinesProfit} â‚´`, "success"); 
        addToHistory(`Mines: +${currentMinesProfit}`); 
        isMinesPlaying=false;
        document.getElementById('minesBtn').classList.remove('hidden'); 
        document.getElementById('minesCashoutBtn').classList.add('hidden'); 
    }

    // --- ĞŸĞ»Ñ–Ğ½ĞºĞ¾ ---
    function dropPlinko() { 
        const bet = validateBet(document.getElementById('betAmountPlinko').value); 
        if(!bet) return; 
        db.ref('users/'+currentUser).update({balance: userData.balance - bet}); 
        playSound('click'); 
        const ball = document.getElementById('plinkoBall'); 
        ball.style.display='block'; 
        const rand = Math.random(); 
        let bucketIndex = 3; 
        if(rand < 0.10) bucketIndex=0; 
        else if(rand < 0.30) bucketIndex=1; 
        else if(rand < 0.60) bucketIndex=2; 
        else bucketIndex=3; 
        if(Math.random()>0.5) bucketIndex=6-bucketIndex; 
        const targetLeft=(bucketIndex*14)+7; 
        ball.animate([{top:'0',left:'50%'},{top:'100%',left:targetLeft+'%'}],{duration:1500,fill:'forwards',easing:'linear'}); 
        setTimeout(() => { 
            const multipliers=[5,2,0.5,0.2,0.5,2,5]; 
            const mult=multipliers[bucketIndex]; 
            const win=Math.floor(bet*mult); 
            if(mult>=1){ db.ref('users/'+currentUser+'/balance').set(userData.balance+win); playSound('win'); notify(`ğŸ”» +${win} â‚´`, "success"); addToHistory(`Plinko: +${win}`); } 
            else { addToHistory(`Plinko: -${bet-win}`); } 
            ball.style.display='none'; 
        }, 1500); 
    }

    // ============================================
    // Ğ Ğ•Ğ™Ğ¢Ğ˜ĞĞ“
    // ============================================
    function renderTop(d) {
        if(!d) return;
        let arr = [];
        for(let k in d) arr.push({n:k, ...d[k]});
        arr.sort((a,b) => b.balance - a.balance);
        let h = "";
        arr.forEach((u,i) => {
            const av = u.avatar && u.avatar.length > 20 ? `<img src="${u.avatar}" style="width:24px;height:24px;border-radius:50%;vertical-align:middle;">` : 'ğŸ‘¤';
            const medal = i===0?'ğŸ¥‡':i===1?'ğŸ¥ˆ':i===2?'ğŸ¥‰':`${i+1}`;
            h += `<tr onclick="openUserProfile('${u.n}')" style="cursor:pointer;">
                    <td style="font-size:16px;">${medal}</td>
                    <td>${av} <b>${u.n}</b></td>
                    <td class="rank">${formatNumber(u.balance)} â‚´</td>
                  </tr>`;
        });
        document.getElementById('topTable').innerHTML = h;
    }

    // ============================================
    // ĞĞ’Ğ¢ĞĞ Ğ˜Ğ—ĞĞ¦Ğ†Ğ¯
    // ============================================
    function authLogin() { 
        const n = document.getElementById('loginName').value.trim(); 
        const p = document.getElementById('loginPass').value; 
        if(!n || !p) return notify("Ğ’Ğ²ĞµĞ´Ñ–Ñ‚ÑŒ Ğ´Ğ°Ğ½Ñ–", "error"); 
        db.ref('users/'+n).once('value', s => { 
            if(s.exists() && s.val().pass == p) { 
                currentUser=n; localStorage.setItem("royal_online_user",n); startDataSync(); 
            } else { notify("ĞĞµĞ²Ñ–Ñ€Ğ½Ğ¸Ğ¹ Ğ»Ğ¾Ğ³Ñ–Ğ½ Ğ°Ğ±Ğ¾ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ", "error"); } 
        }); 
    }
    
    function authRegister() { 
        const e=document.getElementById('regEmail').value.trim(); 
        const n=document.getElementById('regName').value.trim(); 
        const p=document.getElementById('regPass').value; 
        if(!e||!n||!p) return notify("Ğ—Ğ°Ğ¿Ğ¾Ğ²Ğ½Ñ–Ñ‚ÑŒ Ğ²ÑÑ– Ğ¿Ğ¾Ğ»Ñ","error"); 
        if(p.length<8||n.includes(' ')||n.includes('.')) return notify("ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ Ğ¼Ñ–Ğ½ 8 ÑĞ¸Ğ¼Ğ². ĞÑ–Ğº Ğ±ĞµĞ· Ğ¿Ñ€Ğ¾Ğ±Ñ–Ğ»Ñ–Ğ²!","error"); 
        db.ref('users/'+n).once('value', s => { 
            if(s.exists()){ notify("Ğ¦ĞµĞ¹ Ğ½Ñ–ĞºĞ½ĞµĞ¹Ğ¼ Ğ²Ğ¶Ğµ Ğ·Ğ°Ğ¹Ğ½ÑÑ‚Ğ¸Ğ¹","error"); } 
            else { 
                const id=Math.floor(Math.random()*900000)+100000; 
                db.ref('users/'+n).set({pass:p,email:e,balance:1000,id:id,tag:"ĞĞ¾Ğ²Ğ°Ñ‡Ğ¾Ğº",dailyStreak:0}).then(() => { 
                    notify("ĞĞºĞ°ÑƒĞ½Ñ‚ ÑÑ‚Ğ²Ğ¾Ñ€ĞµĞ½Ğ¾! Ğ¢ĞµĞ¿ĞµÑ€ ÑƒĞ²Ñ–Ğ¹Ğ´Ñ–Ñ‚ÑŒ.","success"); toggleAuthMode(false); 
                }); 
            } 
        }); 
    }
    
    function toggleAuthMode(reg) { 
        document.getElementById('loginForm').classList.toggle('hidden', reg); 
        document.getElementById('regForm').classList.toggle('hidden', !reg); 
    }
    
    function logout(){ localStorage.removeItem("royal_online_user"); location.reload(); }

    // ============================================
    // ĞĞ”ĞœĞ†Ğ-ĞŸĞĞĞ•Ğ›Ğ¬
    // ============================================
    function loadUserList() { 
        const d=document.getElementById('userList'); 
        d.innerHTML="Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ..."; 
        db.ref('users').once('value', s => { 
            d.innerHTML=""; 
            const users=s.val(); 
            if(!users){ d.innerHTML="ĞĞµĞ¼Ğ°Ñ” Ğ³Ñ€Ğ°Ğ²Ñ†Ñ–Ğ²"; return; } 
            for(let n in users){ 
                d.innerHTML+=`<div class="admin-user-card" onclick="openAdminManage('${n}')">
                    <div><b>${n}</b><div style="color:#555;font-size:11px;">ID: ${users[n].id||'?'}</div></div>
                    <span style="color:var(--green)">${formatNumber(users[n].balance)} â‚´</span></div>`; 
            } 
        }); 
    }

    function loadWithdrawRequests() {
        const box = document.getElementById('withdrawRequestsList');
        const content = document.getElementById('withdrawRequestsContent');
        box.classList.remove('hidden');
        content.innerHTML = 'Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ...';
        
        db.ref('withdraw_requests').orderByChild('status').equalTo('pending').once('value', snap => {
            const data = snap.val();
            if(!data) { content.innerHTML = '<div style="color:#777; padding:10px;">ĞĞµĞ¼Ğ° Ğ·Ğ°ÑĞ²Ğ¾Ğº</div>'; return; }
            
            content.innerHTML = '';
            Object.entries(data).forEach(([id, req]) => {
                content.innerHTML += `
                    <div class="request-card">
                        <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                            <b>${req.user}</b><span style="color:var(--green);font-weight:bold;">${req.amount} â‚´</span>
                        </div>
                        <div style="color:#777;font-size:12px;">${req.method} â€¢ ${req.card}</div>
                        <div style="color:#555;font-size:11px;">${new Date(req.time).toLocaleString('uk-UA')}</div>
                        <div style="display:flex;gap:8px;margin-top:10px;">
                            <button class="btn-green" style="padding:8px;font-size:12px;" onclick="approveWithdraw('${id}','${req.user}')">âœ… Ğ¡Ñ…Ğ²Ğ°Ğ»Ğ¸Ñ‚Ğ¸</button>
                            <button class="btn-red" style="padding:8px;font-size:12px;" onclick="rejectWithdraw('${id}','${req.user}',${req.amount})">âŒ Ğ’Ñ–Ğ´Ñ…Ğ¸Ğ»Ğ¸Ñ‚Ğ¸</button>
                        </div>
                    </div>
                `;
            });
        });
    }

    function approveWithdraw(id, user) {
        db.ref('withdraw_requests/'+id).update({status:'done'});
        db.ref('users/'+user+'/withdraws/'+id).update({status:'done'});
        db.ref('users/'+user).update({pendingWithdraw: false});
        notify('Ğ’Ğ¸Ğ²Ñ–Ğ´ ÑÑ…Ğ²Ğ°Ğ»ĞµĞ½Ğ¾', 'success');
        loadWithdrawRequests();
    }

    function rejectWithdraw(id, user, amount) {
        // ĞŸĞ¾Ğ²ĞµÑ€Ğ½ÑƒÑ‚Ğ¸ ĞºĞ¾ÑˆÑ‚Ğ¸
        db.ref('users/'+user+'/balance').set(firebase.database.ServerValue.increment(amount));
        db.ref('withdraw_requests/'+id).update({status:'rejected'});
        db.ref('users/'+user+'/withdraws/'+id).update({status:'rejected'});
        db.ref('users/'+user).update({pendingWithdraw: false});
        notify('Ğ’Ğ¸Ğ²Ñ–Ğ´ Ğ²Ñ–Ğ´Ñ…Ğ¸Ğ»ĞµĞ½Ğ¾, ĞºĞ¾ÑˆÑ‚Ğ¸ Ğ¿Ğ¾Ğ²ĞµÑ€Ğ½ÑƒÑ‚Ğ¾', 'success');
        loadWithdrawRequests();
    }
    
    let admSelectedUser = null;
    function openAdminManage(n) { 
        admSelectedUser=n; 
        document.getElementById('admin-user-manage').classList.remove('hidden'); 
        document.getElementById('admManageName').textContent=n; 
    }
    function admGiveMoney() { 
        const a=parseInt(document.getElementById('admAmount').value); 
        if(!a) return; 
        db.ref('users/'+admSelectedUser+'/balance').set(firebase.database.ServerValue.increment(a)); 
        notify("Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ Ğ·Ğ¼Ñ–Ğ½ĞµĞ½Ğ¾","success"); 
    }
    function admSetTag() { 
        const t=document.getElementById('admTag').value; 
        if(t){ db.ref('users/'+admSelectedUser).update({tag:t}); notify("Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ·Ğ¼Ñ–Ğ½ĞµĞ½Ğ¾"); } 
    }
    function admBanUser() { 
        if(confirm("Ğ—Ğ°Ğ±Ğ»Ğ¾ĞºÑƒĞ²Ğ°Ñ‚Ğ¸ Ğ³Ñ€Ğ°Ğ²Ñ†Ñ?")){ db.ref('users/'+admSelectedUser).update({banned:true}); notify("Ğ—ĞĞ‘Ğ›ĞĞšĞĞ’ĞĞĞ"); } 
    }
    function admDeleteUser() { 
        if(confirm("Ğ’Ğ˜Ğ”ĞĞ›Ğ˜Ğ¢Ğ˜ ĞĞšĞĞ£ĞĞ¢ ĞĞĞ—ĞĞ’Ğ–Ğ”Ğ˜?")){ 
            db.ref('users/'+admSelectedUser).remove().then(()=>{ notify("Ğ’Ğ¸Ğ´Ğ°Ğ»ĞµĞ½Ğ¾"); closeModal('admin-user-manage'); loadUserList(); }); 
        } 
    }
    function wipeEconomy() { 
        if(prompt("Ğ’Ğ²ĞµĞ´Ñ–Ñ‚ÑŒ WIPE:")==="WIPE"){ 
            db.ref('users').once('value', s=>{ for(let k in s.val()) db.ref('users/'+k+'/balance').set(1000); notify("Ğ¡ĞºĞ¸Ğ½ÑƒÑ‚Ğ¾","success"); }); 
        } 
    }

    // ============================================
    // Ğ†ĞĞ¨Ğ† Ğ¤Ğ£ĞĞšĞ¦Ğ†Ğ‡
    // ============================================
    function switchTab(id, el) { 
        document.querySelectorAll('.screen').forEach(s=>s.classList.add('hidden')); 
        const tab = document.getElementById('tab-'+id);
        if(tab) tab.classList.remove('hidden'); 
        if(el){ document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active')); el.classList.add('active'); } 
    }
    
    function openGame(g) { switchTab(g); }
    function openModal(id) { document.getElementById(id).classList.remove('hidden'); }
    function closeModal(id) { document.getElementById(id).classList.add('hidden'); }
    
    function sendMoney() { 
        const t=document.getElementById('transferTo').value; 
        const a=parseInt(document.getElementById('transferAmount').value); 
        if(userData.balance<a||a<=0) return notify("ĞĞµĞ²Ñ–Ñ€Ğ½Ğ° ÑÑƒĞ¼Ğ°","error"); 
        db.ref('users/'+t).once('value', s=>{ 
            if(s.exists()){ 
                db.ref('users/'+currentUser+'/balance').set(userData.balance-a); 
                db.ref('users/'+t+'/balance').set(s.val().balance+a); 
                notify("Ğ“Ñ€Ğ¾ÑˆÑ– Ğ½Ğ°Ğ´Ñ–ÑĞ»Ğ°Ğ½Ğ¾!","success"); closeModal('transfer-modal'); 
            } else { notify("ĞšĞ¾Ñ€Ğ¸ÑÑ‚ÑƒĞ²Ğ°Ñ‡Ğ° Ğ½Ğµ Ğ·Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾","error"); } 
        }); 
    }
    
    function activatePromo() { 
        const c=document.getElementById('promoInput').value.trim(); 
        db.ref('promos/'+c).once('value', s=>{ 
            if(s.exists()){ 
                db.ref('users/'+currentUser+'/balance').set(userData.balance+s.val().value); 
                notify("ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ¾Ğ²Ğ°Ğ½Ğ¾!","success"); closeModal('promo-modal'); 
            } else { notify("ĞĞµĞ²Ñ–Ñ€Ğ½Ğ¸Ğ¹ ĞºĞ¾Ğ´","error"); } 
        }); 
    }
    
    function addContact() { 
        const i=document.getElementById('addContactInput').value; 
        db.ref('users/'+i).once('value', s=>{ 
            if(s.exists()){ db.ref('users/'+currentUser+'/contacts/'+i).set({avatar:s.val().avatar||'ğŸ‘¤'}); notify("Ğ”Ğ¾Ğ´Ğ°Ğ½Ğ¾!"); loadContacts(); } 
            else { notify("ĞĞµ Ğ·Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾","error"); } 
        }); 
    }
    
    function loadContacts() { 
        const l=document.getElementById('contactsList'); 
        if(!userData.contacts){ l.innerHTML="<div style='color:#777'>Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ¾Ñ€Ğ¾Ğ¶Ğ½Ñ–Ğ¹</div>"; return; } 
        l.innerHTML=""; 
        for(let n in userData.contacts){ 
            l.innerHTML+=`<div class="contact-row"><b>${n}</b> <button class="btn-green" style="width:auto;padding:8px 15px;margin:0;" onclick="quickSend('${n}')">ğŸ’¸</button></div>`; 
        } 
    }
    
    function quickSend(n) { document.getElementById('transferTo').value=n; openModal('transfer-modal'); }
    function deleteAccount() { if(confirm("Ğ’Ğ˜Ğ”ĞĞ›Ğ˜Ğ¢Ğ˜ ĞĞšĞĞ£ĞĞ¢ ĞĞĞ—ĞĞ’Ğ–Ğ”Ğ˜?")) db.ref('users/'+currentUser).remove().then(logout); }
    function updateBio(v) { db.ref('users/'+currentUser).update({tag:v}); notify("Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ¾Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾"); }
    function handleAvatarUpload(i) { 
        if(i.files[0]){ 
            const r=new FileReader(); 
            r.onload=e=>db.ref('users/'+currentUser).update({avatar:e.target.result}); 
            r.readAsDataURL(i.files[0]); notify("Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ..."); 
        } 
    }
    function openHistoryModal() { 
        openModal('history-modal'); 
        const c=document.getElementById('historyList'); c.innerHTML="Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ...";
        db.ref('users/'+currentUser+'/history').limitToLast(20).once('value', s=>{ 
            c.innerHTML=""; 
            if(s.val()) Object.values(s.val()).reverse().forEach(i=>{ c.innerHTML+=`<div style="padding:10px;border-bottom:1px solid #333;color:#ccc;">${i.text}</div>`; }); 
            else c.innerHTML="<div style='padding:10px;color:#777;'>ĞŸĞ¾Ñ€Ğ¾Ğ¶Ğ½ÑŒĞ¾</div>"; 
        }); 
    }
    function openSupportModal() { 
        openModal('support-modal'); 
        const box=document.getElementById('supportChatBox'); box.innerHTML="";
        db.ref('support_chats/'+currentUser).limitToLast(20).on('child_added', s=>{ 
            const m=s.val(); 
            box.innerHTML+=`<div style="margin-bottom:8px;padding:8px 12px;background:${m.sender==='user'?'#005c4b':'#333'};border-radius:8px;width:fit-content;max-width:80%;margin-left:${m.sender==='user'?'auto':'0'}">${m.text}</div>`; 
            box.scrollTop=box.scrollHeight; 
        }); 
    }
    function sendSupportMsg() { 
        const t=document.getElementById('supportMsg').value; 
        if(t){ db.ref('support_chats/'+currentUser).push({text:t,sender:'user',time:Date.now()}); document.getElementById('supportMsg').value=""; } 
    }
    window.openUserProfile = function(name) { 
        if(name===currentUser) return switchTab('profile'); 
        db.ref('users/'+name).once('value', s=>{ 
            const d=s.val(); 
            if(d){ 
                document.getElementById('viewUserName').textContent=name; 
                document.getElementById('viewUserId').textContent=d.id; 
                document.getElementById('viewUserBal').textContent=formatNumber(d.balance); 
                document.getElementById('viewUserTag').textContent=d.tag||"Ğ“Ñ€Ğ°Ğ²ĞµÑ†ÑŒ"; 
                document.getElementById('viewUserAvatar').innerHTML=(d.avatar&&d.avatar.length>20)?`<img src="${d.avatar}">`:'ğŸ‘¤'; 
                openModal('view-user-modal'); 
            } 
        }); 
    }
    // ============================================
    // Ğ‘Ğ›Ğ•ĞšĞ”Ğ–Ğ•Ğš
    // ============================================
    const BJ_DECK = [];
    let bjPlayerHand = [], bjDealerHand = [], bjBet = 0, bjActive = false;

    function bjCreateDeck() {
      const suits = ['â™ ','â™¥','â™¦','â™£'], ranks = ['A','2','3','4','5','6','7','8','9','10','J','Q','K'];
      const d = [];
      for(const s of suits) for(const r of ranks) d.push({r,s});
      return d.sort(() => Math.random()-0.5);
    }

    function bjValue(hand) {
      let v = 0, aces = 0;
      for(const c of hand) {
        if(c.r === 'A') { aces++; v += 11; }
        else if(['J','Q','K'].includes(c.r)) v += 10;
        else v += parseInt(c.r);
      }
      while(v > 21 && aces > 0) { v -= 10; aces--; }
      return v;
    }

    function bjCardHTML(c, hidden=false) {
      if(hidden) return `<div class="bj-card" style="background:#1a3a6b;color:transparent;">ğŸ‚ </div>`;
      const red = c.s==='â™¥'||c.s==='â™¦';
      return `<div class="bj-card ${red?'red':''}">${c.r}<br>${c.s}</div>`;
    }

    function bjRender(hideDealer=true) {
      document.getElementById('bjPlayerCards').innerHTML = bjPlayerHand.map(c=>bjCardHTML(c)).join('');
      document.getElementById('bjDealerCards').innerHTML = bjDealerHand.map((c,i)=>bjCardHTML(c, hideDealer && i===1)).join('');
      document.getElementById('bjPlayerScore').textContent = bjValue(bjPlayerHand);
      document.getElementById('bjDealerScore').textContent = hideDealer ? '?' : bjValue(bjDealerHand);
    }

    function bjDeal() {
      const b = validateBet(document.getElementById('betAmountBJ').value);
      if(!b) return;
      bjBet = b;
      db.ref('users/'+currentUser).update({balance: userData.balance - b});
      const deck = bjCreateDeck();
      bjPlayerHand = [deck[0], deck[2]];
      bjDealerHand = [deck[1], deck[3]];
      bjActive = true;
      document.getElementById('bjDealBtn').classList.add('hidden');
      document.getElementById('bjActions').classList.remove('hidden');
      document.getElementById('bjResult').textContent = '';
      bjRender(true);
      playSound('click');
      if(bjValue(bjPlayerHand) === 21) { bjStand(); }
    }

    function bjHit() {
      if(!bjActive) return;
      const deck = bjCreateDeck();
      bjPlayerHand.push(deck[0]);
      bjRender(true);
      if(bjValue(bjPlayerHand) > 21) { bjEnd('bust'); }
    }

    function bjStand() {
      if(!bjActive) return;
      const deck = bjCreateDeck();
      let di = 0;
      while(bjValue(bjDealerHand) < 17) { bjDealerHand.push(deck[di++]); }
      bjRender(false);
      const p = bjValue(bjPlayerHand), d = bjValue(bjDealerHand);
      if(p > 21) bjEnd('bust');
      else if(d > 21 || p > d) bjEnd('win');
      else if(p === d) bjEnd('push');
      else bjEnd('lose');
    }

    function bjEnd(result) {
      bjActive = false;
      document.getElementById('bjDealBtn').classList.remove('hidden');
      document.getElementById('bjActions').classList.add('hidden');
      bjRender(false);
      const msgs = {win:'ğŸ† Ğ’Ğ¸ Ğ²Ğ¸Ğ³Ñ€Ğ°Ğ»Ğ¸!', lose:'ğŸ˜” Ğ”Ğ¸Ğ»ĞµÑ€ Ğ²Ğ¸Ğ³Ñ€Ğ°Ğ²', bust:'ğŸ’¥ ĞŸĞµÑ€ĞµĞ±Ñ–Ñ€!', push:'ğŸ¤ ĞÑ–Ñ‡Ğ¸Ñ'};
      const colors = {win:'var(--green)', lose:'var(--red)', bust:'var(--red)', push:'var(--accent)'};
      document.getElementById('bjResult').innerHTML = `<span style="color:${colors[result]}">${msgs[result]}</span>`;
      let win = 0;
      if(result === 'win') win = bjBet * 2;
      else if(result === 'push') win = bjBet;
      if(win > 0) {
        db.ref('users/'+currentUser+'/balance').set(firebase.database.ServerValue.increment(win));
        if(result === 'win') { playSound('win'); notify(`ğŸƒ Ğ’Ğ¸Ğ³Ñ€Ğ°Ñˆ: +${win - bjBet} â‚´`, 'success'); addToHistory(`Blackjack WIN: +${win-bjBet}`); }
      } else { addToHistory(`Blackjack: -${bjBet}`); }
    }

    // ============================================
    // ĞšĞ•ĞĞ
    // ============================================
    let kenoSelected = new Set();

    function initKeno() {
      const g = document.getElementById('kenoGrid');
      if(!g || g.children.length > 0) return;
      g.innerHTML = '';
      for(let i=1; i<=40; i++) {
        const d = document.createElement('div');
        d.className = 'keno-num'; d.textContent = i; d.dataset.n = i;
        d.onclick = () => toggleKeno(i, d);
        g.appendChild(d);
      }
    }

    function toggleKeno(n, el) {
      if(kenoSelected.has(n)) { kenoSelected.delete(n); el.classList.remove('picked'); }
      else if(kenoSelected.size < 10) { kenoSelected.add(n); el.classList.add('picked'); }
      else { notify('ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ 10 Ñ‡Ğ¸ÑĞµĞ»', 'error'); return; }
      document.getElementById('kenoSelected').textContent = `ĞĞ±Ñ€Ğ°Ğ½Ğ¾: ${kenoSelected.size} / 10`;
    }

    function clearKeno() {
      kenoSelected.clear();
      document.querySelectorAll('.keno-num').forEach(el => el.classList.remove('picked','hit','miss'));
      document.getElementById('kenoSelected').textContent = 'ĞĞ±Ñ€Ğ°Ğ½Ğ¾: 0 / 10';
    }

    function playKeno() {
      if(kenoSelected.size < 1) return notify('ĞĞ±ĞµÑ€Ñ–Ñ‚ÑŒ Ñ…Ğ¾Ñ‡Ğ° Ğ± 1 Ñ‡Ğ¸ÑĞ»Ğ¾', 'error');
      const b = validateBet(document.getElementById('betAmountKeno').value);
      if(!b) return;
      db.ref('users/'+currentUser).update({balance: userData.balance - b});

      // Ğ¢ÑĞ³Ğ½ĞµĞ¼Ğ¾ 20 Ñ‡Ğ¸ÑĞµĞ»
      const drawn = new Set();
      while(drawn.size < 20) drawn.add(Math.floor(Math.random()*40)+1);

      const hits = [...kenoSelected].filter(n => drawn.has(n)).length;
      const total = kenoSelected.size;

      // ĞœÑƒĞ»ÑŒÑ‚Ğ¸Ğ¿Ğ»Ñ–ĞºĞ°Ñ‚Ğ¾Ñ€Ğ¸ Ğ·Ğ°Ğ»ĞµĞ¶Ğ½Ğ¾ Ğ²Ñ–Ğ´ ĞºÑ–Ğ»ÑŒĞºĞ¾ÑÑ‚Ñ– Ğ²Ğ³Ğ°Ğ´Ğ½Ğ¸Ñ…
      const multTable = {1:[0,3], 2:[0,1,5], 3:[0,0,2,10], 4:[0,0,1,4,20], 5:[0,0,1,3,8,40],
        6:[0,0,0,2,5,15,60], 7:[0,0,0,1,3,8,25,100], 8:[0,0,0,1,2,5,15,50,200],
        9:[0,0,0,0,2,4,10,30,100,500], 10:[0,0,0,0,1,3,8,20,60,200,1000]};
      const mults = multTable[total] || [0];
      const mult = mults[Math.min(hits, mults.length-1)] || 0;
      const win = Math.floor(b * mult);

      // ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚Ğ¸ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
      document.querySelectorAll('.keno-num').forEach(el => {
        const n = parseInt(el.dataset.n);
        el.classList.remove('picked');
        if(drawn.has(n) && kenoSelected.has(n)) el.classList.add('hit');
        else if(drawn.has(n)) el.classList.add('miss');
      });

      document.getElementById('kenoSelected').innerHTML = `<b style="color:${win>0?'var(--green)':'var(--red)'}">Ğ’Ğ³Ğ°Ğ´Ğ°Ğ½Ğ¾: ${hits}/${total} â†’ ${win>0?'+'+win+' â‚´':'ĞŸÑ€Ğ¾Ğ³Ñ€Ğ°Ñˆ'}</b>`;

      if(win > 0) {
        db.ref('users/'+currentUser+'/balance').set(firebase.database.ServerValue.increment(win));
        playSound('win'); notify(`ğŸ”¢ ĞšĞµĞ½Ğ¾: +${win} â‚´ (${hits} Ğ²Ğ»ÑƒÑ‡Ğ°Ğ½ÑŒ)`, 'success');
        addToHistory(`Keno ${hits}/${total}: +${win}`);
      } else { addToHistory(`Keno ${hits}/${total}: -${b}`); }

      kenoSelected.clear();
    }

    // ============================================
    // Ğ¡ĞšĞ Ğ•Ğ¢Ğ§-ĞšĞĞ Ğ¢ĞšĞ
    // ============================================
    let scratchRevealed = 0, scratchValues = [], scratchBetAmt = 0, scratchDone = false;

    function buyScratch() {
      const b = validateBet(document.getElementById('betAmountScratch').value);
      if(!b) return;
      scratchBetAmt = b;
      db.ref('users/'+currentUser).update({balance: userData.balance - b});
      document.getElementById('scratchBuyBtn').classList.add('hidden');
      scratchRevealed = 0; scratchDone = false;
      const symbols = ['ğŸ’°','ğŸ’°','ğŸ’','ğŸ’','7ï¸','ğŸ’','ğŸ’','ğŸ””','â­','ğŸ’°'];
      // Ğ“ĞµĞ½ĞµÑ€ÑƒÑ”Ğ¼Ğ¾ 9 ĞºĞ»Ñ–Ñ‚Ğ¸Ğ½Ğ¾Ğº: Ğ¼Ğ¾Ğ¶Ğµ Ğ±ÑƒÑ‚Ğ¸ Ğ²Ğ¸Ğ³Ñ€Ğ°Ñˆ
      scratchValues = [];
      const r = Math.random();
      let winSym = null;
      if(r < 0.05) { winSym = 'ğŸ’'; } // Ğ¢Ñ€Ğ¸ Ğ¾Ğ´Ğ½Ğ°ĞºĞ¾Ğ²Ğ¸Ñ… = Ğ´Ğ¶ĞµĞºĞ¿Ğ¾Ñ‚
      else if(r < 0.20) { winSym = 'ğŸ’°'; }
      else if(r < 0.40) { winSym = 'â­'; }

      for(let i=0; i<9; i++) {
        if(winSym && i < 3) scratchValues.push(winSym);
        else scratchValues.push(symbols[Math.floor(Math.random()*symbols.length)]);
      }
      scratchValues.sort(() => Math.random()-0.5);

      const grid = document.getElementById('scratchGrid');
      grid.innerHTML = '';
      document.getElementById('scratchResult').textContent = '';
      scratchValues.forEach((sym, i) => {
        const cell = document.createElement('div');
        cell.className = 'scratch-cell';
        cell.innerHTML = `<div class="scratch-overlay">Ğ¡Ñ‚ĞµÑ€Ñ‚Ğ¸</div><span style="opacity:0">${sym}</span>`;
        cell.onclick = () => revealScratch(i, cell, sym);
        grid.appendChild(cell);
      });
      playSound('click');
    }

    function revealScratch(idx, cell, sym) {
      if(scratchDone || cell.classList.contains('scratched')) return;
      cell.classList.add('scratched');
      cell.innerHTML = sym;
      scratchRevealed++;
      playSound('click');
      if(scratchRevealed >= 9) finishScratch();
    }

    function finishScratch() {
      scratchDone = true;
      const counts = {};
      scratchValues.forEach(s => counts[s] = (counts[s]||0)+1);
      const best = Object.entries(counts).find(([,v]) => v >= 3);
      let win = 0, msg = '';
      if(best) {
        const mults = {'ğŸ’': 20, 'ğŸ’°': 5, 'â­': 3};
        const mult = mults[best[0]] || 2;
        win = Math.floor(scratchBetAmt * mult);
        msg = `ğŸ‰ Ğ¢Ñ€Ğ¸ ${best[0]}! Ğ’Ğ¸Ğ³Ñ€Ğ°Ñˆ: +${win} â‚´`;
      } else { msg = 'ğŸ˜” ĞĞµĞ¼Ğ°Ñ” Ñ‚Ñ€ÑŒĞ¾Ñ… Ğ¾Ğ´Ğ½Ğ°ĞºĞ¾Ğ²Ğ¸Ñ…'; }

      document.getElementById('scratchResult').innerHTML = `<b style="color:${win>0?'var(--green)':'#777'}">${msg}</b>`;
      if(win > 0) {
        db.ref('users/'+currentUser+'/balance').set(firebase.database.ServerValue.increment(win));
        playSound('win'); addToHistory(`Scratch: +${win}`);
      } else { addToHistory(`Scratch: -${scratchBetAmt}`); }
      setTimeout(() => document.getElementById('scratchBuyBtn').classList.remove('hidden'), 1500);
    }

    // ============================================
    // ĞšĞĞ›Ğ•Ğ¡Ğ Ğ¤ĞĞ Ğ¢Ğ£ĞĞ˜
    // ============================================
    const FORTUNE_SEGMENTS = [
      {label:'x0.2', mult:0.2, color:'#333'},
      {label:'x1',   mult:1,   color:'#1a3a6b'},
      {label:'x0.5', mult:0.5, color:'#333'},
      {label:'x2',   mult:2,   color:'#1a5c2a'},
      {label:'x0.2', mult:0.2, color:'#333'},
      {label:'x3',   mult:3,   color:'#5c1a1a'},
      {label:'x0.5', mult:0.5, color:'#333'},
      {label:'x5',   mult:5,   color:'#8B6914'},
      {label:'x0.2', mult:0.2, color:'#333'},
      {label:'x10',  mult:10,  color:'#4a0080'},
      {label:'x0.5', mult:0.5, color:'#333'},
      {label:'x50 ğŸ‰',mult:50, color:'#c00'},
    ];
    let fortuneRotation = 0, fortuneSpinning = false;

    function drawFortuneWheel(rotation=0) {
      const canvas = document.getElementById('fortuneCanvas');
      if(!canvas) return;
      const ctx = canvas.getContext('2d');
      const cx = 130, cy = 130, r = 124;
      const seg = FORTUNE_SEGMENTS.length;
      const arc = (2 * Math.PI) / seg;
      ctx.clearRect(0,0,260,260);
      FORTUNE_SEGMENTS.forEach((s, i) => {
        const startAngle = rotation + i * arc;
        ctx.beginPath(); ctx.moveTo(cx,cy);
        ctx.arc(cx, cy, r, startAngle, startAngle + arc);
        ctx.closePath(); ctx.fillStyle = s.color; ctx.fill();
        ctx.strokeStyle = '#000'; ctx.lineWidth = 1; ctx.stroke();
        ctx.save(); ctx.translate(cx, cy);
        ctx.rotate(startAngle + arc/2);
        ctx.textAlign = 'right'; ctx.fillStyle = '#fff';
        ctx.font = 'bold 11px sans-serif';
        ctx.fillText(s.label, r - 8, 4);
        ctx.restore();
      });
    }

    function spinFortune() {
      if(fortuneSpinning) return;
      const b = validateBet(document.getElementById('betAmountFortune').value);
      if(!b) return;
      db.ref('users/'+currentUser).update({balance: userData.balance - b});
      fortuneSpinning = true;
      document.getElementById('fortuneBtn').disabled = true;

      const winIdx = Math.floor(Math.random() * FORTUNE_SEGMENTS.length);
      const seg = FORTUNE_SEGMENTS.length;
      const arc = (2 * Math.PI) / seg;
      const extraSpins = 5 * 2 * Math.PI;
      const targetAngle = extraSpins + (seg - winIdx) * arc - arc/2;
      const totalRotation = fortuneRotation + targetAngle;
      const steps = 120, duration = 4000;
      let step = 0;
      const startRot = fortuneRotation;

      const anim = setInterval(() => {
        step++;
        const progress = step / steps;
        const ease = 1 - Math.pow(1 - progress, 3);
        const current = startRot + (totalRotation - startRot) * ease;
        drawFortuneWheel(current);
        if(step >= steps) {
          clearInterval(anim);
          fortuneRotation = totalRotation % (2 * Math.PI);
          const won = FORTUNE_SEGMENTS[winIdx];
          const win = Math.floor(b * won.mult);
          document.getElementById('fortuneResult').innerHTML = `<span style="color:${win>=b?'var(--green)':'#aaa'}">${won.label} â†’ ${win > 0 ? '+'+win+' â‚´' : '0 â‚´'}</span>`;
          if(win > 0) {
            db.ref('users/'+currentUser+'/balance').set(firebase.database.ServerValue.increment(win));
            playSound('win');
            if(won.mult >= 10) notify(`ğŸ‰ Ğ’Ğ•Ğ›Ğ˜ĞšĞ˜Ğ™ Ğ’Ğ˜Ğ“Ğ ĞĞ¨: +${win} â‚´!`, 'success');
            else notify(`ğŸ¡ ${won.label}: +${win} â‚´`, 'success');
            addToHistory(`Fortune ${won.label}: +${win}`);
          } else { addToHistory(`Fortune ${won.label}: -${b}`); }
          fortuneSpinning = false;
          document.getElementById('fortuneBtn').disabled = false;
        }
      }, duration/steps);
    }

    // ============================================
    // Ğ§ĞĞ¢ Ğ›ĞĞ‘Ğ†
    // ============================================
    let chatListener = null;

    function initLobbyChat() {
      const box = document.getElementById('lobbyChatBox');
      if(chatListener) return;
      box.innerHTML = '';
      chatListener = db.ref('lobby_chat').limitToLast(50).on('child_added', snap => {
        const m = snap.val();
        if(!m) return;
        const time = new Date(m.time).toLocaleTimeString('uk-UA',{hour:'2-digit',minute:'2-digit'});
        const el = document.createElement('div');
        if(m.system) {
          el.className = 'chat-system'; el.textContent = m.text;
        } else {
          el.className = 'chat-msg';
          const nickColor = m.sender === currentUser ? 'var(--accent)' : (m.isAdmin ? '#ff6b6b' : '#4a9eff');
          el.innerHTML = `<span class="chat-nick" style="color:${nickColor}" onclick="openPublicProfile('${m.sender}')">${m.isAdmin?'[ADMIN] ':''}${m.sender}</span><span class="chat-time">${time}</span><br>${m.text}`;
        }
        box.appendChild(el);
        box.scrollTop = box.scrollHeight;
      });

      // ĞĞ³Ğ¾Ğ»Ğ¾ÑˆĞµĞ½Ğ½Ñ
      db.ref('announcement').on('value', snap => {
        const txt = snap.val();
        const banner = document.getElementById('announceBanner');
        if(txt) { banner.textContent = 'ğŸ“¢ ' + txt; banner.classList.remove('hidden'); }
        else { banner.classList.add('hidden'); }
      });

      // ĞĞ½Ğ»Ğ°Ğ¹Ğ½ Ğ»Ñ–Ñ‡Ğ¸Ğ»ÑŒĞ½Ğ¸Ğº
      db.ref('online').on('value', snap => {
        const count = snap.val() ? Object.keys(snap.val()).length : 0;
        const el = document.getElementById('onlineCount');
        if(el) el.textContent = count;
      });
      db.ref('online/'+currentUser).set(true);
      db.ref('online/'+currentUser).onDisconnect().remove();
    }

    function sendLobbyMsg() {
      const input = document.getElementById('lobbyChatInput');
      const txt = input.value.trim();
      if(!txt || txt.length > 200) return;
      if(userData.muted) return notify('Ğ’Ğ°Ñ Ğ·Ğ°Ğ¼ÑƒÑ‚Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ² Ñ‡Ğ°Ñ‚Ñ–', 'error');
      db.ref('lobby_chat').push({
        sender: currentUser, text: txt, time: Date.now(),
        isAdmin: (currentUser.toLowerCase()==='theivankoo' || userData.isAdmin===true)
      });
      input.value = '';
    }

    // ============================================
    // ĞŸĞ£Ğ‘Ğ›Ğ†Ğ§ĞĞ˜Ğ™ ĞŸĞ ĞĞ¤Ğ†Ğ›Ğ¬
    // ============================================
    function openPublicProfile(name) {
      if(name === currentUser) return switchTab('profile');
      db.ref('users/'+name).once('value', snap => {
        const d = snap.val();
        if(!d) return notify('Ğ“Ñ€Ğ°Ğ²Ñ†Ñ Ğ½Ğµ Ğ·Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾', 'error');
        const av = d.avatar && d.avatar.length > 20 ? `<img src="${d.avatar}">` : 'ğŸ‘¤';
        const badges = computeBadges(d);
        document.getElementById('pubProfileContent').innerHTML = `
          <div class="pub-profile">
            <div class="profile-header">
              <div class="avatar-large">${av}</div>
              <div>
                <div style="font-size:22px;font-weight:bold;">${name}</div>
                <div style="color:#777;font-size:13px;">${d.tag||'Ğ“Ñ€Ğ°Ğ²ĞµÑ†ÑŒ'}</div>
              </div>
            </div>
            <div style="color:#555;font-size:12px;margin-bottom:10px;">ID: ${d.id||'â€”'} â€¢ Ğ ĞµÑ”ÑÑ‚Ñ€Ğ°Ñ†Ñ–Ñ: ${d.regDate ? new Date(d.regDate).toLocaleDateString('uk-UA') : 'ĞĞµĞ²Ñ–Ğ´Ğ¾Ğ¼Ğ¾'}</div>
            <div class="pub-stats-grid">
              <div class="pub-stat"><div class="pub-stat-val">${formatNumber(d.balance)}</div><div class="pub-stat-label">â‚´ Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ</div></div>
              <div class="pub-stat"><div class="pub-stat-val">${d.dailyStreak||0}</div><div class="pub-stat-label">ğŸ”¥ Ğ¡ĞµÑ€Ñ–Ñ</div></div>
              <div class="pub-stat"><div class="pub-stat-val">${d.stats?.gamesPlayed||0}</div><div class="pub-stat-label">Ğ†Ğ³Ğ¾Ñ€ Ğ·Ñ–Ğ³Ñ€Ğ°Ğ½Ğ¾</div></div>
              <div class="pub-stat"><div class="pub-stat-val">${d.stats?.biggestWin ? formatNumber(d.stats.biggestWin) : '0'}</div><div class="pub-stat-label">ğŸ† ĞĞ°Ğ¹Ğ±. Ğ²Ğ¸Ğ³Ñ€Ğ°Ñˆ</div></div>
            </div>
            <div class="pub-badges">${badges}</div>
            <div style="display:flex;gap:8px;margin-top:15px;">
              <button class="btn-outline" style="flex:1;" onclick="document.getElementById('transferTo').value='${name}';openModal('transfer-modal');">ğŸ’¸ ĞĞ°Ğ´Ñ–ÑĞ»Ğ°Ñ‚Ğ¸</button>
              <button class="btn-outline" style="flex:1;" onclick="addContactByName('${name}')">ğŸ¤ Ğ’ Ğ·Ğ½Ğ°Ğ¹Ğ¾Ğ¼Ñ–</button>
            </div>
          </div>`;
        openModal('pub-profile-modal');
      });
    }

    function computeBadges(d) {
      let badges = '';
      if(d.balance >= 100000) badges += `<span class="badge gold">ğŸ’° ĞœÑ–Ğ»ÑŒĞ¹Ğ¾Ğ½ĞµÑ€</span>`;
      if(d.dailyStreak >= 7) badges += `<span class="badge gold">ğŸ”¥ Ğ¡ĞµÑ€Ñ–Ñ 7+</span>`;
      if(d.stats?.gamesPlayed >= 100) badges += `<span class="badge">ğŸ® Ğ’ĞµÑ‚ĞµÑ€Ğ°Ğ½</span>`;
      if(d.isAdmin) badges += `<span class="badge gold">âš™ï¸ ĞĞ´Ğ¼Ñ–Ğ½</span>`;
      if(d.stats?.biggestWin >= 10000) badges += `<span class="badge gold">ğŸ† Ğ’ĞµĞ»Ğ¸ĞºĞ¸Ğ¹ Ğ²Ğ¸Ğ³Ñ€Ğ°Ñˆ</span>`;
      if(d.referrals >= 5) badges += `<span class="badge">ğŸ‘¥ Ğ ĞµĞºÑ€ÑƒÑ‚ĞµÑ€</span>`;
      return badges || `<span class="badge">ğŸ†• ĞĞ¾Ğ²Ğ°Ñ‡Ğ¾Ğº</span>`;
    }

    function addContactByName(name) {
      db.ref('users/'+currentUser+'/contacts/'+name).set({avatar:'ğŸ‘¤'});
      notify('Ğ”Ğ¾Ğ´Ğ°Ğ½Ğ¾ Ñƒ Ğ·Ğ½Ğ°Ğ¹Ğ¾Ğ¼Ñ–!', 'success');
    }

    // ============================================
    // Ğ”Ğ£Ğ•Ğ›Ğ†
    // ============================================
    let activeDuelId = null;

    function createDuel() {
      const target = document.getElementById('duelTarget').value.trim();
      const amount = parseInt(document.getElementById('duelAmount').value);
      if(!target || target === currentUser) return notify('ĞĞµĞ²Ñ–Ñ€Ğ½Ğ¸Ğ¹ ÑÑƒĞ¿ĞµÑ€Ğ½Ğ¸Ğº', 'error');
      if(!amount || amount < 50) return notify('ĞœÑ–Ğ½. ÑÑ‚Ğ°Ğ²ĞºĞ° 50â‚´', 'error');
      if(userData.balance < amount) return notify('ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ½ÑŒĞ¾ ĞºĞ¾ÑˆÑ‚Ñ–Ğ²', 'error');

      db.ref('users/'+target).once('value', snap => {
        if(!snap.exists()) return notify('Ğ“Ñ€Ğ°Ğ²Ñ†Ñ Ğ½Ğµ Ğ·Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾', 'error');
        const duelId = currentUser + '_' + Date.now();
        db.ref('users/'+currentUser).update({balance: userData.balance - amount});
        db.ref('duels/'+duelId).set({
          challenger: currentUser, target, amount, status: 'pending', time: Date.now()
        });
        notify(`âš”ï¸ Ğ’Ğ¸ĞºĞ»Ğ¸Ğº Ğ½Ğ°Ğ´Ñ–ÑĞ»Ğ°Ğ½Ğ¾ ${target}!`, 'success');
        document.getElementById('duelTarget').value = '';
        document.getElementById('duelAmount').value = '';
      });
    }

    function loadDuels() {
      // ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ– Ğ´ÑƒĞµĞ»Ñ–
      db.ref('duels').orderByChild('status').equalTo('pending').limitToLast(10).once('value', snap => {
        const data = snap.val();
        const list = document.getElementById('duelsList');
        if(!data) { list.innerHTML = '<div style="color:#777;font-size:13px;">ĞĞµĞ¼Ğ°Ñ” Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¸Ñ… Ğ´ÑƒĞµĞ»ĞµĞ¹</div>'; return; }
        list.innerHTML = '';
        Object.entries(data).forEach(([id, d]) => {
          const isTarget = d.target === currentUser;
          const isChallenger = d.challenger === currentUser;
          list.innerHTML += `<div class="duel-card">
            <div class="duel-players">
              <div><div style="font-weight:bold;color:var(--accent);">${d.challenger}</div><div style="font-size:11px;color:#777;">Challenger</div></div>
              <div class="duel-vs">VS</div>
              <div><div style="font-weight:bold;color:#4a9eff;">${d.target}</div><div style="font-size:11px;color:#777;">Target</div></div>
            </div>
            <div style="text-align:center;margin-top:8px;">
              <span style="color:var(--accent);font-weight:bold;">${d.amount} â‚´</span>
              ${isTarget ? `<button class="btn-green" style="padding:6px 12px;width:auto;margin-left:10px;font-size:12px;" onclick="respondDuel('${id}','accept')">âœ… ĞŸÑ€Ğ¸Ğ¹Ğ½ÑÑ‚Ğ¸</button><button class="btn-red" style="padding:6px 12px;width:auto;margin-left:5px;font-size:12px;" onclick="respondDuel('${id}','decline')">âŒ</button>` : ''}
              ${isChallenger ? `<button class="btn-outline" style="padding:6px 12px;width:auto;margin-left:10px;font-size:12px;" onclick="cancelDuel('${id}')">Ğ¡ĞºĞ°ÑÑƒĞ²Ğ°Ñ‚Ğ¸</button>` : ''}
            </div>
          </div>`;
        });
      });
    }

    function respondDuel(id, action) {
      db.ref('duels/'+id).once('value', snap => {
        const d = snap.val();
        if(!d || d.status !== 'pending') return;
        if(action === 'decline') {
          db.ref('duels/'+id).update({status:'declined'});
          db.ref('users/'+d.challenger+'/balance').set(firebase.database.ServerValue.increment(d.amount));
          notify('Ğ”ÑƒĞµĞ»ÑŒ Ğ²Ñ–Ğ´Ñ…Ğ¸Ğ»ĞµĞ½Ğ¾', 'info'); loadDuels(); return;
        }
        if(userData.balance < d.amount) return notify('ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ½ÑŒĞ¾ ĞºĞ¾ÑˆÑ‚Ñ–Ğ²', 'error');
        db.ref('users/'+currentUser).update({balance: userData.balance - d.amount});
        // Ğ’Ğ¸Ğ·Ğ½Ğ°Ñ‡Ğ°Ñ”Ğ¼Ğ¾ Ğ¿ĞµÑ€ĞµĞ¼Ğ¾Ğ¶Ñ†Ñ
        const winner = Math.random() > 0.5 ? d.challenger : d.target;
        const loser = winner === d.challenger ? d.target : d.challenger;
        const prize = Math.floor(d.amount * 1.9); // 5% ĞºĞ¾Ğ¼Ñ–ÑÑ–Ñ ĞºĞ°Ğ·Ğ¸Ğ½Ğ¾
        db.ref('users/'+winner+'/balance').set(firebase.database.ServerValue.increment(prize));
        db.ref('duels/'+id).update({status:'done', winner, time_end: Date.now()});
        db.ref('lobby_chat').push({system:true, text:`âš”ï¸ Ğ”ÑƒĞµĞ»ÑŒ: ${d.challenger} vs ${d.target} â€” Ğ¿ĞµÑ€ĞµĞ¼Ñ–Ğ³ ${winner}! (+${prize}â‚´)`, time:Date.now()});
        notify(winner===currentUser ? `ğŸ† Ğ’Ğ¸ Ğ²Ğ¸Ğ³Ñ€Ğ°Ğ»Ğ¸ Ğ´ÑƒĞµĞ»ÑŒ! +${prize}â‚´` : `ğŸ˜” Ğ’Ğ¸ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ»Ğ¸ Ğ´ÑƒĞµĞ»ÑŒ`, winner===currentUser?'success':'error');
        addToHistory(`Duel vs ${loser}: ${winner===currentUser?'+'+prize:'-'+d.amount}`);
        loadDuels();
      });
    }

    function cancelDuel(id) {
      db.ref('duels/'+id).once('value', snap => {
        const d = snap.val();
        if(d && d.challenger === currentUser) {
          db.ref('duels/'+id).update({status:'cancelled'});
          db.ref('users/'+currentUser+'/balance').set(firebase.database.ServerValue.increment(d.amount));
          notify('Ğ”ÑƒĞµĞ»ÑŒ ÑĞºĞ°ÑĞ¾Ğ²Ğ°Ğ½Ğ¾', 'info'); loadDuels();
        }
      });
    }

    // ============================================
    // Ğ¢Ğ£Ğ ĞĞ†Ğ Ğ˜
    // ============================================
    function loadTournaments() {
      db.ref('tournaments').once('value', snap => {
        const data = snap.val();
        const list = document.getElementById('tournamentsList');
        if(!data) { list.innerHTML = '<div style="color:#777;padding:20px;text-align:center;">ĞĞµĞ¼Ğ°Ñ” Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¸Ñ… Ñ‚ÑƒÑ€Ğ½Ñ–Ñ€Ñ–Ğ²</div>'; return; }
        list.innerHTML = '';
        Object.entries(data).forEach(([id, t]) => {
          const endTime = t.startTime + t.duration * 3600000;
          const msLeft = endTime - Date.now();
          const hoursLeft = Math.max(0, Math.floor(msLeft / 3600000));
          const minsLeft = Math.max(0, Math.floor((msLeft % 3600000) / 60000));
          const isActive = msLeft > 0;
          list.innerHTML += `<div class="tournament-card">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div style="font-size:16px;font-weight:bold;">${t.name}</div>
              <span style="font-size:11px;background:${isActive?'rgba(76,217,100,0.2)':'rgba(255,59,48,0.2)'};color:${isActive?'var(--green)':'var(--red)'};padding:3px 8px;border-radius:10px;">${isActive?'ğŸŸ¢ ĞĞºÑ‚Ğ¸Ğ²Ğ½Ğ¸Ğ¹':'ğŸ”´ Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾'}</span>
            </div>
            <div class="t-prize">ğŸ† ${formatNumber(t.prize)} â‚´</div>
            <div class="t-info">${isActive ? `Ğ—Ğ°ĞºÑ–Ğ½Ñ‡ÑƒÑ”Ñ‚ÑŒÑÑ Ñ‡ĞµÑ€ĞµĞ· ${hoursLeft}Ğ³Ğ¾Ğ´ ${minsLeft}Ñ…Ğ²` : 'Ğ¢ÑƒÑ€Ğ½Ñ–Ñ€ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¾'}</div>
            <div class="t-leaderboard" id="t-lb-${id}">
              <div style="color:#555;font-size:12px;margin-top:8px;">Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ Ñ€ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³Ñƒ...</div>
            </div>
            ${isActive ? `<button class="btn-gold" style="margin-top:10px;padding:10px;" onclick="joinTournament('${id}','${t.name}',${t.prize})">ğŸ¯ Ğ’Ğ·ÑÑ‚Ğ¸ ÑƒÑ‡Ğ°ÑÑ‚ÑŒ</button>` : ''}
          </div>`;
          loadTournamentLeaderboard(id);
        });
      });
    }

    function loadTournamentLeaderboard(tId) {
      db.ref('tournament_scores/'+tId).orderByValue().limitToLast(5).once('value', snap => {
        const el = document.getElementById('t-lb-'+tId);
        if(!el) return;
        const data = snap.val();
        if(!data) { el.innerHTML = '<div style="color:#555;font-size:12px;margin-top:8px;">Ğ©Ğµ Ğ½ĞµĞ¼Ğ°Ñ” ÑƒÑ‡Ğ°ÑĞ½Ğ¸ĞºÑ–Ğ²</div>'; return; }
        const sorted = Object.entries(data).sort((a,b)=>b[1]-a[1]);
        el.innerHTML = sorted.map(([name, score], i) =>
          `<div class="t-row"><span>${['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰','4.','5.'][i]} ${name}</span><span style="color:var(--accent);">${formatNumber(score)} â‚´</span></div>`
        ).join('');
      });
    }

    function joinTournament(id, name, prize) {
      db.ref('tournament_scores/'+id+'/'+currentUser).once('value', snap => {
        if(!snap.exists()) {
          db.ref('tournament_scores/'+id+'/'+currentUser).set(0);
          notify(`ğŸ† Ğ’Ğ¸ Ğ¿Ñ€Ğ¸Ñ”Ğ´Ğ½Ğ°Ğ»Ğ¸ÑÑŒ Ğ´Ğ¾ Ñ‚ÑƒÑ€Ğ½Ñ–Ñ€Ñƒ "${name}"!`, 'success');
        } else {
          notify(`Ğ’Ğ¸ Ğ²Ğ¶Ğµ Ğ±ĞµÑ€ĞµÑ‚ĞµÑÑŒ Ñƒ Ñ‚ÑƒÑ€Ğ½Ñ–Ñ€Ñ– "${name}"`, 'info');
        }
      });
    }

    function createTournament() {
      const name = document.getElementById('tName').value.trim();
      const prize = parseInt(document.getElementById('tPrize').value);
      const dur = parseInt(document.getElementById('tDuration').value);
      if(!name || !prize || !dur) return notify('Ğ—Ğ°Ğ¿Ğ¾Ğ²Ğ½Ñ–Ñ‚ÑŒ ÑƒÑÑ– Ğ¿Ğ¾Ğ»Ñ', 'error');
      db.ref('tournaments').push({name, prize, duration: dur, startTime: Date.now(), createdBy: currentUser});
      notify(`ğŸ† Ğ¢ÑƒÑ€Ğ½Ñ–Ñ€ "${name}" ÑÑ‚Ğ²Ğ¾Ñ€ĞµĞ½Ğ¾!`, 'success');
      document.getElementById('tName').value=''; document.getElementById('tPrize').value=''; document.getElementById('tDuration').value='';
    }

    // ============================================
    // Ğ Ğ•Ğ¤Ğ•Ğ ĞĞ›Ğ˜
    // ============================================
    function initReferrals() {
      const id = userData.id;
      const link = `${location.origin}${location.pathname}?ref=${id}`;
      document.getElementById('refLinkText').textContent = link;
      document.getElementById('refCount').textContent = userData.referrals || 0;
      document.getElementById('refEarned').textContent = (userData.refEarned || 0) + 'â‚´';

      const list = document.getElementById('refFriendsList');
      if(userData.refFriends) {
        list.innerHTML = '';
        Object.keys(userData.refFriends).forEach(name => {
          list.innerHTML += `<div class="contact-row"><b>${name}</b></div>`;
        });
      }
    }

    function copyRefLink() {
      const link = document.getElementById('refLinkText').textContent;
      navigator.clipboard.writeText(link).then(() => notify('ğŸ“‹ ĞŸĞ¾ÑĞ¸Ğ»Ğ°Ğ½Ğ½Ñ ÑĞºĞ¾Ğ¿Ñ–Ğ¹Ğ¾Ğ²Ğ°Ğ½Ğ¾!', 'success'));
    }

    function checkRefParam() {
      const urlParams = new URLSearchParams(location.search);
      const ref = urlParams.get('ref');
      if(ref && currentUser) {
        localStorage.setItem('ref_by', ref);
      }
    }

    // ============================================
    // ĞĞ”ĞœĞ†Ğ: Ğ ĞĞ—Ğ¨Ğ˜Ğ Ğ•ĞĞ† Ğ¤Ğ£ĞĞšĞ¦Ğ†Ğ‡
    // ============================================
    function loadAdminStats() {
      db.ref('users').once('value', snap => {
        const users = snap.val() || {};
        const total = Object.keys(users).length;
        const totalBal = Object.values(users).reduce((s,u) => s+(u.balance||0), 0);
        document.getElementById('statTotalUsers').textContent = total;
        document.getElementById('statTotalBalance').textContent = formatNumber(totalBal)+'â‚´';
      });
      db.ref('duels').orderByChild('status').equalTo('pending').once('value', snap => {
        document.getElementById('statActiveDuels').textContent = snap.val() ? Object.keys(snap.val()).length : 0;
      });
      db.ref('withdraw_requests').orderByChild('status').equalTo('pending').once('value', snap => {
        document.getElementById('statPendingWithdraws').textContent = snap.val() ? Object.keys(snap.val()).length : 0;
      });
    }

    function sendAnnouncement() {
      const txt = document.getElementById('announceText').value.trim();
      if(!txt) return notify('Ğ’Ğ²ĞµĞ´Ñ–Ñ‚ÑŒ Ñ‚ĞµĞºÑÑ‚', 'error');
      db.ref('announcement').set(txt);
      notify('ğŸ“¢ ĞĞ³Ğ¾Ğ»Ğ¾ÑˆĞµĞ½Ğ½Ñ Ğ¾Ğ¿ÑƒĞ±Ğ»Ñ–ĞºĞ¾Ğ²Ğ°Ğ½Ğ¾!', 'success');
    }

    function clearAnnouncement() {
      db.ref('announcement').remove();
      notify('ĞĞ³Ğ¾Ğ»Ğ¾ÑˆĞµĞ½Ğ½Ñ Ğ²Ğ¸Ğ´Ğ°Ğ»ĞµĞ½Ğ¾', 'info');
    }

    function createPromo() {
      const code = document.getElementById('promoCode').value.trim().toUpperCase();
      const val = parseInt(document.getElementById('promoValue').value);
      const uses = parseInt(document.getElementById('promoUses').value) || 1;
      if(!code || !val) return notify('Ğ—Ğ°Ğ¿Ğ¾Ğ²Ğ½Ñ–Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ñ', 'error');
      db.ref('promos/'+code).set({value: val, uses, createdBy: currentUser, time: Date.now()});
      notify(`ğŸ ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´ ${code} (${val}â‚´) ÑÑ‚Ğ²Ğ¾Ñ€ĞµĞ½Ğ¾!`, 'success');
      document.getElementById('promoCode').value=''; document.getElementById('promoValue').value=''; document.getElementById('promoUses').value='';
      loadPromos();
    }

    function loadPromos() {
      db.ref('promos').once('value', snap => {
        const data = snap.val();
        const list = document.getElementById('promoList');
        if(!data) { list.innerHTML='<div style="color:#777;font-size:13px;">ĞĞµĞ¼Ğ°Ñ” Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´Ñ–Ğ²</div>'; return; }
        list.innerHTML = '';
        Object.entries(data).forEach(([code, p]) => {
          list.innerHTML += `<div class="promo-row">
            <div><b style="color:var(--accent);">${code}</b> <span style="color:#777;font-size:12px;">(${p.value}â‚´, ${p.uses} Ñ€Ğ°Ğ·)</span></div>
            <button class="btn-red" style="width:auto;padding:6px 12px;margin:0;font-size:12px;" onclick="deletePromo('${code}')">ğŸ—‘ï¸</button>
          </div>`;
        });
      });
    }

    function deletePromo(code) {
      db.ref('promos/'+code).remove();
      notify('ĞŸÑ€Ğ¾Ğ¼Ğ¾ĞºĞ¾Ğ´ Ğ²Ğ¸Ğ´Ğ°Ğ»ĞµĞ½Ğ¾', 'info');
      loadPromos();
    }

    function loadSupportThreads() {
      db.ref('support_chats').once('value', snap => {
        const data = snap.val();
        const list = document.getElementById('supportThreadsList');
        if(!data) { list.innerHTML='<div style="color:#777;font-size:13px;">ĞĞµĞ¼Ğ°Ñ” Ñ‡Ğ°Ñ‚Ñ–Ğ²</div>'; return; }
        list.innerHTML = '';
        Object.entries(data).forEach(([user, msgs]) => {
          const lastMsg = Object.values(msgs).pop();
          list.innerHTML += `<div class="support-thread" onclick="openAdminSupport('${user}')">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <b>${user}</b>
              ${lastMsg.sender==='user' ? '<span class="support-unread">ĞĞ¾Ğ²Ğµ</span>' : ''}
            </div>
            <div style="color:#777;font-size:12px;margin-top:4px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;">${lastMsg.text}</div>
          </div>`;
        });
      });
    }

    let admSupportUser = null;
    function openAdminSupport(user) {
      admSupportUser = user;
      document.getElementById('admSupportTitle').textContent = 'Ğ§Ğ°Ñ‚ Ğ· ' + user;
      const chat = document.getElementById('admSupportChat');
      chat.innerHTML = '';
      db.ref('support_chats/'+user).limitToLast(30).on('child_added', snap => {
        const m = snap.val();
        chat.innerHTML += `<div style="margin-bottom:8px;padding:8px 12px;background:${m.sender==='user'?'#005c4b':'#1a1a6b'};border-radius:8px;width:fit-content;max-width:80%;margin-left:${m.sender==='user'?'0':'auto'}">${m.sender==='admin'?'[ĞŸÑ–Ğ´Ñ‚Ñ€Ğ¸Ğ¼ĞºĞ°] ':''}${m.text}</div>`;
        chat.scrollTop = chat.scrollHeight;
      });
      openModal('admin-support-modal');
    }

    function sendAdminSupportReply() {
      const txt = document.getElementById('admSupportReply').value.trim();
      if(!txt || !admSupportUser) return;
      db.ref('support_chats/'+admSupportUser).push({text:txt, sender:'admin', time:Date.now()});
      document.getElementById('admSupportReply').value = '';
    }

    function loadDepositRequests() {
      const list = document.getElementById('depositRequestsList');
      list.innerHTML = 'Ğ—Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ...';
      db.ref('deposit_requests').orderByChild('status').equalTo('pending').once('value', snap => {
        const data = snap.val();
        if(!data) { list.innerHTML='<div style="color:#777;font-size:13px;padding:10px 0;">ĞĞµĞ¼Ğ°Ñ” Ğ·Ğ°ÑĞ²Ğ¾Ğº</div>'; return; }
        list.innerHTML = '';
        Object.entries(data).forEach(([id, req]) => {
          list.innerHTML += `<div class="request-card">
            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
              <b>${req.user}</b><span style="color:var(--green);font-weight:bold;">${req.amount} â‚´</span>
            </div>
            <div style="color:#777;font-size:12px;">ID: ${req.userId} â€¢ TG Ğ±Ğ¾Ñ‚</div>
            <div style="color:#555;font-size:11px;">${new Date(req.time).toLocaleString('uk-UA')}</div>
            <div style="display:flex;gap:8px;margin-top:10px;">
              <button class="btn-green" style="padding:8px;font-size:12px;" onclick="approveDeposit('${id}','${req.user}',${req.amount})">âœ… Ğ—Ğ°Ñ€Ğ°Ñ…ÑƒĞ²Ğ°Ñ‚Ğ¸</button>
              <button class="btn-red" style="padding:8px;font-size:12px;" onclick="rejectDeposit('${id}')">âŒ Ğ’Ñ–Ğ´Ñ…Ğ¸Ğ»Ğ¸Ñ‚Ğ¸</button>
            </div>
          </div>`;
        });
      });
    }

    function approveDeposit(id, user, amount) {
      db.ref('users/'+user+'/balance').set(firebase.database.ServerValue.increment(amount));
      db.ref('deposit_requests/'+id).update({status:'done'});
      db.ref('users/'+user+'/history').push({text:`Ğ”ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚ Ğ¿Ñ–Ğ´Ñ‚Ğ²ĞµÑ€Ğ´Ğ¶ĞµĞ½Ğ¾: +${amount}â‚´`, date:Date.now()});
      notify(`âœ… Ğ”ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚ ${amount}â‚´ Ğ·Ğ°Ñ€Ğ°Ñ…Ğ¾Ğ²Ğ°Ğ½Ğ¾ ${user}`, 'success');
      loadDepositRequests();
    }

    function rejectDeposit(id) {
      db.ref('deposit_requests/'+id).update({status:'rejected'});
      notify('Ğ”ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚ Ğ²Ñ–Ğ´Ñ…Ğ¸Ğ»ĞµĞ½Ğ¾', 'info');
      loadDepositRequests();
    }

    // ============================================
    // ĞĞĞĞ’Ğ›Ğ•ĞĞ˜Ğ™ switchTab â€” Ñ–Ğ½Ñ–Ñ†Ñ–Ğ°Ğ»Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ğ¿Ñ€Ğ¸ Ğ²Ñ–Ğ´ĞºÑ€Ğ¸Ñ‚Ñ‚Ñ–
    // ============================================
    const _origSwitchTab = switchTab;
    function switchTab(id, el) {
      document.querySelectorAll('.screen').forEach(s=>s.classList.add('hidden'));
      const tab = document.getElementById('tab-'+id);
      if(tab) tab.classList.remove('hidden');
      if(el){ document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active')); el.classList.add('active'); }
      // Ğ†Ğ½Ñ–Ñ†Ñ–Ğ°Ğ»Ñ–Ğ·Ğ°Ñ†Ñ–Ñ Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€ÑˆĞ¾Ğ¼Ñƒ Ğ²Ñ–Ğ´ĞºÑ€Ğ¸Ñ‚Ñ‚Ñ–
      if(id==='chat') initLobbyChat();
      if(id==='keno') initKeno();
      if(id==='fortune') { setTimeout(()=>drawFortuneWheel(0), 50); }
      if(id==='duels') loadDuels();
      if(id==='tournaments') loadTournaments();
      if(id==='referrals') initReferrals();
      if(id==='admin') loadAdminStats();
      if(id==='scratch') { const g=document.getElementById('scratchGrid'); if(!g.children.length) scratchReset(); }
    }

    function scratchReset() {
      document.getElementById('scratchGrid').innerHTML = '<div style="text-align:center;color:#777;grid-column:1/-1;padding:20px;">ĞšÑƒĞ¿Ğ¸ ĞºĞ°Ñ€Ñ‚ĞºÑƒ Ñ‰Ğ¾Ğ± Ğ³Ñ€Ğ°Ñ‚Ğ¸</div>';
      document.getElementById('scratchBuyBtn').classList.remove('hidden');
    }

    // ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ĞºĞ° Ñ€ĞµÑ„ĞµÑ€Ğ°Ğ»Ğ° Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ñ–
    checkRefParam();

    // ============================================
    // Ğ¢Ğ•ĞœĞ
    // ============================================
    function toggleTheme() {
      const body = document.body;
      const isDark = body.getAttribute('data-theme') === 'dark';
      body.setAttribute('data-theme', isDark ? 'light' : 'dark');
      localStorage.setItem('slotok_theme', isDark ? 'light' : 'dark');
      document.querySelectorAll('.theme-btn').forEach(b => b.textContent = isDark ? 'ğŸŒ™' : 'â˜€ï¸');
    }
    const savedTheme = localStorage.getItem('slotok_theme');
    if(savedTheme) { document.body.setAttribute('data-theme', savedTheme); document.querySelectorAll('.theme-btn').forEach(b => b.textContent = savedTheme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸'); }

    // ============================================
    // ĞšĞĞĞ¤Ğ•Ğ¢Ğ†
    // ============================================
    function launchConfetti(count=80) {
      const container = document.getElementById('confetti-container');
      const colors = ['#d4af37','#ffdb4d','#4cd964','#ff3b30','#4a9eff','#ff9f0a'];
      for(let i=0; i<count; i++) {
        const piece = document.createElement('div');
        piece.className = 'confetti-piece';
        piece.style.cssText = `
          left:${Math.random()*100}%;
          background:${colors[Math.floor(Math.random()*colors.length)]};
          width:${6+Math.random()*8}px;
          height:${6+Math.random()*8}px;
          border-radius:${Math.random()>0.5?'50%':'2px'};
          animation-duration:${2+Math.random()*2}s;
          animation-delay:${Math.random()*0.5}s;
          transform:rotate(${Math.random()*360}deg);
        `;
        container.appendChild(piece);
        setTimeout(() => piece.remove(), 4000);
      }
    }

    // Overwrite notify to add confetti on big wins
    const _origNotify = notify;
    function notifyWin(msg, win, bet) {
      notify(msg, 'success');
      if(win >= bet * 5) launchConfetti(win >= bet * 20 ? 150 : 80);
    }

    // ============================================
    // Ğ¡Ğ¢ĞĞ¢Ğ˜Ğ¡Ğ¢Ğ˜ĞšĞ Ğ“Ğ ĞĞ’Ğ¦Ğ¯ (Ñ‚Ñ€ĞµĞºÑ–Ğ½Ğ³)
    // ============================================
    function trackGame(won, winAmount, betAmount) {
      if(!currentUser) return;
      const updates = {
        'stats/gamesPlayed': firebase.database.ServerValue.increment(1)
      };
      if(won && winAmount > 0) {
        updates['stats/totalWon'] = firebase.database.ServerValue.increment(winAmount);
      }
      db.ref('users/'+currentUser).update(updates);
      // ĞĞ°Ğ¹Ğ±Ñ–Ğ»ÑŒÑˆĞ¸Ğ¹ Ğ²Ğ¸Ğ³Ñ€Ğ°Ñˆ
      if(won && winAmount > (userData.stats?.biggestWin||0)) {
        db.ref('users/'+currentUser+'/stats/biggestWin').set(winAmount);
      }
      // Ğ—Ğ°Ğ¿Ğ¸ÑÑƒÑ”Ğ¼Ğ¾ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ Ğ´Ğ»Ñ Ğ³Ñ€Ğ°Ñ„Ñ–ĞºĞ°
      db.ref('users/'+currentUser+'/balanceHistory').push({bal: userData.balance, time: Date.now()});
      // ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ÑÑ”Ğ¼Ğ¾ Ğ´Ğ¾ÑÑĞ³Ğ½ĞµĞ½Ğ½Ñ
      checkAchievements(winAmount);
    }

    // ============================================
    // Ğ”ĞĞ¡Ğ¯Ğ“ĞĞ•ĞĞĞ¯
    // ============================================
    const ACHIEVEMENTS = [
      {id:'first_game',   icon:'ğŸ®', name:'ĞŸĞµÑ€ÑˆĞ° Ğ³Ñ€Ğ°',         desc:'Ğ—Ñ–Ğ³Ñ€Ğ°Ğ¹ 1 Ğ³Ñ€Ñƒ',           check: d => (d.stats?.gamesPlayed||0) >= 1},
      {id:'games10',      icon:'ğŸ•¹ï¸', name:'Ğ“ĞµĞ¹Ğ¼ĞµÑ€',            desc:'10 Ñ–Ğ³Ğ¾Ñ€',                 check: d => (d.stats?.gamesPlayed||0) >= 10},
      {id:'games100',     icon:'ğŸ¯', name:'Ğ’ĞµÑ‚ĞµÑ€Ğ°Ğ½',           desc:'100 Ñ–Ğ³Ğ¾Ñ€',                check: d => (d.stats?.gamesPlayed||0) >= 100},
      {id:'games500',     icon:'ğŸ†', name:'Ğ›ĞµĞ³ĞµĞ½Ğ´Ğ°',           desc:'500 Ñ–Ğ³Ğ¾Ñ€',                check: d => (d.stats?.gamesPlayed||0) >= 500},
      {id:'win100',       icon:'ğŸ’µ', name:'ĞŸĞµÑ€ÑˆĞ¸Ğ¹ Ğ²Ğ¸Ğ³Ñ€Ğ°Ñˆ',     desc:'Ğ’Ğ¸Ğ³Ñ€Ğ°Ğ¹ 100â‚´',             check: d => (d.stats?.biggestWin||0) >= 100},
      {id:'win1000',      icon:'ğŸ’°', name:'Ğ£Ğ´Ğ°Ñ‡Ğ° Ğ¿Ğ¾ÑĞ¼Ñ–Ñ…Ğ½ÑƒĞ»Ğ°ÑÑŒ',desc:'Ğ’Ğ¸Ğ³Ñ€Ğ°Ğ¹ 1000â‚´ Ğ·Ğ° Ñ€Ğ°Ğ·',     check: d => (d.stats?.biggestWin||0) >= 1000},
      {id:'win10000',     icon:'ğŸ’', name:'Ğ’ĞµĞ»Ğ¸ĞºĞ¸Ğ¹ Ğ²Ğ¸Ğ³Ñ€Ğ°Ñˆ',    desc:'Ğ’Ğ¸Ğ³Ñ€Ğ°Ğ¹ 10000â‚´ Ğ·Ğ° Ñ€Ğ°Ğ·',    check: d => (d.stats?.biggestWin||0) >= 10000},
      {id:'win100000',    icon:'ğŸ‘‘', name:'Ğ”Ğ¶ĞµĞºĞ¿Ğ¾Ñ‚',           desc:'Ğ’Ğ¸Ğ³Ñ€Ğ°Ğ¹ 100000â‚´ Ğ·Ğ° Ñ€Ğ°Ğ·',   check: d => (d.stats?.biggestWin||0) >= 100000},
      {id:'balance10k',   icon:'ğŸ’³', name:'Ğ—Ğ°Ğ¼Ğ¾Ğ¶Ğ½Ğ¸Ğ¹',          desc:'Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ 10000â‚´',           check: d => (d.balance||0) >= 10000},
      {id:'balance100k',  icon:'ğŸ¤‘', name:'ĞœÑ–Ğ»ÑŒĞ¹Ğ¾Ğ½ĞµÑ€',         desc:'Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ 100000â‚´',          check: d => (d.balance||0) >= 100000},
      {id:'streak3',      icon:'ğŸ”¥', name:'Ğ¡ĞµÑ€Ñ–Ñ 3',           desc:'3 Ğ´Ğ½Ñ– Ğ¿Ğ¾ÑĞ¿Ñ–Ğ»ÑŒ',           check: d => (d.dailyStreak||0) >= 3},
      {id:'streak7',      icon:'âš¡', name:'Ğ¢Ğ¸Ğ¶Ğ½ĞµĞ²Ğ° ÑĞµÑ€Ñ–Ñ',     desc:'7 Ğ´Ğ½Ñ–Ğ² Ğ¿Ğ¾ÑĞ¿Ñ–Ğ»ÑŒ',          check: d => (d.dailyStreak||0) >= 7},
      {id:'streak30',     icon:'ğŸŒŸ', name:'ĞœÑ–ÑÑÑ‡Ğ½Ğ° ÑĞµÑ€Ñ–Ñ',     desc:'30 Ğ´Ğ½Ñ–Ğ² Ğ¿Ğ¾ÑĞ¿Ñ–Ğ»ÑŒ',         check: d => (d.dailyStreak||0) >= 30},
      {id:'ref1',         icon:'ğŸ‘¥', name:'Ğ ĞµĞºÑ€ÑƒÑ‚ĞµÑ€',          desc:'Ğ—Ğ°Ğ¿Ñ€Ğ¾ÑĞ¸ 1 Ğ´Ñ€ÑƒĞ³Ğ°',         check: d => (d.referrals||0) >= 1},
      {id:'ref5',         icon:'ğŸ«‚', name:'ĞĞ¼Ğ±Ğ°ÑĞ°Ğ´Ğ¾Ñ€',         desc:'Ğ—Ğ°Ğ¿Ñ€Ğ¾ÑĞ¸ 5 Ğ´Ñ€ÑƒĞ·Ñ–Ğ²',        check: d => (d.referrals||0) >= 5},
      {id:'duel1',        icon:'âš”ï¸', name:'Ğ”ÑƒĞµĞ»ÑĞ½Ñ‚',           desc:'Ğ’Ğ¸Ğ³Ñ€Ğ°Ğ¹ 1 Ğ´ÑƒĞµĞ»ÑŒ',          check: d => (d.stats?.duelsWon||0) >= 1},
      {id:'duel10',       icon:'ğŸ—¡ï¸', name:'Ğ“Ğ»Ğ°Ğ´Ñ–Ğ°Ñ‚Ğ¾Ñ€',         desc:'Ğ’Ğ¸Ğ³Ñ€Ğ°Ğ¹ 10 Ğ´ÑƒĞµĞ»ĞµĞ¹',        check: d => (d.stats?.duelsWon||0) >= 10},
      {id:'vault',        icon:'ğŸ¦', name:'Ğ‘Ğ°Ğ½ĞºÑ–Ñ€',            desc:'ĞŸĞ¾ĞºĞ»Ğ°Ğ´Ğ¸ Ğ² ÑĞºĞ°Ñ€Ğ±Ğ½Ğ¸Ñ†Ñ',     check: d => (d.vault?.balance||0) > 0},
      {id:'lottery_win',  icon:'ğŸ«', name:'Ğ©Ğ°ÑĞ»Ğ¸Ğ²Ñ‡Ğ¸Ğº',         desc:'Ğ’Ğ¸Ğ³Ñ€Ğ°Ğ¹ Ğ»Ğ¾Ñ‚ĞµÑ€ĞµÑ',          check: d => d.stats?.lotteryWins >= 1},
      {id:'shop',         icon:'ğŸ›ï¸', name:'ĞŸĞ¾ĞºÑƒĞ¿ĞµÑ†ÑŒ',          desc:'ĞšÑƒĞ¿Ğ¸ Ñ‰Ğ¾ÑÑŒ Ñƒ Ğ¼Ğ°Ğ³Ğ°Ğ·Ğ¸Ğ½Ñ–',    check: d => d.stats?.shopPurchases >= 1},
    ];

    function checkAchievements(winAmount=0) {
      if(!userData) return;
      const unlocked = userData.achievements || {};
      ACHIEVEMENTS.forEach(ach => {
        if(!unlocked[ach.id] && ach.check(userData)) {
          db.ref('users/'+currentUser+'/achievements/'+ach.id).set(Date.now());
          notify(`ğŸ… Ğ”Ğ¾ÑÑĞ³Ğ½ĞµĞ½Ğ½Ñ: "${ach.name}"!`, 'success');
        }
      });
    }

    function renderAchievements() {
      const list = document.getElementById('achievementsList');
      if(!list) return;
      const unlocked = userData.achievements || {};
      const unlockedCount = Object.keys(unlocked).length;
      document.getElementById('achUnlockedCount').textContent = unlockedCount;
      document.getElementById('achTotalCount').textContent = ACHIEVEMENTS.length;
      list.innerHTML = ACHIEVEMENTS.map(ach => {
        const isUnlocked = !!unlocked[ach.id];
        return `<div class="ach-item ${isUnlocked?'unlocked':''}" title="${ach.desc}">
          <div class="ach-icon ${isUnlocked?'':'ach-locked'}">${ach.icon}</div>
          <div class="ach-name">${ach.name}</div>
          ${isUnlocked ? '<div style="font-size:9px;color:var(--green);">âœ“ Ğ’Ğ¸ĞºĞ¾Ğ½Ğ°Ğ½Ğ¾</div>' : '<div style="font-size:9px;color:#333;">ğŸ”’ Ğ—Ğ°ĞºÑ€Ğ¸Ñ‚Ğ¾</div>'}
        </div>`;
      }).join('');
    }

    // ============================================
    // ĞœĞĞ“ĞĞ—Ğ˜Ğ
    // ============================================
    const SHOP_AVATARS = [
      {id:'av_cat',    icon:'ğŸ±', name:'ĞšÑ–Ñ‚',           price:500},
      {id:'av_lion',   icon:'ğŸ¦', name:'Ğ›ĞµĞ²',           price:1000},
      {id:'av_dragon', icon:'ğŸ²', name:'Ğ”Ñ€Ğ°ĞºĞ¾Ğ½',        price:2000},
      {id:'av_robot',  icon:'ğŸ¤–', name:'Ğ Ğ¾Ğ±Ğ¾Ñ‚',         price:1500},
      {id:'av_crown',  icon:'ğŸ‘‘', name:'ĞšĞ¾Ñ€Ğ¾Ğ½Ğ°',        price:5000},
      {id:'av_fire',   icon:'ğŸ”¥', name:'Ğ’Ğ¾Ğ³Ğ¾Ğ½ÑŒ',        price:3000},
      {id:'av_diamond',icon:'ğŸ’', name:'Ğ”Ñ–Ğ°Ğ¼Ğ°Ğ½Ñ‚',       price:10000},
      {id:'av_alien',  icon:'ğŸ‘½', name:'ĞŸÑ€Ğ¸Ğ±ÑƒĞ»ĞµÑ†ÑŒ',     price:2500},
    ];
    const SHOP_FRAMES = [
      {id:'fr_gold',   css:'border:3px solid #d4af37;box-shadow:0 0 10px #d4af37;', name:'Ğ—Ğ¾Ğ»Ğ¾Ñ‚Ğ°',   price:2000},
      {id:'fr_green',  css:'border:3px solid #4cd964;box-shadow:0 0 10px #4cd964;', name:'Ğ—ĞµĞ»ĞµĞ½Ğ°',   price:1000},
      {id:'fr_red',    css:'border:3px solid #ff3b30;box-shadow:0 0 10px #ff3b30;', name:'Ğ§ĞµÑ€Ğ²Ğ¾Ğ½Ğ°',  price:1000},
      {id:'fr_blue',   css:'border:3px solid #4a9eff;box-shadow:0 0 10px #4a9eff;', name:'Ğ¡Ğ¸Ğ½Ñ',     price:1500},
      {id:'fr_rainbow',css:'border:3px solid transparent;background:linear-gradient(#000,#000) padding-box,linear-gradient(45deg,red,orange,yellow,green,blue,purple) border-box;', name:'Ğ’ĞµÑĞµĞ»ĞºĞ°', price:8000},
    ];

    function renderShop() {
      const avGrid = document.getElementById('shopAvatars');
      const frGrid = document.getElementById('shopFrames');
      if(!avGrid) return;
      const owned = userData.shopOwned || {};
      const equipped = userData.shopEquipped || {};

      avGrid.innerHTML = SHOP_AVATARS.map(item => {
        const isOwned = !!owned[item.id];
        const isEquipped = equipped.avatar === item.id;
        return `<div class="shop-item ${isOwned?'owned':''} ${isEquipped?'equipped':''}" onclick="shopAction('avatar','${item.id}',${item.price},'${item.icon}')">
          <span class="shop-preview">${item.icon}</span>
          <div class="shop-name">${item.name}</div>
          <div class="shop-price">${isEquipped?'âœ… Ğ’Ğ´ÑĞ³Ğ½ĞµĞ½Ğ¾':isOwned?'Ğ’Ğ´ÑĞ³Ğ½ÑƒÑ‚Ğ¸':'ğŸ’° '+item.price+'â‚´'}</div>
        </div>`;
      }).join('');

      frGrid.innerHTML = SHOP_FRAMES.map(item => {
        const isOwned = !!owned[item.id];
        const isEquipped = equipped.frame === item.id;
        return `<div class="shop-item ${isOwned?'owned':''} ${isEquipped?'equipped':''}" onclick="shopAction('frame','${item.id}',${item.price},'')">
          <span class="shop-preview" style="${isOwned?item.css:''}">ğŸ‘¤</span>
          <div class="shop-name">${item.name}</div>
          <div class="shop-price">${isEquipped?'âœ… Ğ’Ğ´ÑĞ³Ğ½ĞµĞ½Ğ¾':isOwned?'Ğ’Ğ´ÑĞ³Ğ½ÑƒÑ‚Ğ¸':'ğŸ’° '+item.price+'â‚´'}</div>
        </div>`;
      }).join('');
    }

    function shopAction(type, id, price, icon) {
      const owned = userData.shopOwned || {};
      const equipped = userData.shopEquipped || {};
      if(owned[id]) {
        // Ğ’Ğ´ÑĞ³Ğ½ÑƒÑ‚Ğ¸
        const updates = {};
        updates[`shopEquipped/${type}`] = id;
        if(type === 'avatar' && icon) updates['avatar'] = icon;
        db.ref('users/'+currentUser).update(updates);
        notify(`âœ… Ğ’Ğ´ÑĞ³Ğ½ĞµĞ½Ğ¾!`, 'success');
      } else {
        if(userData.balance < price) return notify('ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ½ÑŒĞ¾ ĞºĞ¾ÑˆÑ‚Ñ–Ğ²', 'error');
        db.ref('users/'+currentUser).update({
          balance: userData.balance - price,
          [`shopOwned/${id}`]: true,
          [`shopEquipped/${type}`]: id,
          'stats/shopPurchases': firebase.database.ServerValue.increment(1)
        });
        if(type === 'avatar' && icon) db.ref('users/'+currentUser+'/avatar').set(icon);
        notify(`ğŸ›ï¸ ĞšÑƒĞ¿Ğ»ĞµĞ½Ğ¾! -${price}â‚´`, 'success');
        addToHistory(`Shop: -${price}â‚´ (${id})`);
        checkAchievements();
      }
    }

    // ============================================
    // Ğ‘ĞĞšĞšĞĞ Ğ
    // ============================================
    let baccBet = null;

    function selectBaccBet(type, el) {
      document.querySelectorAll('.bacc-bet-grid .bet-btn').forEach(b=>b.classList.remove('selected'));
      el.classList.add('selected');
      baccBet = type;
    }

    function baccCard() {
      const ranks = ['A','2','3','4','5','6','7','8','9','10','J','Q','K'];
      const suits = ['â™ ','â™¥','â™¦','â™£'];
      return {r: ranks[Math.floor(Math.random()*13)], s: suits[Math.floor(Math.random()*4)]};
    }

    function baccValue(hand) {
      let v = 0;
      hand.forEach(c => {
        if(['J','Q','K'].includes(c.r)) v += 0;
        else if(c.r === 'A') v += 1;
        else v += parseInt(c.r);
      });
      return v % 10;
    }

    function baccCardHTML(c) {
      const red = c.s==='â™¥'||c.s==='â™¦';
      return `<div class="bj-card ${red?'red':''}">${c.r}<br><span style="font-size:14px;">${c.s}</span></div>`;
    }

    function playBaccarat() {
      if(!baccBet) return notify('ĞĞ±ĞµÑ€Ñ–Ñ‚ÑŒ ÑÑ‚Ğ°Ğ²ĞºÑƒ', 'error');
      const b = validateBet(document.getElementById('betAmountBacc').value);
      if(!b) return;
      db.ref('users/'+currentUser).update({balance: userData.balance - b});

      const pHand = [baccCard(), baccCard()];
      const bHand = [baccCard(), baccCard()];
      let pScore = baccValue(pHand);
      let bScore = baccValue(bHand);

      // Ğ¢Ñ€ĞµÑ‚Ğµ Ñ€Ğ¾Ğ·Ğ´Ğ°Ğ²Ğ°Ğ½Ğ½Ñ Ğ·Ğ° Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ°Ğ¼Ğ¸ Ğ±Ğ°ĞºĞºĞ°Ñ€Ğ¸
      if(pScore <= 5) pHand.push(baccCard());
      if(bScore <= 5) bHand.push(baccCard());
      pScore = baccValue(pHand); bScore = baccValue(bHand);

      document.getElementById('baccPlayerCards').innerHTML = pHand.map(baccCardHTML).join('');
      document.getElementById('baccBankerCards').innerHTML = bHand.map(baccCardHTML).join('');
      document.getElementById('baccPlayerScore').textContent = pScore;
      document.getElementById('baccBankerScore').textContent = bScore;

      let win = 0, resultMsg = '';
      const isTie = pScore === bScore;
      const playerWins = pScore > bScore;

      if(baccBet === 'player' && playerWins && !isTie) { win = b * 2; resultMsg = 'ğŸ´ Ğ“Ñ€Ğ°Ğ²ĞµÑ†ÑŒ Ğ²Ğ¸Ğ³Ñ€Ğ°Ğ²!'; }
      else if(baccBet === 'banker' && !playerWins && !isTie) { win = Math.floor(b * 1.95); resultMsg = 'ğŸ¦ Ğ‘Ğ°Ğ½ĞºÑ–Ñ€ Ğ²Ğ¸Ğ³Ñ€Ğ°Ğ²!'; }
      else if(baccBet === 'tie' && isTie) { win = b * 9; resultMsg = 'ğŸ¤ ĞÑ–Ñ‡Ğ¸Ñ!'; }
      else { resultMsg = isTie ? 'ğŸ¤ ĞÑ–Ñ‡Ğ¸Ñ (ÑÑ‚Ğ°Ğ²ĞºĞ° Ğ¿Ğ¾Ğ²ĞµÑ€Ğ½ÑƒÑ‚Ğ°)' : (playerWins ? 'ğŸ´ Ğ“Ñ€Ğ°Ğ²ĞµÑ†ÑŒ' : 'ğŸ¦ Ğ‘Ğ°Ğ½ĞºÑ–Ñ€') + ' â€” Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ñˆ'; }

      if(isTie && baccBet !== 'tie') win = b; // ĞŸĞ¾Ğ²ĞµÑ€Ğ½ĞµĞ½Ğ½Ñ ÑÑ‚Ğ°Ğ²ĞºĞ¸ Ğ¿Ñ€Ğ¸ Ğ½Ñ–Ñ‡Ğ¸Ñ—

      document.getElementById('baccResult').innerHTML = `<span style="color:${win>=b?'var(--green)':'var(--red)'}">${resultMsg}</span>`;
      if(win > 0) {
        db.ref('users/'+currentUser+'/balance').set(firebase.database.ServerValue.increment(win));
        playSound('win'); notifyWin(`ğŸ´ ${resultMsg}: +${win-b}â‚´`, win, b);
        addToHistory(`Baccarat: +${win-b}`);
      } else { addToHistory(`Baccarat: -${b}`); }
      trackGame(win > b, win, b);
    }

    // ============================================
    // Ğ¡Ğ†Ğš-Ğ‘Ğ
    // ============================================
    let sicBoBet = null;
    const DICE_FACES = ['âš€','âš','âš‚','âšƒ','âš„','âš…'];

    function selectSicBo(type, el) {
      document.querySelectorAll('.sic-bo-btn').forEach(b=>b.classList.remove('selected'));
      el.classList.add('selected');
      sicBoBet = type;
    }

    function rollSicBo() {
      if(!sicBoBet) return notify('ĞĞ±ĞµÑ€Ñ–Ñ‚ÑŒ ÑÑ‚Ğ°Ğ²ĞºÑƒ', 'error');
      const b = validateBet(document.getElementById('betAmountSicBo').value);
      if(!b) return;
      db.ref('users/'+currentUser).update({balance: userData.balance - b});

      const dice = [document.getElementById('die1'),document.getElementById('die2'),document.getElementById('die3')];
      dice.forEach(d => d.classList.add('rolling'));

      let rolls = 0;
      const rollInt = setInterval(() => {
        dice.forEach(d => d.textContent = DICE_FACES[Math.floor(Math.random()*6)]);
        if(++rolls >= 15) {
          clearInterval(rollInt);
          dice.forEach(d => d.classList.remove('rolling'));
          const vals = dice.map(d => DICE_FACES.indexOf(d.textContent)+1);
          const sum = vals.reduce((a,c) => a+c, 0);
          const isTriple = vals[0]===vals[1] && vals[1]===vals[2];
          const isPair = !isTriple && (vals[0]===vals[1] || vals[1]===vals[2] || vals[0]===vals[2]);
          const isEven = sum % 2 === 0;

          let win = 0, won = false;
          if(sicBoBet==='small' && sum>=4 && sum<=10 && !isTriple) { won=true; }
          else if(sicBoBet==='big' && sum>=11 && sum<=17 && !isTriple) { won=true; }
          else if(sicBoBet==='triple' && isTriple) { won=true; win = b * 30; }
          else if(sicBoBet==='even' && isEven && !isTriple) { won=true; }
          else if(sicBoBet==='odd' && !isEven && !isTriple) { won=true; }
          else if(sicBoBet==='pair' && isPair) { won=true; win = b * 8; }

          if(won && win === 0) win = b * 2;
          const msg = `Ğ¡ÑƒĞ¼Ğ°: ${sum} ${isTriple?'(Ğ¢Ñ€Ğ¸Ğ¿Ğ»ÑŒ!)':isPair?'(ĞŸĞ°Ñ€Ğ°)':''}`;
          document.getElementById('sicboResult').innerHTML = `<span style="color:${won?'var(--green)':'var(--red)'}">${msg} â†’ ${won?'+'+win+'â‚´':'ĞŸÑ€Ğ¾Ğ³Ñ€Ğ°Ñˆ'}</span>`;
          if(won) {
            db.ref('users/'+currentUser+'/balance').set(firebase.database.ServerValue.increment(win));
            playSound('win'); notifyWin(`ğŸ² ${msg}: +${win}â‚´`, win, b);
            addToHistory(`SicBo: +${win}`);
          } else { addToHistory(`SicBo: -${b}`); }
          trackGame(won, win, b);
        }
      }, 80);
    }

    // ============================================
    // Ğ¡ĞšĞĞ Ğ‘ĞĞ˜Ğ¦Ğ¯ (5% Ğ½Ğ° Ğ´Ğ¾Ğ±Ñƒ)
    // ============================================
    function depositVault() {
      const amount = parseInt(document.getElementById('vaultDeposit').value);
      if(!amount || amount < 1) return notify('Ğ’Ğ²ĞµĞ´Ñ–Ñ‚ÑŒ ÑÑƒĞ¼Ñƒ', 'error');
      if(userData.balance < amount) return notify('ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ½ÑŒĞ¾ ĞºĞ¾ÑˆÑ‚Ñ–Ğ²', 'error');
      const newVaultBal = (userData.vault?.balance||0) + amount;
      db.ref('users/'+currentUser).update({
        balance: userData.balance - amount,
        'vault/balance': newVaultBal,
        'vault/lastUpdate': Date.now()
      });
      notify(`ğŸ¦ ĞŸĞ¾ĞºĞ»Ğ°Ğ´ĞµĞ½Ğ¾ ${amount}â‚´ Ñƒ ÑĞºĞ°Ñ€Ğ±Ğ½Ğ¸Ñ†Ñ`, 'success');
      addToHistory(`Vault deposit: -${amount}`);
      document.getElementById('vaultDeposit').value = '';
    }

    function withdrawVault() {
      const amount = parseInt(document.getElementById('vaultWithdraw').value);
      const vaultBal = userData.vault?.balance || 0;
      if(!amount || amount > vaultBal) return notify('ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ½ÑŒĞ¾ Ñƒ ÑĞºĞ°Ñ€Ğ±Ğ½Ğ¸Ñ†Ñ–', 'error');
      accrueVaultInterest();
      const newVaultBal = vaultBal - amount;
      db.ref('users/'+currentUser).update({
        balance: userData.balance + amount,
        'vault/balance': newVaultBal
      });
      notify(`ğŸ’¸ Ğ’Ğ¸Ğ²ĞµĞ´ĞµĞ½Ğ¾ ${amount}â‚´ Ğ·Ñ– ÑĞºĞ°Ñ€Ğ±Ğ½Ğ¸Ñ†Ñ–`, 'success');
      addToHistory(`Vault withdraw: +${amount}`);
      document.getElementById('vaultWithdraw').value = '';
    }

    function accrueVaultInterest() {
      const vault = userData.vault;
      if(!vault || !vault.balance || vault.balance <= 0) return;
      const lastUpdate = vault.lastUpdate || Date.now();
      const days = (Date.now() - lastUpdate) / (24*60*60*1000);
      if(days < 0.01) return;
      const interest = Math.floor(vault.balance * 0.05 * days);
      if(interest > 0) {
        db.ref('users/'+currentUser).update({
          'vault/balance': vault.balance + interest,
          'vault/lastUpdate': Date.now()
        });
        notify(`ğŸ¦ ĞĞ°Ñ€Ğ°Ñ…Ğ¾Ğ²Ğ°Ğ½Ğ¾ ${interest}â‚´ Ğ²Ñ–Ğ´ÑĞ¾Ñ‚ĞºÑ–Ğ²`, 'success');
      }
    }

    function renderVault() {
      const vault = userData.vault;
      const bal = vault?.balance || 0;
      document.getElementById('vaultBalance').textContent = bal.toLocaleString();
      if(bal > 0 && vault?.lastUpdate) {
        const days = (Date.now() - vault.lastUpdate) / (24*60*60*1000);
        const pending = Math.floor(bal * 0.05 * days);
        document.getElementById('vaultAccrued').textContent = pending > 0 ? `+${pending}â‚´ Ğ½Ğ°Ñ€Ğ°Ñ…Ğ¾Ğ²Ğ°Ğ½Ğ¾ (Ñ‰Ğµ Ğ½Ğµ Ğ·Ğ°Ñ€Ğ°Ñ…Ğ¾Ğ²Ğ°Ğ½Ğ¾)` : '';
      }
    }

    // ============================================
    // Ğ›ĞĞ¢Ğ•Ğ Ğ•Ğ¯
    // ============================================
    function initLottery() {
      db.ref('lottery/prize').once('value', snap => {
        document.getElementById('lotteryPrize').textContent = (snap.val()||0).toLocaleString() + ' â‚´';
      });
      document.getElementById('myTicketCount').textContent = userData.lottery?.tickets || 0;
      db.ref('lottery/winners').limitToLast(5).once('value', snap => {
        const data = snap.val();
        const el = document.getElementById('lotteryWinners');
        if(!data) { el.innerHTML = 'Ğ©Ğµ Ğ½ĞµĞ¼Ğ°Ñ” Ğ¿ĞµÑ€ĞµĞ¼Ğ¾Ğ¶Ñ†Ñ–Ğ²'; return; }
        el.innerHTML = Object.values(data).reverse().map(w =>
          `<div class="contact-row"><span>ğŸ† ${w.user}</span><span style="color:var(--accent);font-weight:bold;">+${w.amount}â‚´</span></div>`
        ).join('');
      });
    }

    function buyTickets() {
      const count = parseInt(document.getElementById('ticketCount').value) || 1;
      const cost = count * 100;
      if(userData.balance < cost) return notify('ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ½ÑŒĞ¾ ĞºĞ¾ÑˆÑ‚Ñ–Ğ²', 'error');
      db.ref('users/'+currentUser).update({
        balance: userData.balance - cost,
        'lottery/tickets': firebase.database.ServerValue.increment(count)
      });
      db.ref('lottery/prize').set(firebase.database.ServerValue.increment(Math.floor(cost*0.1)));
      notify(`ğŸ« ĞšÑƒĞ¿Ğ»ĞµĞ½Ğ¾ ${count} ĞºĞ²Ğ¸Ñ‚Ğ¾Ğº(Ñ–Ğ²) Ğ·Ğ° ${cost}â‚´!`, 'success');
      addToHistory(`Lottery tickets: -${cost}`);
      document.getElementById('myTicketCount').textContent = (userData.lottery?.tickets||0) + count;
    }

    // ============================================
    // Ğ“Ğ ĞĞ¤Ğ†Ğš Ğ‘ĞĞ›ĞĞĞ¡Ğ£
    // ============================================
    function renderBalanceChart() {
      const canvas = document.getElementById('balanceChart');
      if(!canvas) return;
      db.ref('users/'+currentUser+'/balanceHistory').limitToLast(30).once('value', snap => {
        const data = snap.val();
        if(!data) return;
        const points = Object.values(data);
        const ctx = canvas.getContext('2d');
        const w = canvas.width = canvas.offsetWidth || 300;
        const h = canvas.height = canvas.offsetHeight || 160;
        const vals = points.map(p => p.bal);
        const min = Math.min(...vals), max = Math.max(...vals);
        const range = max - min || 1;

        ctx.clearRect(0,0,w,h);
        ctx.strokeStyle = '#d4af37'; ctx.lineWidth = 2;
        ctx.beginPath();
        points.forEach((p, i) => {
          const x = (i/(points.length-1||1)) * (w-20) + 10;
          const y = h - ((p.bal - min)/range) * (h-20) - 10;
          i===0 ? ctx.moveTo(x,y) : ctx.lineTo(x,y);
        });
        ctx.stroke();

        // Fill
        ctx.lineTo(w-10, h-10); ctx.lineTo(10, h-10); ctx.closePath();
        ctx.fillStyle = 'rgba(212,175,55,0.1)'; ctx.fill();

        document.getElementById('statMaxBal').textContent = formatNumber(max)+'â‚´';
        document.getElementById('statMinBal').textContent = formatNumber(min)+'â‚´';
        document.getElementById('statGamesCount').textContent = userData.stats?.gamesPlayed||0;
        document.getElementById('statBigWin').textContent = formatNumber(userData.stats?.biggestWin||0)+'â‚´';
      });
    }

    function openStatsModal() {
      openModal('stats-modal');
      setTimeout(renderBalanceChart, 100);
    }

    // ============================================
    // ĞĞĞĞ’Ğ›Ğ•ĞĞ˜Ğ™ switchTab
    // ============================================
    function switchTab(id, el) {
      document.querySelectorAll('.screen').forEach(s=>s.classList.add('hidden'));
      const tab = document.getElementById('tab-'+id);
      if(tab) tab.classList.remove('hidden');
      // ĞœĞ¾Ğ±Ğ°Ğ¹Ğ» nav
      if(el && el.classList.contains('nav-item')) {
        document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
        el.classList.add('active');
      }
      // Sidebar nav
      document.querySelectorAll('.sidebar-item').forEach(n=>n.classList.remove('active'));
      if(el && el.classList.contains('sidebar-item')) el.classList.add('active');

      if(id==='chat') initLobbyChat();
      if(id==='keno') initKeno();
      if(id==='fortune') setTimeout(()=>drawFortuneWheel(0), 50);
      if(id==='duels') loadDuels();
      if(id==='tournaments') loadTournaments();
      if(id==='referrals') initReferrals();
      if(id==='admin') loadAdminStats();
      if(id==='achievements') { checkAchievements(); renderAchievements(); }
      if(id==='shop') renderShop();
      if(id==='vault') { accrueVaultInterest(); renderVault(); }
      if(id==='lottery') initLottery();
      if(id==='profile') {
        // Ğ”Ğ¾Ğ´Ğ°Ñ‚Ğ¸ ĞºĞ½Ğ¾Ğ¿ĞºÑƒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸
        const box = document.querySelector('#tab-profile .box');
        if(box && !document.getElementById('statsBtn')) {
          const btn = document.createElement('button');
          btn.id = 'statsBtn'; btn.className = 'btn-outline';
          btn.textContent = 'ğŸ“Š Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°';
          btn.onclick = openStatsModal;
          btn.style.marginTop = '8px';
          box.appendChild(btn);
        }
      }
    }

    function openGame(g) { switchTab(g); }
  </script>
</body></html>
