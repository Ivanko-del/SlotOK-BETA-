<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>SlotOK MEGA UPDATE</title>
  
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <style>
    :root { --bg: #050505; --text: #fff; --box: #141414; --border: #333; --accent: #d4af37; --input: #1a1a1a; }
    body { font-family: sans-serif; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 90px; user-select: none; overflow-x: hidden; }
    .header { padding: 15px; background: var(--bg); border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 900; display:flex; justify-content:space-between; align-items:center; }
    .header h1 { margin: 0; font-size: 24px; color: var(--accent); font-weight: 900; font-style: italic; }
    .header-bal { font-size: 16px; background: #222; padding: 5px 15px; border-radius: 20px; border: 1px solid #444; font-weight:bold; color: #4cd964; }
    .container { padding: 15px; } 
    .hidden { display: none !important; }
    .box { background: var(--box); border-radius: 12px; padding: 15px; border: 1px solid var(--border); margin-bottom: 15px; }
    button { padding: 14px; width: 100%; border: none; border-radius: 10px; font-weight: bold; font-size: 15px; cursor: pointer; background: #333; color: #fff; margin-bottom: 8px; transition: 0.2s; }
    button:active { transform: scale(0.98); }
    .btn-gold { background: linear-gradient(45deg, var(--accent), #ffdb4d); color: #000; } 
    .btn-red { background: #ff3b30; color: #fff; } 
    .btn-green { background: #4cd964; color: #000; } 
    .btn-outline { background: transparent; border: 1px solid #555; color: #ccc; }
    input { width: 100%; padding: 14px; margin-bottom: 12px; background: var(--input); border: 1px solid var(--border); color: #fff; border-radius: 10px; font-size: 16px; box-sizing: border-box; text-align: center; } 

    /* GAMES GRID */
    .game-card { background: var(--box); border: 1px solid var(--border); border-radius: 12px; padding: 15px; margin-bottom: 10px; display:flex; align-items:center; gap:15px; cursor: pointer; }
    .game-icon { font-size: 30px; }
    
    /* DICE */
    .dice-res { font-size: 40px; font-weight: bold; margin: 10px 0; text-align: center; color: var(--accent); }
    
    /* TOWER */
    .tower-grid { display: grid; grid-template-rows: repeat(10, 1fr); gap: 5px; margin-bottom: 15px; }
    .tower-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; opacity: 0.5; pointer-events: none; }
    .tower-row.active { opacity: 1; pointer-events: auto; }
    .tower-cell { background: #222; height: 35px; border-radius: 4px; display: flex; align-items: center; justify-content: center; cursor: pointer; border: 1px solid #333; }
    .tower-cell.win { background: #4cd964; } .tower-cell.lose { background: #ff3b30; }

    /* DOUBLE */
    .double-timer { text-align: center; font-size: 18px; color: var(--accent); margin-bottom: 10px; }
    .double-history { display: flex; gap: 5px; overflow-x: auto; margin-bottom: 10px; }
    .hist-dot { width: 20px; height: 20px; border-radius: 50%; flex-shrink: 0; }

    /* CHAT */
    #chatBox { height: 250px; overflow-y: auto; background: #0a0a0a; border: 1px solid #222; border-radius: 10px; padding: 10px; margin-bottom: 10px; }
    .chat-msg { margin-bottom: 8px; font-size: 13px; line-height: 1.4; }
    .chat-name { color: var(--accent); font-weight: bold; margin-right: 5px; }

    /* NAV */
    .bottom-nav { position: fixed; bottom: 0; width: 100%; height: 70px; background: #080808; border-top: 1px solid #222; display: flex; justify-content: space-around; align-items: center; z-index: 1000; } 
    .nav-item { display: flex; flex-direction: column; align-items: center; color: #555; font-size: 10px; cursor: pointer; width: 14%; } 
    .nav-item.active { color: var(--accent); } .nav-item span.icon { font-size: 20px; }

    #loading-overlay { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; }
    .full-modal { position: fixed; inset: 0; background: #000; z-index: 5000; padding: 20px; overflow-y: auto; }
  </style>
</head>
<body>

  <div id="loading-overlay">
    <div style="font-size:50px; margin-bottom:10px;">üíé</div>
    <div style="color:var(--accent); letter-spacing: 5px; font-weight: bold;">SLOTOK MEGA</div>
  </div>

  <div id="toast-container"></div>

  <div class="header">
    <h1>SLOT<span>OK</span></h1>
    <div class="header-bal"><span class="bal">0</span> ‚Ç¥</div>
  </div>

  <div class="container">
    
    <div id="tab-home" class="screen">
        <div class="box" style="text-align: center; background: linear-gradient(135deg, #1a1a1a, #000);">
            <div id="userLevelName" style="color:var(--accent); font-weight:bold;">–ù–û–í–ê–ß–û–ö</div>
            <div style="font-size: 12px; color: #777;">–í–∞—à –ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞—Ç—É—Å</div>
        </div>
        <div id="tab-lobby-main">
            <div class="game-card" onclick="openGame('dice')"><span class="game-icon">üé≤</span><div><div class="game-title">Dice</div><div class="game-desc">–í–≥–∞–¥–∞–π —á–∏—Å–ª–æ</div></div></div>
            <div class="game-card" onclick="openGame('tower')"><span class="game-icon">üè∞</span><div><div class="game-title">Tower</div><div class="game-desc">–ü—ñ–¥–∫–æ—Ä–∏ –≤–µ–∂—É</div></div></div>
            <div class="game-card" onclick="openGame('double')"><span class="game-icon">üî¥</span><div><div class="game-title">Double</div><div class="game-desc">–°–ø—ñ–ª—å–Ω–∞ –≥—Ä–∞ –∫–æ–∂–Ω—ñ 15—Å</div></div></div>
            <div class="game-card" onclick="openGame('slots')"><span class="game-icon">üé∞</span><div><div class="game-title">Slots</div><div class="game-desc">–ö–ª–∞—Å–∏–∫–∞ 777</div></div></div>
            <div class="game-card" onclick="openGame('mines')"><span class="game-icon">üí£</span><div><div class="game-title">Mines</div><div class="game-desc">–°–∞–ø–µ—Ä</div></div></div>
        </div>
    </div>

    <div id="tab-dice" class="screen hidden">
        <button class="btn-outline" onclick="switchTab('home')">‚¨Ö –ù–∞–∑–∞–¥</button>
        <div class="box">
            <div class="dice-res" id="diceRes">0.00</div>
            <div style="text-align:center; color:#777; margin-bottom:10px;">–®–∞–Ω—Å: <span id="diceChanceVal">50</span>%</div>
            <input type="range" id="diceChance" min="1" max="95" value="50" style="width:100%;" oninput="document.getElementById('diceChanceVal').innerText=this.value">
            <input id="betAmountDice" type="number" value="100">
            <button class="btn-gold" onclick="playDice()">–ì–†–ê–¢–ò</button>
        </div>
    </div>

    <div id="tab-tower" class="screen hidden">
        <button class="btn-outline" onclick="switchTab('home')">‚¨Ö –ù–∞–∑–∞–¥</button>
        <div class="tower-grid" id="towerGrid"></div>
        <div class="box">
            <input id="betAmountTower" type="number" value="100">
            <button class="btn-gold" id="towerStartBtn" onclick="startTower()">–°–¢–ê–†–¢</button>
            <button class="btn-green hidden" id="towerCashoutBtn" onclick="cashoutTower()">–ó–ê–ë–†–ê–¢–ò</button>
        </div>
    </div>

    <div id="tab-double" class="screen hidden">
        <button class="btn-outline" onclick="switchTab('home')">‚¨Ö –ù–∞–∑–∞–¥</button>
        <div class="box">
            <div class="double-timer" id="doubleTimer">–û—á—ñ–∫—É–≤–∞–Ω–Ω—è...</div>
            <div class="double-history" id="doubleHistory"></div>
            <div class="bet-grid" style="display:flex; gap:5px; margin-bottom:10px;">
                <button class="btn-red" style="margin:0;" onclick="betDouble('red')">x2</button>
                <button class="btn-green" style="margin:0;" onclick="betDouble('green')">x14</button>
                <button class="btn-outline" style="margin:0; background:#222;" onclick="betDouble('black')">x2</button>
            </div>
            <input id="betAmountDouble" type="number" value="100" placeholder="–°—Ç–∞–≤–∫–∞">
            <div id="myDoubleBet" style="text-align:center; font-size:12px; color:#777;"></div>
        </div>
    </div>

    <div id="tab-slots" class="screen hidden"><button class="btn-outline" onclick="switchTab('home')">‚¨Ö –ù–∞–∑–∞–¥</button><div class="box" style="display:flex; justify-content:center; gap:10px; font-size:40px;"><span id="rs1">‚ùì</span><span id="rs2">‚ùì</span><span id="rs3">‚ùì</span></div><input id="betAmountSlots" type="number" value="100"><button class="btn-gold" onclick="playSlots()">–ö–†–£–¢–ò–¢–ò</button></div>
    
    <div id="tab-mines" class="screen hidden"><button class="btn-outline" onclick="switchTab('home')">‚¨Ö –ù–∞–∑–∞–¥</button><div id="minesGridUI" style="display:grid; grid-template-columns:repeat(5,1fr); gap:5px; margin-bottom:10px;"></div><input id="betAmountMines" type="number" value="100"><button class="btn-gold" id="minesStartBtn" onclick="startMines()">–°–¢–ê–†–¢</button><button class="btn-green hidden" id="minesCashBtn" onclick="cashoutMines()">–ó–ê–ë–†–ê–¢–ò</button></div>

    <div id="tab-chat" class="screen hidden">
        <div class="box">
            <div id="chatBox"></div>
            <div style="display:flex; gap:5px;">
                <input id="chatMsg" placeholder="–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è..." style="margin:0;">
                <button class="btn-gold" style="width:60px; margin:0;" onclick="sendChat()">‚û§</button>
            </div>
        </div>
    </div>

    <div id="tab-top" class="screen hidden"><div class="box"><h3>–¢–û–ü –ì–†–ê–í–¶–Ü–í</h3><table id="topTable" style="width:100%;"></table></div></div>
    
    <div id="tab-profile" class="screen hidden">
        <div class="box" style="text-align:center;">
            <div id="profAv" style="font-size:50px;">üë§</div>
            <h2 id="profName">...</h2>
            <div id="profLevel" style="color:var(--accent);">–°—Ç–∞—Ç—É—Å: ...</div>
            <div style="color:#777; margin:10px 0;">ID: <span id="profId"></span></div>
            <button class="btn-outline" onclick="openModal('promo-modal')">üéÅ –ê–∫—Ç–∏–≤—É–≤–∞—Ç–∏ –ü—Ä–æ–º–æ–∫–æ–¥</button>
            <button class="btn-red" onclick="logout()">–í–ò–ô–¢–ò</button>
        </div>
        <div id="admBtn" class="box hidden" style="border-color:red;"><button class="btn-red" onclick="switchTab('admin')">–ê–î–ú–Ü–ù –ü–ê–ù–ï–õ–¨</button></div>
    </div>

    <div id="tab-admin" class="screen hidden">
        <button class="btn-outline" onclick="switchTab('profile')">‚¨Ö –ù–∞–∑–∞–¥</button>
        <div class="box">
            <h3>–°—Ç–≤–æ—Ä–∏—Ç–∏ –ü—Ä–æ–º–æ–∫–æ–¥</h3>
            <input id="admPromoName" placeholder="–ù–∞–∑–≤–∞ (–Ω–∞–ø—Ä. –ì–†–û–®–Ü)">
            <input id="admPromoSum" type="number" placeholder="–°—É–º–∞">
            <input id="admPromoLimit" type="number" placeholder="–õ—ñ–º—ñ—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—å">
            <button class="btn-green" onclick="createPromo()">–°–¢–í–û–†–ò–¢–ò</button>
        </div>
        <div class="box">
            <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è –ì—Ä–∞–≤—Ü—è–º–∏</h3>
            <div id="admUserList"></div>
        </div>
    </div>

  </div>

  <div id="auth-screen" class="full-modal">
    <div style="text-align:center; margin: 40px 0;"><h1 style="color:var(--accent); font-size:40px;">SLOTOK</h1></div>
    <div id="loginForm"><input id="lName" placeholder="–ù—ñ–∫–Ω–µ–π–º"><input id="lPass" type="password" placeholder="–ü–∞—Ä–æ–ª—å"><button class="btn-gold" onclick="login()">–£–í–Ü–ô–¢–ò</button><p onclick="toggleAuth(true)" style="text-align:center; color:#777;">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</p></div>
    <div id="regForm" class="hidden"><input id="rName" placeholder="–ù—ñ–∫–Ω–µ–π–º"><input id="rPass" type="password" placeholder="–ü–∞—Ä–æ–ª—å"><button class="btn-green" onclick="register()">–°–¢–í–û–†–ò–¢–ò</button><p onclick="toggleAuth(false)" style="text-align:center; color:#777;">–í–∂–µ —î –∞–∫–∞—É–Ω—Ç?</p></div>
  </div>

  <div id="promo-modal" class="full-modal hidden">
      <button class="btn-outline" onclick="closeModal('promo-modal')" style="width:50px;">‚¨Ö</button>
      <h2>–ü—Ä–æ–º–æ–∫–æ–¥</h2>
      <input id="promoInput" placeholder="–í–≤–µ–¥—ñ—Ç—å –∫–æ–¥">
      <button class="btn-gold" onclick="usePromo()">–ê–ö–¢–ò–í–£–í–ê–¢–ò</button>
  </div>

  <nav class="bottom-nav">
    <div class="nav-item active" onclick="switchTab('home',this)"><span class="icon">üè†</span><span>–î—ñ–º</span></div>
    <div class="nav-item" onclick="switchTab('chat',this)"><span class="icon">üí¨</span><span>–ß–∞—Ç</span></div>
    <div class="nav-item" onclick="switchTab('top',this)"><span class="icon">üèÜ</span><span>–¢–æ–ø</span></div>
    <div class="nav-item" onclick="switchTab('profile',this)"><span class="icon">üë§</span><span>–ü—Ä–æ—Ñ—ñ–ª—å</span></div>
  </nav>

  <script>
    const firebaseConfig = { apiKey: "AIzaSyB0gJDyr8z2SWPV3Tf73ZRNNPuglxHTCZw", authDomain: "slotok-web-server.firebaseapp.com", databaseURL: "https://slotok-web-server-default-rtdb.firebaseio.com", projectId: "slotok-web-server", storageBucket: "slotok-web-server.firebasestorage.app", messagingSenderId: "1086314476940", appId: "1:1086314476940:web:d3629d2d0fe16f7c1f12a9" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let user = null; let uData = {};
    setTimeout(() => { document.getElementById('loading-overlay').classList.add('hidden'); }, 1500);

    const saved = localStorage.getItem("slotok_user");
    if(saved) { user = saved; initApp(); }

    function initApp() {
        db.ref('users/'+user).on('value', s => {
            uData = s.val(); if(!uData) return logout();
            document.querySelectorAll('.bal').forEach(e => e.textContent = Math.floor(uData.balance));
            document.getElementById('auth-screen').classList.add('hidden');
            document.getElementById('profName').textContent = user;
            document.getElementById('profId').textContent = uData.id;
            updateLevel();
            if(user.toLowerCase()==='theivankoo' || uData.isAdmin) document.getElementById('admBtn').classList.remove('hidden');
        });
        loadChat();
        loadTop();
        startDoubleLoop();
    }

    function updateLevel() {
        let lvl = "–ù–æ–≤–∞—á–æ–∫";
        if(uData.balance > 1000000) lvl = "–ú–ê–ì–ù–ê–¢";
        else if(uData.balance > 100000) lvl = "VIP –ì–†–ê–í–ï–¶–¨";
        else if(uData.balance > 10000) lvl = "–î–û–°–í–Ü–î–ß–ï–ù–ò–ô";
        document.getElementById('userLevelName').textContent = lvl;
        document.getElementById('profLevel').textContent = "–°—Ç–∞—Ç—É—Å: " + lvl;
    }

    // --- GAMES ---
    function playDice() {
        const b = valBet('betAmountDice'); if(!b) return;
        const chance = parseInt(document.getElementById('diceChance').value);
        const res = (Math.random()*100).toFixed(2);
        document.getElementById('diceRes').textContent = res;
        if(parseFloat(res) <= chance) {
            const win = b * (100/chance) * 0.95;
            db.ref('users/'+user+'/balance').set(uData.balance + win);
            notify("+"+win.toFixed(0), "success");
        } else {
            db.ref('users/'+user+'/balance').set(uData.balance - b);
            notify("–ü—Ä–æ–≥—Ä–∞—à", "error");
        }
    }

    let tRow = 0; let tProfit = 0; let tBet = 0;
    function startTower() {
        tBet = valBet('betAmountTower'); if(!tBet) return;
        db.ref('users/'+user+'/balance').set(uData.balance - tBet);
        tRow = 0; tProfit = tBet;
        document.getElementById('towerStartBtn').classList.add('hidden');
        document.getElementById('towerCashoutBtn').classList.remove('hidden');
        renderTower();
    }
    function renderTower() {
        const g = document.getElementById('towerGrid'); g.innerHTML = "";
        for(let i=9; i>=0; i--) {
            const r = document.createElement('div'); r.className = `tower-row ${i===tRow?'active':''}`;
            for(let j=0; j<3; j++) {
                const c = document.createElement('div'); c.className = "tower-cell"; c.textContent = "üì¶";
                c.onclick = () => {
                    if(Math.random() > 0.3) {
                        c.className = "tower-cell win"; c.textContent = "üíé";
                        tRow++; tProfit *= 1.4;
                        document.getElementById('towerCashoutBtn').textContent = `–ó–ê–ë–†–ê–¢–ò ${Math.floor(tProfit)}`;
                        if(tRow > 9) cashoutTower(); else renderTower();
                    } else {
                        c.className = "tower-cell lose"; c.textContent = "üí•";
                        notify("–í–µ–∂–∞ –≤–ø–∞–ª–∞!", "error"); endTower();
                    }
                };
                r.appendChild(c);
            }
            g.appendChild(r);
        }
    }
    function cashoutTower() { db.ref('users/'+user+'/balance').set(uData.balance + tProfit); notify("+"+Math.floor(tProfit),"success"); endTower(); }
    function endTower() { document.getElementById('towerStartBtn').classList.remove('hidden'); document.getElementById('towerCashoutBtn').classList.add('hidden'); document.getElementById('towerGrid').innerHTML = ""; }

    // --- DOUBLE (SHARED) ---
    let doubleBet = null;
    function betDouble(type) {
        const b = valBet('betAmountDouble'); if(!b) return;
        doubleBet = {type, amount: b};
        document.getElementById('myDoubleBet').textContent = `–°—Ç–∞–≤–∫–∞: ${b} –Ω–∞ ${type.toUpperCase()}`;
    }
    function startDoubleLoop() {
        setInterval(() => {
            let sec = 15 - (Math.floor(Date.now()/1000) % 15);
            document.getElementById('doubleTimer').textContent = `–î–æ —Ä–æ–∑—ñ–≥—Ä–∞—à—É: ${sec}—Å`;
            if(sec === 1) {
                const colors = ['red','black','red','black','red','black','green'];
                const res = colors[Math.floor(Math.random()*colors.length)];
                setTimeout(() => {
                    notify("–í–∏–ø–∞–ª–æ: "+res.toUpperCase());
                    if(doubleBet && doubleBet.type === res) {
                        let mult = res === 'green' ? 14 : 2;
                        db.ref('users/'+user+'/balance').set(uData.balance + (doubleBet.amount * mult));
                        notify("Double WIN!", "success");
                    } else if(doubleBet) {
                        db.ref('users/'+user+'/balance').set(uData.balance - doubleBet.amount);
                    }
                    doubleBet = null; document.getElementById('myDoubleBet').textContent = "";
                    const dot = `<div class="hist-dot" style="background:${res==='green'?'#4cd964':(res==='red'?'#ff3b30':'#555')}"></div>`;
                    document.getElementById('doubleHistory').innerHTML = dot + document.getElementById('doubleHistory').innerHTML;
                }, 1000);
            }
        }, 1000);
    }

    // --- CHAT ---
    function sendChat() {
        const m = document.getElementById('chatMsg').value; if(!m) return;
        db.ref('global_chat').push({u: user, m: m, t: Date.now()});
        document.getElementById('chatMsg').value = "";
    }
    function loadChat() {
        db.ref('global_chat').limitToLast(30).on('value', s => {
            const b = document.getElementById('chatBox'); b.innerHTML = "";
            s.forEach(child => {
                const d = child.val();
                b.innerHTML += `<div class="chat-msg"><span class="chat-name">${d.u}:</span> ${d.m}</div>`;
            });
            b.scrollTop = b.scrollHeight;
        });
    }

    // --- PROMO ---
    function usePromo() {
        const c = document.getElementById('promoInput').value.trim();
        db.ref('promos_v2/'+c).once('value', s => {
            const p = s.val();
            if(p && p.limit > 0 && (!p.users || !p.users[user])) {
                db.ref('users/'+user+'/balance').set(uData.balance + p.sum);
                db.ref('promos_v2/'+c+'/limit').set(p.limit - 1);
                db.ref('promos_v2/'+c+'/users/'+user).set(true);
                notify("–ê–∫—Ç–∏–≤–æ–≤–∞–Ω–æ: +"+p.sum, "success");
                closeModal('promo-modal');
            } else notify("–ö–æ–¥ –Ω–µ–¥—ñ–π—Å–Ω–∏–π –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π", "error");
        });
    }

    function createPromo() {
        const n = document.getElementById('admPromoName').value;
        const s = parseInt(document.getElementById('admPromoSum').value);
        const l = parseInt(document.getElementById('admPromoLimit').value);
        db.ref('promos_v2/'+n).set({sum: s, limit: l});
        notify("–ü—Ä–æ–º–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ!");
    }

    // --- SYSTEM ---
    function valBet(id) { 
        const b = parseInt(document.getElementById(id).value);
        if(isNaN(b) || b <= 0 || b > uData.balance) { notify("–ù–µ–≤—ñ—Ä–Ω–∞ —Å—Ç–∞–≤–∫–∞", "error"); return 0; }
        return b;
    }
    function notify(m, t="info") {
        const c = document.getElementById('toast-container');
        const d = document.createElement('div'); d.className = `toast`;
        d.style.background = t==="success"?"#4cd964":"#333";
        d.innerHTML = m; c.appendChild(d); setTimeout(()=>d.remove(), 2500);
    }
    function switchTab(t, el) {
        document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
        document.getElementById('tab-'+t).classList.remove('hidden');
        if(el) { document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active')); el.classList.add('active'); }
    }
    function openGame(g) { switchTab(g); }
    function openModal(id) { document.getElementById(id).classList.remove('hidden'); }
    function closeModal(id) { document.getElementById(id).classList.add('hidden'); }

    function login() {
        const n = document.getElementById('lName').value.trim();
        const p = document.getElementById('lPass').value;
        db.ref('users/'+n).once('value', s => {
            if(s.exists() && s.val().pass === p) {
                user = n; localStorage.setItem("slotok_user", n); initApp();
            } else notify("–ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É","error");
        });
    }
    function register() {
        const n = document.getElementById('rName').value.trim();
        const p = document.getElementById('rPass').value;
        if(n.length<3 || p.length<6) return notify("–ó–∞–Ω–∞–¥—Ç–æ –∫–æ—Ä–æ—Ç–∫—ñ –¥–∞–Ω—ñ");
        db.ref('users/'+n).set({pass:p, balance:1000, id:Math.floor(Math.random()*90000), isAdmin:false});
        user = n; localStorage.setItem("slotok_user", n); initApp();
    }
    function toggleAuth(r) {
        document.getElementById('loginForm').classList.toggle('hidden', r);
        document.getElementById('regForm').classList.toggle('hidden', !r);
    }
    function logout() { localStorage.removeItem("slotok_user"); location.reload(); }

    function loadTop() {
        db.ref('users').orderByChild('balance').limitToLast(10).on('value', s => {
            let h = ""; let i = 1; let arr = [];
            s.forEach(c => { arr.push({n:c.key, b:c.val().balance}); });
            arr.reverse().forEach(u => {
                h += `<tr><td>${i++}. ${u.n}</td><td style="text-align:right;">${Math.floor(u.b)} ‚Ç¥</td></tr>`;
            });
            document.getElementById('topTable').innerHTML = h;
        });
    }
    
    // –°–ø—Ä–æ—â–µ–Ω—ñ —Å–ª–æ—Ç–∏ —Ç–∞ –º–∞–π–Ω–∏ –¥–ª—è —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ
    function playSlots() {
        const b = valBet('betAmountSlots'); if(!b) return;
        const s = ["üçí","üçã","777","üíé"];
        const r1=s[Math.floor(Math.random()*s.length)], r2=s[Math.floor(Math.random()*s.length)], r3=s[Math.floor(Math.random()*s.length)];
        document.getElementById('rs1').textContent=r1; document.getElementById('rs2').textContent=r2; document.getElementById('rs3').textContent=r3;
        if(r1===r2 && r2===r3) {
            let m = 5; if(r1==="777") m=50;
            db.ref('users/'+user+'/balance').set(uData.balance + (b*m)); notify("WIN x"+m, "success");
        } else db.ref('users/'+user+'/balance').set(uData.balance - b);
    }
  </script>
</body>
</html>